(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-d25e5d18"],{4997:function(t,e,i){"use strict";i.d(e,"a",(function(){return u})),i.d(e,"b",(function(){return c}));var a=i("1da1"),r=i("ade3"),n=i("d4ec"),s=i("bee2"),o=(i("96cf"),i("d3b7"),i("25f0"),i("159b"),i("4de4"),i("caad"),i("2532"),i("4360"));function l(t){if("function"===typeof t&&t().then)return!0}var u=function(){function t(e){Object(n["a"])(this,t),this._this=e._this,this.addr=[],this.indexSign=null,this.URL=e.url,this.id=e.id,this.errId=e.errId?e.errId:e.id,this.title=e.title?e.title:"审核",this.allTitle=e.allTitle,this.params=e.params,this.before=e.before,this.checkbox=null,this.Data=null,this.showConfirm=e.showConfirm,this.callbackFunc=e.callbackFunc}return Object(s["a"])(t,[{key:"verify",value:function(){return!(this._this.multipleSelection.length<1)||(this._this.$message({message:"请选择需要".concat(this.title,"的信息"),type:"warning"}),!1)}},{key:"confirm",value:function(){var t="确定要“"+this.title+"”此条信息?";return this.allTitle&&(t=this.allTitle),this._this.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}},{key:"sendAjax",value:function(t,e,i){var a,n=this,s=Object.assign(Object(r["a"])({},this.id,t),this.params);this._this.$axMethod[this.URL]?a=this._this.$axMethod[this.URL](s):this._this.$api[this.URL]&&(a=this._this.$axios({url:this._this.$api[this.URL],method:"post",data:s})),a.then((function(t){n.checkbox=n._this.multipleSelection,n.callbackFunc&&n.callbackFunc(t.data),200==t.data.code?(e(t),n.Data=t):i(t)})).catch((function(t){i(t)}))}},{key:"logic",value:function(){var t=this;if(!this.verify())return!1;for(var e=0;e<this._this.multipleSelection.length;e++)this.addr.push(this._this.multipleSelection[e][this.id]);var i=this.addr.toString();return new Promise((function(e,a){if(1==t.showConfirm)t.confirm().then((function(){if(l(t.before))t.before(i).then((function(){return t.sendAjax(i,e,a)}));else if(t.before&&t.before()||!t.before)return t.sendAjax(i,e,a)}));else if(l(t.before))t.before(i).then((function(){return t.sendAjax(i,e,a)}));else if(t.before&&t.before()||!t.before)return t.sendAjax(i,e,a)}))}},{key:"send",value:function(){var t=this;this.logic().then((function(e){var i=e.data;200===i.code&&(t._this.$message.success(i.msg?i.msg:i.data),t._this.onSearch&&t._this.onSearch())}))}},{key:"callback",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,i,a,r,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.logic();case 3:this.Data&&this.Data.data&&this.Data.data.data.length?(e=this.Data.data.data,i=[],e.forEach((function(t){i.push(t.serial)})),a=this.checkbox.filter((function(t){return 1==i.includes(t[n.errId])})),this._this.indexSign.arr=a,this._this.indexSign.str=this.errId,o["a"].commit("setErrorObj",{msg:this.Data.data.msg,table:this.Data.data.data,state:!0})):(r=this.Data.data.msg?this.Data.data.msg:this.Data.data.data,this._this.indexSign.arr=[],this._this.$message({message:r,type:"success"}),this._this.multipleSelection=[],this._this.onSearch&&this._this.onSearch()),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),console.log();case 9:case"end":return t.stop()}}),t,this,[[0,6]])})));function e(){return t.apply(this,arguments)}return e}()}]),t}(),c=function(){function t(e){var i=e._this,a=e.url,r=e.list,s=void 0===r?[]:r,o=e.params,l=void 0===o?{}:o,u=e.before;Object(n["a"])(this,t),this._this=i,this.url=a,this.list=s,this.params=l,this.before=u}return Object(s["a"])(t,[{key:"sendAjax",value:function(t,e){var i;this._this.$axMethod[this.url]?i=this._this.$axMethod[this.url](this.params):this._this.$api[this.url]&&(i=this._this.$axios({url:this._this.$api[this.url],method:"post",data:this.params})),i.then((function(i){200==i.data.code?t(i):e(i)})).catch((function(t){e(t)}))}},{key:"edit",value:function(){var t=this;return new Promise((function(e,i){if(l(t.before))t.before().then((function(){return t.sendAjax(e,i)}));else if(t.before&&t.before()||!t.before)return t.sendAjax(e,i)}))}},{key:"callback",value:function(){var t=this;return new Promise((function(e,i){t.edit().then((function(a){if(a.data&&a.data.data&&a.data.data.length){o["a"].commit("setErrorObj",{msg:a.data.msg,table:a.data.data,state:!0});var r=[];a.data.data.forEach((function(t){r.push(t.serial)})),t._this.indexSign=r,i(a)}else t._this.$message({message:a.data.msg?a.data.msg:a.data.data,type:"success"}),e(a)}))}))}}]),t}()},9374:function(t,e,i){},"9d20":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"errorDialog"},[i("vxe-modal",{attrs:{width:"520",showHeader:"false","mask-closable":"true"},on:{close:t.close},model:{value:t.errorState,callback:function(e){t.errorState=e},expression:"errorState"}},[i("div",{staticClass:"titles"},[t._v("提示:"+t._s(t.errorData.msg))]),i("vxe-grid",{attrs:{height:"200","show-overflow":"tooltip",border:"",columns:t.titleName,size:"mini",data:t.errorData.data}})],1)],1)},r=[],n={props:{errorData:{type:Object,default:function(){return{}}},errorState:{type:Boolean,default:!1},titleName:{type:Array,default:function(){return[{type:"seq",title:"序号",width:50},{field:"serial",width:200,title:"单据号"},{field:"msg",title:"失败原因"}]}}},methods:{close:function(){this.$parent.errorState=!1}}},s=n,o=(i("fa01"),i("a43d"),i("2877")),l=Object(o["a"])(s,a,r,!1,null,"21c7364e",null);e["a"]=l.exports},a43d:function(t,e,i){"use strict";i("9374")},c1ac:function(t,e,i){},eacf:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"params"},[i("div",{attrs:{id:"leixin"}},[i("div",{staticClass:"search_container"},[i("el-form",{ref:"filterFormRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params}},[i("el-form-item",{attrs:{label:"采购组织",size:"mini"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",maxlength:"100"},on:{focus:t.companyListInvok,change:t.companyChange},model:{value:t.params.company_id,callback:function(e){t.$set(t.params,"company_id",e)},expression:"params.company_id"}},t._l(t.companyList,(function(e){return i("el-option",{key:e.company_id,attrs:{label:e.company_name,value:e.company_id}},[i("span",{class:1==e.type?"optionStyle":""},[t._v(t._s(e.company_name))])])})),1)],1),i("el-form-item",{attrs:{label:"业务日期",size:"mini"}},[i("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.timeValue,callback:function(e){t.timeValue=e},expression:"timeValue"}})],1),i("el-form-item",{attrs:{label:"单据号",size:"mini"}},[i("el-input",{attrs:{maxlength:"100",placeholder:"请输入"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch(1)}},model:{value:t.params.instorage_sn,callback:function(e){t.$set(t.params,"instorage_sn",e)},expression:"params.instorage_sn"}})],1),i("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini"}},[i("el-select",{attrs:{clearable:"",maxlength:"100","filter-method":t.supplierListInvok,filterable:"",placeholder:"请选择"},on:{change:t.supplierChangesave,focus:t.supplierListInvok},model:{value:t.params.supplier_id,callback:function(e){t.$set(t.params,"supplier_id",e)},expression:"params.supplier_id"}},t._l(t.supplierList,(function(t){return i("el-option",{key:t.supplier_id,attrs:{label:t.supplier_name,value:t.supplier_id}})})),1)],1),i("el-form-item",{attrs:{label:"仓库名称",size:"mini"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",maxlength:"100"},on:{focus:t.warehouseInvok,change:t.warehouseChange},model:{value:t.params.warehouse_id,callback:function(e){t.$set(t.params,"warehouse_id",e)},expression:"params.warehouse_id"}},t._l(t.warehouseList,(function(t){return i("el-option",{key:t.warehouse_id,attrs:{label:t.warehouse_name,value:t.warehouse_id}})})),1)],1),i("el-form-item",{attrs:{label:"部门",size:"mini"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",maxlength:"100"},on:{focus:t.DepartmentListInvok,change:t.departmentChange},model:{value:t.params.department_id,callback:function(e){t.$set(t.params,"department_id",e)},expression:"params.department_id"}},t._l(t.departmentList,(function(t){return i("el-option",{key:t.department_id,attrs:{label:t.department_name,value:t.department_id}})})),1)],1),i("el-form-item",{attrs:{label:"审核日期",size:"mini"}},[i("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.auditValue,callback:function(e){t.auditValue=e},expression:"auditValue"}})],1),i("el-form-item",{attrs:{label:"采购员",size:"mini"}},[i("erpEmployee",{attrs:{title:"请选择采购员",searchParams:{company_id:t.params.company_id}},model:{value:t.params.buyer_id,callback:function(e){t.$set(t.params,"buyer_id",e)},expression:"params.buyer_id"}})],1),i("el-form-item",{attrs:{label:"入库来源",size:"mini"}},[i("el-select",{attrs:{clearable:""},model:{value:t.params.instorage_source,callback:function(e){t.$set(t.params,"instorage_source",e)},expression:"params.instorage_source"}},[i("el-option",{attrs:{label:"全部",value:0}},[t._v("全部")]),i("el-option",{attrs:{label:"ERP",value:1}},[t._v("ERP")]),i("el-option",{attrs:{label:"销售订单",value:3}},[t._v("销售订单")]),i("el-option",{attrs:{label:"集采平台",value:2}},[t._v("集采平台")])],1)],1),i("el-form-item",{attrs:{label:"来源单号",size:"mini"}},[i("el-input",{attrs:{placeholder:"请输入",maxlength:"100"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch(1)}},model:{value:t.params.order_sn,callback:function(e){t.$set(t.params,"order_sn",e)},expression:"params.order_sn"}})],1),i("el-form-item",{attrs:{label:"交货方式",size:"mini"}},[i("deliveryMethod",{model:{value:t.params.transaction_type,callback:function(e){t.$set(t.params,"transaction_type",e)},expression:"params.transaction_type"}})],1),i("el-form-item",{attrs:{label:"审核状态",size:"mini"}},[i("el-select",{attrs:{clearable:""},model:{value:t.params.auditor_status,callback:function(e){t.$set(t.params,"auditor_status",e)},expression:"params.auditor_status"}},[i("el-option",{attrs:{label:"全部",value:0}},[t._v("全部")]),i("el-option",{attrs:{label:"未审核",value:1}},[t._v("未审核")]),i("el-option",{attrs:{label:"已审核",value:2}},[t._v("已审核")]),i("el-option",{attrs:{label:"作废",value:3}},[t._v("作废")])],1)],1),i("el-form-item",{attrs:{label:"打印状态",size:"mini"}},[i("el-select",{attrs:{clearable:""},model:{value:t.params.print_times,callback:function(e){t.$set(t.params,"print_times",e)},expression:"params.print_times"}},[i("el-option",{attrs:{label:"全部",value:0}},[t._v("全部")]),i("el-option",{attrs:{label:"未打印",value:1}},[t._v("未打印")]),i("el-option",{attrs:{label:"已打印",value:2}},[t._v("已打印")])],1)],1),i("el-form-item",{attrs:{label:"付款状态",size:"mini"}},[i("el-select",{attrs:{clearable:""},model:{value:t.params.payment_status,callback:function(e){t.$set(t.params,"payment_status",e)},expression:"params.payment_status"}},[i("el-option",{attrs:{label:"全部",value:0}},[t._v("全部")]),i("el-option",{attrs:{label:"未付款",value:1}},[t._v("未付款")]),i("el-option",{attrs:{label:"全部付款",value:2}},[t._v("全部付款")]),i("el-option",{attrs:{label:"部分付款",value:3}},[t._v("部分付款")])],1)],1),i("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.onSearch(1)}}},[t._v("查询")]),i("el-button",{attrs:{plain:"",size:"mini"},on:{click:t.onReset}},[t._v("重置")])],1)],1)],1),i("div",{staticClass:"add_delet"},[1==t.authority.b_add?i("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:t.add}},[t._v("新增")]):t._e(),1==t.authority.b_del?i("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:t.deletes}},[t._v("删除")]):t._e(),1==t.authority.b_pass?i("el-button",{staticClass:"iconfont icon-pass",attrs:{type:"primary",size:"mini"},on:{click:t.shenHe}},[t._v("审核")]):t._e(),1==t.authority.b_nopass?i("el-button",{attrs:{plain:"",icon:"iconfont icon-fanshenhe",size:"mini"},on:{click:t.AUDIT_GET}},[t._v("弃审")]):t._e(),1==t.authority.b_invalid?i("el-button",{staticClass:"iconfont icon-zuofei",attrs:{plain:"",size:"mini"},on:{click:t.abolishFun}},[t._v("作废")]):t._e(),1==t.authority.b_export_file?i("el-button",{attrs:{plain:"",icon:"el-icon-download",size:"mini"},on:{click:t.downLoadFile}},[t._v("下载模板")]):t._e(),1==t.authority.b_import?i("el-button",{staticClass:"addBtn",attrs:{plain:"",icon:"iconfont icon-daoru5",size:"mini"},on:{click:t.dialogEmployee}},[t._v("导入")]):t._e(),1==t.authority.b_export?i("el-dropdown",{staticStyle:{margin:"0 10px"}},[i("span",{staticStyle:{cursor:"pointer",color:"#4e90e2"},attrs:{"split-button":""}},[i("el-button",{attrs:{plain:"",icon:"iconfont icon-daochu10",size:"mini"}},[t._v("导出")])],1),i("el-dropdown-menu",{staticStyle:{"margin-top":"10px"},attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{nativeOn:{click:function(e){return t.exportOrder(1)}}},[t._v("导出Excel文件")]),i("el-dropdown-item",{nativeOn:{click:function(e){return t.exportOrder(2)}}},[t._v("导出CSV逗号分隔")])],1)],1):t._e(),1==t.authority.b_printinginstorage?i("el-button",{attrs:{plain:"",size:"mini",icon:"el-icon-printer"},on:{click:function(e){return t.printF()}}},[t._v("批量打印")]):t._e()],1),i("div",{staticClass:"table_container"},[i("xTable",{ref:"xTable",attrs:{ajax:{url:"purchaseGetInStorageList",params:t.params},fieldUrl:"v2/purchase/InStorage/getInStorageList",sign:t.indexSign,isShowTool:!0,dragable:"",footerMethod:t.footerMethod,tableColumn:t.tableColumn},on:{"checkbox-change":t.checkboxChange}})],1)]),i("printInstorage",{ref:"printInstorage",attrs:{title:"purchaseReceipt",fieldUrl:"purchase/InStorage/printInStorage"},on:{Search:t.onSearch}}),i("upload",{ref:"upload",attrs:{options:t.options},on:{receiveUploadMsg:t.receiveUploadMsg}}),i("errorDialog",{attrs:{errorData:t.trunErrTable,errorState:t.errorState}})],1)},r=[],n=i("5530"),s=(i("d3b7"),i("159b"),i("d81d"),i("99af"),i("a15b"),i("25f0"),i("caad"),i("2532"),i("4de4"),i("a9e3"),i("78d2")),o=i("2f62"),l=i("9d20"),u={data:function(){var t=this;this.$createElement;return{footerData:{},tableColumn:[{type:"checkbox",width:44,fixed:"left",align:"center"},{type:"index",title:"序号",width:50},{title:"操作",fixed:"right",align:"center",headerAlign:"center",width:150,slots:{default:function(e,i){return[i("el-button",{attrs:{size:"small",type:"text",disabled:1!==t.authority.b_info},on:{click:function(){return t.seeF(e,e.row)}}},[" 查看 "]),i("el-button",{attrs:{size:"small",type:"text",disabled:!("未审核"==e.row.auditor_status_name&&1==t.authority.b_edit&&2!==e.row.instorage_source)},on:{click:function(){return t.modify(e,e.row)}}},[" 修改  "]),i("el-button",{attrs:{size:"small",type:"text",disabled:!(1==e.row.after_auditor_print_status&&1==t.authority.b_printinginstorage&&"已审核"==e.row.auditor_status_name||1!=e.row.after_auditor_print_status&&1==t.authority.b_printinginstorage)},on:{click:function(){return t.printSheet(e.row)}}},[" 打印  "])]}}},{title:"采购组织",field:"company_name",width:150},{title:"单据号",field:"instorage_sn",width:160,slots:{default:function(e,i){return[i("el-link",{on:{click:function(){t.seeF(e,e.row)}},attrs:{type:"primary"}},[e.row.instorage_sn])]}}},{title:"供应商(厂家)",field:"supplier_name",width:150},{title:"入库数量",field:"num",headerAlign:"right",align:"right",width:100},{title:"不良品数量",field:"incomplete_num",headerAlign:"right",align:"right",width:100},{title:"入库金额",field:"total_price",headerAlign:"right",align:"right",formatter:"priceFormat",width:100},{title:"付款金额",field:"allocated_price",headerAlign:"right",align:"right",formatter:"priceFormat",sortable:!0,remoteSort:!0,width:100},{title:"税额",field:"sub_revenue_price",headerAlign:"right",align:"right",formatter:"priceFormat",width:100},{title:"不含税金额",field:"sub_no_revenue_price",showOverflow:!0,headerAlign:"right",formatter:"priceFormat",align:"right",width:100},{title:"未付金额",field:"residue_price",headerAlign:"right",align:"right",formatter:"priceFormat",sortable:!0,remoteSort:!0,width:100},{title:"部门",field:"department_name",width:100},{title:"采购员",field:"buyer_name",width:100},{title:"创建人",field:"add_user_name",width:130},{title:"业务日期",field:"business_time",width:130},{title:"单据时间",field:"add_time",width:130},{title:"来源单号",field:"order_sn",width:156},{title:"入库来源",field:"instorage_source_name",width:132},{title:"入库类型",field:"type_name",width:70},{title:"入库仓库",field:"warehouse_name",width:132},{title:"交货方式",field:"transaction_type_name",width:132},{title:"审核状态",field:"auditor_status_name",width:130},{title:"审核人",field:"auditor_name",width:130},{title:"审核时间",field:"auditor_time",width:130},{title:"修改人",field:"update_user_name",width:130},{title:"修改时间",field:"update_time",width:130},{title:"备注",field:"remark",width:150},{title:"打印次数",field:"print_times",width:80}]}},methods:{initParams:function(){this.$route.params&&this.$route.params.type&&(this.params.auditor_status=1),this.onSearch(1)},footerMethod:function(t){var e=this,i=t.columns,a=t.data;return[i.map((function(t,i){if(2===i)return"页小计";if(["num","total_price","allocated_price","incomplete_num","residue_price","sub_revenue_price","sub_no_revenue_price"].includes(t.property)){var r=e.$utils.sum(a,t.property);return"num"===t.property||"incomplete_num"===t.property?e.$publicFution.priceFormatNone(r,0):e.$publicFution.priceFormatNone(r)}return null})),i.map((function(t,i){return 2===i?"合计":"num"===t.property&&void 0!==e.footerData.sum_num?e.$publicFution.priceFormatNone(e.footerData.sum_num,0):"incomplete_num"===t.property&&void 0!==e.footerData.sum_incomplete_num?e.$publicFution.priceFormatNone(e.footerData.sum_incomplete_num,0):"total_price"===t.property&&void 0!==e.footerData.sun_money?e.$publicFution.priceFormatNone(e.footerData.sun_money):"allocated_price"===t.property&&void 0!==e.footerData.sum_allocated_price?e.$publicFution.priceFormatNone(e.footerData.sum_allocated_price):"residue_price"===t.property&&void 0!==e.footerData.sum_residue_price?e.$publicFution.priceFormatNone(e.footerData.sum_residue_price):"sub_revenue_price"===t.property&&void 0!==e.footerData.sub_revenue_price?e.$publicFution.priceFormatNone(e.footerData.sub_revenue_price):"sub_no_revenue_price"===t.property&&void 0!==e.footerData.sub_no_revenue_price?e.$publicFution.priceFormatNone(e.footerData.sub_no_revenue_price):["num","total_price","allocated_price","residue_price","sub_no_revenue_price","sub_revenue_price","incomplete_num"].includes(t.property)?"加载中...":null}))]}}},c=i("4997"),p=i("65b0"),d={name:"purchaseInstorageIndex",mixins:[u],data:function(){return{options:{title:"采购入库单",url:"/purchase/InStorage/importInStorage"},test:"",title:null,hasAuditorStatusPrint:null,authority:{},indexSign:{noDisabled:!0,arr:[]},auditValue:null,errorState:!1,purchaseprice:!0,planAdds:!1,examineprice:!1,lock:0,params:{},trunErrTable:{},loading:!0,timeValue:[],companyList:[],supplierList:[],multipleSelection:[],dialogFormVisible:!1,newresult:[]}},components:{printInstorage:s["a"],errorDialog:l["a"]},computed:Object(n["a"])({},Object(o["c"])(["printingStatusGet"])),props:{goBackUrl:{type:Object,default:function(){return{addUrl:"/purchase/instorage/instorageAdd",seeUrl:"/purchase/instorage/instorageSee"}}}},methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])(["printingStatus"])),{},{checkboxChange:function(){console.log(11)},dialogEmployee:function(){this.$refs.upload.stateOpen()},receiveUploadMsg:function(){this.onSearch()},printF:function(){for(var t=!1,e=this.multipleSelection,i=1;i<e.length;i++)if(e[i-1].company_id!=e[i].company_id){t=!0;break}if(this.multipleSelection.length)if(t)this.$message({message:"请选择相同公司单据进行打印",type:"warning"});else{var a=!0,r=[];if(this.multipleSelection.forEach((function(t){1==t.after_auditor_print_status&&"已审核"!=t.auditor_status_name&&(r.push(t.instorage_sn),a=!1)})),a)this.$refs.printInstorage.printList(this.multipleSelection,["instorage_id"]);else{var n=r.map((function(t,e){return"".concat(e+1,".").concat(t)}));this.$alert('以下未审核的单据不可打印：<br/>\n\t\t\t\t\t\t\t\t\t <div style="color:#e6a23c">\n\t\t\t\t\t\t\t\t\t\t\t '.concat(n.join("，"),"\n\t\t\t\t\t\t\t\t\t <div>"),"提示",{dangerouslyUseHTMLString:!0})}}else this.$message({message:"请选择单据进行打印",type:"warning"})},printSheet:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.$nextTick((function(){e.$refs.printInstorage.printPdf({instorage_id:t.instorage_id},i)}))},exportOrder:function(t){var e=this.multipleSelection.map((function(t){return t.instorage_id}));Object.assign(this.params,{export_type:t,id_arr:e.toString()}),this.$axMethod.exportInstorageUrl(this.params).then((function(t){200==t.data.code&&(window.location.href=t.data.data.url)}))},downLoadFile:function(){this.$axMethod.purchaseDownloadFile({}).then((function(t){200==t.data.code&&(window.location.href=t.data.data.url)}))},selectRowChangeBg:function(t){var e=t.row;return this.multipleSelection.length&&this.multipleSelection.map((function(t){return t.instorage_id})).includes(e.instorage_id)?"background:#d4e1ee":""},AUDIT_GET:function(){var t=this;if(this.multipleSelection.length<1)return this.$message({message:"请选择需要弃审的信息",type:"warning"}),!1;for(var e=[],i=0;i<this.multipleSelection.length;i++)e.push(this.multipleSelection[i].instorage_id);this.$baseData.checkCarDoctor({bill_type:1,bill_id:e.join(","),operation_type:5}).then((function(){var e=new c["a"]({_this:t,id:"instorage_id",url:"unAuditorPass",errId:"instorage_sn",title:"弃审",showConfirm:!0,params:{is_list:1}});e.callback()}))},companyChange:function(t){""!=t&&(this.params.company_name=this.companyList.filter((function(e){return e.company_id===t}))[0].company_name),this.$set(this.params,"department_id",""),this.$set(this.params,"buyer_id",""),this.$set(this.params,"supplier_id",""),this.$set(this.params,"warehouse_id","")},departmentChange:function(t){t&&(this.params.department_name=this.departmentList.filter((function(e){return e.department_id===t}))[0].department_name),this.$set(this.params,"buyer_id","")},buyerChange:function(t){t&&(this.params.buyer_name=this.employeeList.filter((function(e){return e.employee_id===t}))[0].employee_name)},warehouseChange:function(t){t&&(this.params.warehouse_name=this.warehouseList.filter((function(e){return e.warehouse_id===t}))[0].warehouse_name)},supplierChangesave:function(t){t&&(this.params.supplier_name=this.supplierList.filter((function(e){return e.supplier_id===t}))[0].supplier_name)},onReset:function(){this.timeValue=[],this.auditValue=[],this.$set(this,"params",{type:this.type,auditor_status:0,print_times:0}),this.indexSign.arr=[],this.onSearch(1)},seeF:function(t,e){this.$router.push({path:this.goBackUrl.seeUrl,query:{after_auditor_print_status:e.after_auditor_print_status,instorage_id:e.instorage_id}})},shenHe:function(){var t=this;if(this.multipleSelection.length<1)return this.$message({message:"请选择需要审核的信息",type:"warning"}),!1;for(var e=[],i=0;i<this.multipleSelection.length;i++)e.push(this.multipleSelection[i].instorage_id);this.$baseData.checkCarDoctor({bill_type:1,bill_id:e.join(","),operation_type:4}).then((function(){new c["a"]({id:"instorage_id",_this:t,title:"审核",url:"purchaseAuditorPassInStorage",showConfirm:!0}).send()}))},abolishFun:function(){var t=this;if(this.multipleSelection.length<1)return this.$message({message:"请选择需要作废的信息",type:"warning"}),!1;for(var e=[],i=0;i<this.multipleSelection.length;i++)e.push(this.multipleSelection[i].instorage_id);this.$baseData.checkCarDoctor({bill_type:1,bill_id:e.join(","),operation_type:6}).then((function(){new c["a"]({id:"instorage_id",_this:t,title:"作废",url:"purchaseAuditorInvalidInStorage",showConfirm:!0}).send()}))},add:function(){this.$router.push({path:this.goBackUrl.addUrl})},modify:function(t,e){if(e&&1==e.is_execute)return this.$message.error("wms系统正在操作此单据，暂不支持单据修改"),!1;this.$router.push({path:this.goBackUrl.addUrl,query:{instorage_id:e.instorage_id}})},onSearch:function(t){var e=this;this.timeValue?(this.params.business_start_time=this.timeValue[0],this.params.business_end_time=this.timeValue[1]):this.params.business_start_time=this.params.business_end_time="",this.auditValue?(this.params.auditor_start_time=this.auditValue[0],this.params.auditor_end_time=this.auditValue[1]):this.params.auditor_start_time=this.params.auditor_end_time="",t&&(this.indexSign.arr=[]),this.$refs.xTable._getData(t),this.footerData={},this.$axMethod.getInstorageListTotal(this.params).then((function(t){var i=t.data;200===i.code&&(e.footerData=i.data,setTimeout((function(){e.$refs.xTable._updateFooter()}),50))}))},deletes:function(){var t=this;if(this.multipleSelection.length<1)return this.$message({message:"请选择需要删除的信息",type:"warning"}),!1;for(var e=[],i=0;i<this.multipleSelection.length;i++)e.push(this.multipleSelection[i].instorage_id);var a={deleID:"instorage_id",deleSelect:this.multipleSelection,deleApi:"purchaseDelInStorage",list:{}};this.$baseData.checkCarDoctor({bill_type:1,bill_id:e.join(","),operation_type:3}).then((function(){t.$common.deletes(a,"删除",t,t.onSearch)}))}}),created:function(){this.authority=JSON.parse(localStorage.getItem("authority")),this.$set(this,"params",{type:this.type,auditor_status:0,print_times:0,company_id:Number(localStorage.company_id),payment_status:0}),Object(p["l"])(this,localStorage)},activated:function(){this.initParams()}},h=d,m=i("2877"),_=Object(m["a"])(h,a,r,!1,null,"3d37940f",null);e["default"]=_.exports},fa01:function(t,e,i){"use strict";i("c1ac")}}]);
//# sourceMappingURL=chunk-d25e5d18.57d39867.js.map