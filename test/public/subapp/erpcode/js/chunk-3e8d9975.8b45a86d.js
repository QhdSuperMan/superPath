(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-3e8d9975"],{4997:function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return d}));var a=i("1da1"),s=i("ade3"),n=i("d4ec"),r=i("bee2"),o=(i("96cf"),i("d3b7"),i("25f0"),i("159b"),i("4de4"),i("caad"),i("2532"),i("4360"));function l(t){if("function"===typeof t&&t().then)return!0}var c=function(){function t(e){Object(n["a"])(this,t),this._this=e._this,this.addr=[],this.indexSign=null,this.URL=e.url,this.id=e.id,this.errId=e.errId?e.errId:e.id,this.title=e.title?e.title:"审核",this.allTitle=e.allTitle,this.params=e.params,this.before=e.before,this.checkbox=null,this.Data=null,this.showConfirm=e.showConfirm,this.callbackFunc=e.callbackFunc}return Object(r["a"])(t,[{key:"verify",value:function(){return!(this._this.multipleSelection.length<1)||(this._this.$message({message:"请选择需要".concat(this.title,"的信息"),type:"warning"}),!1)}},{key:"confirm",value:function(){var t="确定要“"+this.title+"”此条信息?";return this.allTitle&&(t=this.allTitle),this._this.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}},{key:"sendAjax",value:function(t,e,i){var a,n=this,r=Object.assign(Object(s["a"])({},this.id,t),this.params);this._this.$axMethod[this.URL]?a=this._this.$axMethod[this.URL](r):this._this.$api[this.URL]&&(a=this._this.$axios({url:this._this.$api[this.URL],method:"post",data:r})),a.then((function(t){n.checkbox=n._this.multipleSelection,n.callbackFunc&&n.callbackFunc(t.data),200==t.data.code?(e(t),n.Data=t):i(t)})).catch((function(t){i(t)}))}},{key:"logic",value:function(){var t=this;if(!this.verify())return!1;for(var e=0;e<this._this.multipleSelection.length;e++)this.addr.push(this._this.multipleSelection[e][this.id]);var i=this.addr.toString();return new Promise((function(e,a){if(1==t.showConfirm)t.confirm().then((function(){if(l(t.before))t.before(i).then((function(){return t.sendAjax(i,e,a)}));else if(t.before&&t.before()||!t.before)return t.sendAjax(i,e,a)}));else if(l(t.before))t.before(i).then((function(){return t.sendAjax(i,e,a)}));else if(t.before&&t.before()||!t.before)return t.sendAjax(i,e,a)}))}},{key:"send",value:function(){var t=this;this.logic().then((function(e){var i=e.data;200===i.code&&(t._this.$message.success(i.msg?i.msg:i.data),t._this.onSearch&&t._this.onSearch())}))}},{key:"callback",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,i,a,s,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.logic();case 3:this.Data&&this.Data.data&&this.Data.data.data.length?(e=this.Data.data.data,i=[],e.forEach((function(t){i.push(t.serial)})),a=this.checkbox.filter((function(t){return 1==i.includes(t[n.errId])})),this._this.indexSign.arr=a,this._this.indexSign.str=this.errId,o["a"].commit("setErrorObj",{msg:this.Data.data.msg,table:this.Data.data.data,state:!0})):(s=this.Data.data.msg?this.Data.data.msg:this.Data.data.data,this._this.indexSign.arr=[],this._this.$message({message:s,type:"success"}),this._this.multipleSelection=[],this._this.onSearch&&this._this.onSearch()),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),console.log();case 9:case"end":return t.stop()}}),t,this,[[0,6]])})));function e(){return t.apply(this,arguments)}return e}()}]),t}(),d=function(){function t(e){var i=e._this,a=e.url,s=e.list,r=void 0===s?[]:s,o=e.params,l=void 0===o?{}:o,c=e.before;Object(n["a"])(this,t),this._this=i,this.url=a,this.list=r,this.params=l,this.before=c}return Object(r["a"])(t,[{key:"sendAjax",value:function(t,e){var i;this._this.$axMethod[this.url]?i=this._this.$axMethod[this.url](this.params):this._this.$api[this.url]&&(i=this._this.$axios({url:this._this.$api[this.url],method:"post",data:this.params})),i.then((function(i){200==i.data.code?t(i):e(i)})).catch((function(t){e(t)}))}},{key:"edit",value:function(){var t=this;return new Promise((function(e,i){if(l(t.before))t.before().then((function(){return t.sendAjax(e,i)}));else if(t.before&&t.before()||!t.before)return t.sendAjax(e,i)}))}},{key:"callback",value:function(){var t=this;return new Promise((function(e,i){t.edit().then((function(a){if(a.data&&a.data.data&&a.data.data.length){o["a"].commit("setErrorObj",{msg:a.data.msg,table:a.data.data,state:!0});var s=[];a.data.data.forEach((function(t){s.push(t.serial)})),t._this.indexSign=s,i(a)}else t._this.$message({message:a.data.msg?a.data.msg:a.data.data,type:"success"}),e(a)}))}))}}]),t}()},b8cd:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"params"},[i("div",{attrs:{id:"leixin"}},[i("div",{staticClass:"search_container"},[i("el-form",{ref:"filterFormRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params}},[i("el-form-item",{attrs:{label:"库存组织",size:"mini"}},[i("erpCompanyList",{attrs:{fatherParams:t.params},model:{value:t.params.company_id,callback:function(e){t.$set(t.params,"company_id",e)},expression:"params.company_id"}})],1),i("el-form-item",{attrs:{label:"部门",size:"mini"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{focus:function(e){return t.DepartmentListInvok(t.params)}},model:{value:t.params.department_id,callback:function(e){t.$set(t.params,"department_id",e)},expression:"params.department_id"}},t._l(t.departmentList,(function(t){return i("el-option",{key:t.department_id,attrs:{label:t.department_name,value:t.department_id}})})),1)],1),i("el-form-item",{attrs:{label:"业务员",size:"mini"}},[i("el-select",{attrs:{clearable:"",filterable:""},on:{focus:t.EmployeeListInvok},model:{value:t.params.business_id,callback:function(e){t.$set(t.params,"business_id",e)},expression:"params.business_id"}},t._l(t.employeeList,(function(t){return i("el-option",{key:t.employee_id,attrs:{label:t.employee_name,value:t.employee_id}})})),1)],1),i("el-form-item",{attrs:{label:"业务日期",size:"mini"}},[i("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.timeValue,callback:function(e){t.timeValue=e},expression:"timeValue"}})],1),i("el-form-item",{attrs:{label:"单据类型",size:"mini"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.params.order_type,callback:function(e){t.$set(t.params,"order_type",e)},expression:"params.order_type"}},[i("el-option",{attrs:{label:"全部",value:0}}),i("el-option",{attrs:{label:"良品转不良品",value:1}}),i("el-option",{attrs:{label:"不良品转良品",value:2}})],1)],1),i("el-form-item",{attrs:{label:"单据号",size:"mini"}},[i("el-input",{attrs:{placeholder:"请输入"},model:{value:t.params.conversion_sn,callback:function(e){t.$set(t.params,"conversion_sn",e)},expression:"params.conversion_sn"}})],1),i("el-form-item",{attrs:{label:"审核日期",size:"mini"}},[i("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.AuditDate,callback:function(e){t.AuditDate=e},expression:"AuditDate"}})],1),i("el-form-item",{attrs:{label:"单据状态",size:"mini"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.params.auditor_status,callback:function(e){t.$set(t.params,"auditor_status",e)},expression:"params.auditor_status"}},[i("el-option",{attrs:{label:"全部",value:0}},[t._v("全部")]),i("el-option",{attrs:{label:"未审核",value:1}},[t._v("未审核")]),i("el-option",{attrs:{label:"已审核",value:2}},[t._v("已审核")]),i("el-option",{attrs:{label:"作废",value:3}},[t._v("作废")])],1)],1),i("el-form-item",{attrs:{label:"来源",size:"mini"}},[i("el-select",{attrs:{clearable:""},model:{value:t.params.form_type,callback:function(e){t.$set(t.params,"form_type",e)},expression:"params.form_type"}},[i("el-option",{attrs:{label:"全部",value:0}},[t._v("全部")]),i("el-option",{attrs:{label:"WMS",value:1}},[t._v("WMS")]),i("el-option",{attrs:{label:"ERP",value:2}},[t._v("ERP")])],1)],1),i("el-form-item",{staticClass:"search-style",attrs:{size:"mini"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.onSearch(1)}}},[t._v("查询")]),i("el-button",{attrs:{plain:"",size:"mini"},on:{click:t.onReset}},[t._v("重置")])],1)],1)],1),i("div",{staticClass:"add_delet"},[1==t.authority.b_add?i("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:t.NewList}},[t._v("新增")]):t._e(),1==t.authority.b_del?i("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:t.deletes}},[t._v("删除")]):t._e(),1==t.authority.b_pass?i("el-button",{attrs:{icon:"iconfont icon-pass",type:"primary",size:"mini"},on:{click:t.audit}},[t._v("审核")]):t._e(),1==t.authority.b_invalid?i("el-button",{staticClass:"addBtn",attrs:{plain:"",icon:"iconfont icon-zuofei",size:"mini"},on:{click:t.abolish}},[t._v("作废")]):t._e(),1==t.authority.b_nopass?i("el-button",{attrs:{plain:"",icon:"iconfont icon-fanshenhe",size:"mini"},on:{click:t.unAudit}},[t._v(" 弃审")]):t._e()],1),i("div",{staticClass:"table_container"},[i("xTable",{ref:"xTable",attrs:{ajax:{url:"DefectiveProductDefectiveProduct",params:t.params},tableColumn:t.tableColumn,xData:t.tableData}})],1)])])},s=[],n={auditor_status:0,form_type:0,order_type:0,company_id:localStorage.getItem("company_id"),company_name:localStorage.getItem("company_name")},r={data:function(){var t=this,e=this.$createElement;return{footerData:{},tableColumn:[{type:"checkbox",width:44,align:"center"},{type:"index",title:"序号",width:50},{title:"操作",width:90,fixed:"right",slots:{default:function(i){return[e("el-button",{attrs:{size:"small",type:"text",disabled:1!=t.authority.b_info},on:{click:function(){return t.LookOver(i.row)}}},[" 查看 "]),e("el-button",{attrs:{size:"small",type:"text",disabled:1!=t.authority.b_edit||"未审核"!==i.row.auditor_status||!t.isShowBtn},on:{click:function(){return t.modify(i.row)}}},[" 修改  "])]}}},{title:"库存组织",field:"company_name",width:150},{title:"单据号",field:"conversion_sn",width:150,slots:{default:function(e,i){return[i("el-link",{on:{click:function(){t.LookOver(e.row)}}},[e.row.conversion_sn," "])]}}},{title:"数量",field:"sub_goods_num",width:70},{title:"单据类型",field:"order_type",width:100},{title:"部门",field:"department_name",width:100},{title:"创建人",field:"add_user_name",width:100},{title:"业务日期",field:"business_time",width:90},{title:"单据时间",field:"add_time",width:145},{title:"来源",field:"form_type",width:132},{title:"审核状态",field:"auditor_status",width:70},{title:"审核人",field:"auditor_name",width:84},{title:"审核时间",field:"auditor_time",width:145},{title:"修改人",field:"update_user_name",width:130},{title:"修改时间",field:"update_time",width:150},{title:"备注",field:"abstract",width:145}]}}},o=i("65b0"),l=i("4997"),c={name:"Incomplete",mixins:[r],data:function(){return{params:this.$publicFution.deepCopy(n),isShowBtn:!0,AuditDate:[],timeValue:[]}},methods:{companyChange:function(){Object(o["a"])(this,this.params)},audit:function(){var t=new l["a"]({id:"conversion_id",_this:this,title:"审核",url:"ConversionsAuditorPassOrder",showConfirm:!0});t.send()},unAudit:function(){var t=new l["a"]({id:"conversion_id",_this:this,title:"弃审",url:"ConversionsAntiAuditorOrder",showConfirm:!0});t.send()},abolish:function(){var t=new l["a"]({id:"conversion_id",_this:this,title:"作废",url:"ConversionsInvalidOrder",showConfirm:!0});t.send()},deletes:function(){var t=new l["a"]({id:"conversion_id",_this:this,title:"删除",url:"ConversionsDelOrder",showConfirm:!0});t.send()},LookOver:function(t){this.$router.push({path:"/inventory/Incomplete/IncompleteSee",query:{conversion_id:t.conversion_id}})},NewList:function(){this.$router.push({path:"/inventory/Incomplete/IncompleteNew"})},modify:function(t){this.$router.push({path:"/inventory/Incomplete/IncompleteNew",query:{conversion_id:t.conversion_id}})},onReset:function(){this.timeValue=[],this.AuditDate=[],this.params=this.$publicFution.deepCopy(n),this.onSearch()},onSearch:function(){this.AuditDate?(this.params.start_auditor_time=this.AuditDate[0],this.params.end_auditor_time=this.AuditDate[1]):this.params.start_auditor_time=this.params.end_auditor_time="",this.timeValue?(this.params.start_business_time=this.timeValue[0],this.params.end_business_time=this.timeValue[1]):this.params.start_business_time=this.params.end_business_time="",this.$refs.xTable._getData()}},activated:function(){this.onSearch(window.goPage)}},d=c,u=i("2877"),h=Object(u["a"])(d,a,s,!1,null,null,null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-3e8d9975.8b45a86d.js.map