(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-08fcebac"],{2941:function(e,t,a){},"69d3":function(e,t,a){"use strict";a("2941")},"89d8":function(e,t,a){"use strict";a("d81d"),a("caad"),a("b680");var i={data:function(){var e=this;return{tableColumn:[{type:"checkbox",width:40},{field:"business_type_name",title:"业务类型",width:150},{field:"brand_name",title:"品牌",width:150},{field:"goods_id",title:"商品编号",width:80},{field:"goods_name",title:"商品名称",width:300},{field:"batch",title:"年周/批次",width:200,editRender:{autoselect:!0,name:"vBatch",getParams:function(t){return{params:{company_id:e.params.company_id,warehouse_id:e.params.warehouse_id,goods_id:t.row.goods_id,bill_type:2}}},events:{change:function(e,t){var a=t.row;if(!a.goods_id)return!1;var i=e.warehouse_id,s=e.warehouse_name,r=e.allocation_name,o=e.allocation_id,n=e.available_stocks,l=e.batch,c=e.batch_id;Object.assign(a,{warehouse_id:i,warehouse_name:s,allocation_name:r,allocation_id:o,available_stocks:n,batch:l,batch_id:c})}}}},{field:"unit_name",title:"单位",width:80},{field:"warehouse_name",title:"仓库",width:132},{field:"allocation_name",title:"货位",width:170},{field:"real_num",title:"数量",width:130},{field:"goods_price",title:"原销售价",width:130},{field:"discount_unit_price",title:"原折后价",width:130},{field:"abrasion_price",title:"磨损费",width:130},{field:"intube_price",title:"内垫费",width:130},{field:"claim_price",title:"理赔单价",width:130},{field:"new_goods_price",title:"最新销售价",width:130},{field:"total_price",title:"小计金额",width:130},{field:"remark",title:"备注",width:150,showOverflow:!0,editRender:{name:"Vinput",formatter:"String"}}],tableData:[]}},methods:{activeMethod:function(e){var t=e.column,a=e.row;e.$rowIndex;return"remark"===t.property||("batch"===t.property?"三包折款"!=a.business_type_name:void 0)},addRow:function(){var e=this.$refs.xTable;e.createRow({production_time:"",allocation_id:null,batch:this.getWeek()}).then((function(t){e.insertAt(t,-1)})),this.referenceDisabled=!0},footerMethod:function(e){var t=this,a=e.columns,i=e.data;return[a.map((function(e,a){return 1===a?"合计":["total_price"].includes(e.property)?(t.totalPrice=t.$utils.sum(i,e.property).toFixed(2),t.$utils.sum(i,e.property).toFixed(2)):null}))]}}};t["a"]=i},"93ec":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"clock",rawName:"v-clock"}],staticClass:"search_container"},[a("el-form",{ref:"TableDataRef",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"库存组织",size:"mini",prop:"company_id",rules:e.rules.company_id}},[e._v(" "+e._s(function(){0==e.params.company_id&&(e.params.company_id=null)}())+" "),a("el-select",{attrs:{placeholder:"请选择",filterable:""},on:{change:e.companyChange,focus:e.companyListInvok},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"部门",size:"mini"}},[e._v(" "+e._s(function(){0==e.params.department_id&&(e.params.department_id=null)}())+" "),a("el-select",{attrs:{clearable:"",filterable:""},on:{focus:e.DepartmentListInvok},model:{value:e.params.department_id,callback:function(t){e.$set(e.params,"department_id",t)},expression:"params.department_id"}},e._l(e.departmentList,(function(e){return a("el-option",{key:e.department_id,attrs:{label:e.department_name,value:e.department_id}})})),1)],1),a("el-form-item",{attrs:{label:"业务员",size:"mini"}},[a("el-input",{attrs:{disabled:""},model:{value:e.params.business_name,callback:function(t){e.$set(e.params,"business_name",t)},expression:"params.business_name"}})],1),a("el-form-item",{attrs:{label:"选择客户",size:"mini",prop:"customer_id",rules:e.rules.customer_id}},[a("el-input",{attrs:{disabled:""},model:{value:e.params.customer_name,callback:function(t){e.$set(e.params,"customer_name",t)},expression:"params.customer_name"}})],1),a("el-form-item",{attrs:{label:"业务日期",size:"mini",prop:"business_time",rules:e.rules.business_time}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd"},model:{value:e.params.business_time,callback:function(t){e.$set(e.params,"business_time",t)},expression:"params.business_time"}})],1),a("el-form-item",{attrs:{label:"送货需求",size:"mini"}},[a("el-input",{attrs:{disabled:""},model:{value:e.params.delivery_demand_name,callback:function(t){e.$set(e.params,"delivery_demand_name",t)},expression:"params.delivery_demand_name"}})],1),a("el-form-item",{attrs:{label:"交货方式",size:"mini"}},[a("el-input",{attrs:{disabled:""},model:{value:e.params.hand_over_name,callback:function(t){e.$set(e.params,"hand_over_name",t)},expression:"params.hand_over_name"}})],1),a("el-form-item",{staticClass:"wauto",staticStyle:{"min-width":"312px"},attrs:{label:"所属区域",size:"mini",rules:[{required:!0,trigger:"blur"}]}},[a("el-input",{attrs:{disabled:""},model:{value:e.defaultAreaName,callback:function(t){e.defaultAreaName=t},expression:"defaultAreaName"}})],1),a("el-form-item",{attrs:{label:"详细地址",size:"mini",rules:[{required:!0}]}},[a("el-input",{attrs:{disabled:""},model:{value:e.params.address,callback:function(t){e.$set(e.params,"address",t)},expression:"params.address"}})],1),a("el-form-item",{attrs:{label:"收货人",size:"mini",rules:[{required:!0}]}},[a("el-input",{attrs:{disabled:""},model:{value:e.params.consignee_name,callback:function(t){e.$set(e.params,"consignee_name",t)},expression:"params.consignee_name"}})],1),a("el-form-item",{attrs:{label:"手机号",size:"mini",rules:[{required:!0}]}},[a("el-input",{attrs:{disabled:""},model:{value:e.params.consignee_mobile,callback:function(t){e.$set(e.params,"consignee_mobile",t)},expression:"params.consignee_mobile"}})],1),a("el-form-item",{attrs:{label:"出库类型",size:"mini"}},[a("el-input",{attrs:{value:"三包出库",disabled:""}})],1),a("el-form-item",{attrs:{label:"回款方式",size:"mini",prop:"payment_method"}},[e._v(" "+e._s(function(){0==e.params.settlement_customer_id&&(e.params.settlement_customer_id=null)}())+" "),a("el-select",{on:{change:e.paymentMethodChange},model:{value:e.params.payment_method,callback:function(t){e.$set(e.params,"payment_method",t)},expression:"params.payment_method"}},[a("el-option",{attrs:{label:"客户自结",value:1}},[e._v("客户自结")]),a("el-option",{attrs:{label:"物流代收",value:2}},[e._v("物流代收")])],1)],1),2===e.params.payment_method?a("el-form-item",{attrs:{label:"物流公司",size:"mini",prop:"settlement_customer_id",rules:e.rules.settlement_customer_id}},[e._v(" "+e._s(function(){0==e.params.settlement_customer_id&&(e.params.settlement_customer_id=null)}())+" "),a("el-select",{attrs:{clearable:"",filterable:"","filter-method":e.logisticsInvok},on:{focus:e.logisticsInvok,change:e.logisticsChanges},model:{value:e.params.settlement_customer_id,callback:function(t){e.$set(e.params,"settlement_customer_id",t)},expression:"params.settlement_customer_id"}},e._l(e.logisticsList,(function(e){return a("el-option",{key:e.logistics_id,attrs:{label:e.logistics_name,value:e.logistics_id}})})),1)],1):a("el-form-item",{attrs:{label:"物流公司",size:"mini",prop:"settlement_customer_id"}},[e._v(" "+e._s(function(){0==e.params.settlement_customer_id&&(e.params.settlement_customer_id=null)}())+" "),a("el-select",{attrs:{clearable:"",filterable:"","filter-method":e.logisticsInvok},on:{focus:e.logisticsInvok,change:e.logisticsChanges},model:{value:e.params.settlement_customer_id,callback:function(t){e.$set(e.params,"settlement_customer_id",t)},expression:"params.settlement_customer_id"}},e._l(e.logisticsList,(function(e){return a("el-option",{key:e.logistics_id,attrs:{label:e.logistics_name,value:e.logistics_id}})})),1)],1),a("el-form-item",{attrs:{label:"摘要",size:"mini"}},[a("el-input",{attrs:{type:"text"},model:{value:e.params.abstract,callback:function(t){e.$set(e.params,"abstract",t)},expression:"params.abstract"}})],1)],1)],1),a("div",{staticClass:"add_delet"},[a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:e.quoteOrder}},[e._v("引用单据")])],1),a("div",{staticClass:"table_container"},[a("vxe-grid",{ref:"xTable",attrs:{border:"","show-footer":"true","show-overflow":"tooltip",size:"mini","footer-method":e.footerMethod,"max-height":"500px",data:e.tableData,resizable:"",height:"500px","column-min-width":"100","mouse-config":{selected:!0},columns:e.tableColumn,"keyboard-config":{isArrow:!0,isDel:!1,isTab:!0,isEdit:!0},"edit-config":{trigger:"click",mode:"cell",autoClear:!1,activeMethod:e.activeMethod}}})],1),a("br"),a("el-form",{ref:"TableDataRef2",staticClass:"priceFoot",attrs:{model:e.params,inline:!0}},[a("el-form-item",{attrs:{label:"本单使用返利："}},[a("el-input",{staticClass:"element_input",attrs:{type:"number","suffix-icon":"el-icon-edit-outline",disabled:!0},on:{change:function(t){return e.toFixed2("rebate_price")}},nativeOn:{keyup:function(t){return e.countSettlementPrice.apply(null,arguments)}},model:{value:e.params.rebate_price,callback:function(t){e.$set(e.params,"rebate_price",t)},expression:"params.rebate_price"}}),a("span",{staticClass:"yeban"},[e._v("余额:"+e._s(e._f("priceFormat")(e.params.rebate_balance?e.params.rebate_balance:0)))])],1),a("el-form-item",{attrs:{label:"本单使用授信："}},[a("el-input",{staticClass:"element_input",attrs:{type:"number","suffix-icon":"el-icon-edit-outline",disabled:!0},on:{change:function(t){return e.toFixed2("credit_price")}},nativeOn:{keyup:function(t){return e.countSettlementPrice.apply(null,arguments)}},model:{value:e.params.credit_price,callback:function(t){e.$set(e.params,"credit_price",t)},expression:"params.credit_price"}}),a("span",{staticClass:"yeban"},[e._v("余额:"+e._s(e._f("priceFormat")(e.params.credit_balance?e.params.credit_balance:0)))])],1),a("el-form-item",{attrs:{label:"本单使用预收："}},[a("el-input",{staticClass:"element_input",attrs:{"suffix-icon":"el-icon-edit-outline",type:"number",disabled:!0},on:{change:function(t){return e.toFixed2("deposits_price")}},nativeOn:{keyup:function(t){return e.countSettlementPrice.apply(null,arguments)}},model:{value:e.params.deposits_price,callback:function(t){e.$set(e.params,"deposits_price",t)},expression:"params.deposits_price"}}),a("span",{staticClass:"yeban"},[e._v("余额:"+e._s(e._f("priceFormat")(e.params.deposits?e.params.deposits:0)))])],1),a("el-form-item",{attrs:{label:"客户余额："}},[a("el-input",{staticClass:"element_input",attrs:{disabled:""},model:{value:e.params.balance,callback:function(t){e.$set(e.params,"balance",t)},expression:"params.balance"}}),a("el-button",{attrs:{type:"primary"},on:{click:e.seeMoneyDetail}},[e._v("查看往来")])],1),a("el-form-item",{attrs:{label:"本单结算金额："}},[a("span",[e._v(e._s(e.params.settlement_price))])])],1),a("br"),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.goBack}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("TableDataRef")}}},[e._v("确 定")])],1),e.dialogBillVisible?a("div",[a("el-dialog",{staticClass:"dialogForm",attrs:{"close-on-click-modal":!1,title:"选择订单",visible:e.dialogBillVisible,width:"1030px"},on:{"update:visible":function(t){e.dialogBillVisible=t}}},[a("source-bill",{attrs:{companyId:e.params},on:{dialogformInline:e.dialogformInline,closedialog:e.closeDialog}})],1)],1):e._e()],1)},s=[],r=a("ade3"),o=a("5530"),n=(a("b680"),a("a9e3"),a("4de4"),a("d3b7"),a("a15b"),a("159b"),a("b64b"),a("99af"),a("e9c4"),a("d81d"),a("caad"),a("2f62")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search_container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"库存组织",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",disabled:!0,filterable:""},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"业务日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeValue,callback:function(t){e.timeValue=t},expression:"timeValue"}})],1),a("el-form-item",{attrs:{label:"客户名称",size:"mini"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请输入",loading:e.loading,remote:"","remote-method":e.clienteleListInvok},on:{focus:e.clienteleListInvok},model:{value:e.params.customer_id,callback:function(t){e.$set(e.params,"customer_id",t)},expression:"params.customer_id"}},[a("ul",{staticClass:"customer customer-ul4 customer-ul2"},[a("li",[e._v("客户编号")]),a("li",[e._v("客户名称")]),a("li",[e._v("联系人")]),a("li",[e._v("联系电话")]),a("li",[e._v("区域")])]),e._l(e.customerList,(function(t){return a("el-option",{key:t.customer_id,attrs:{label:t.customer_name,value:t.customer_id}},[a("ul",{staticClass:"customer customer-ul4"},[a("li",{attrs:{title:t.customer_id}},[e._v(e._s(t.customer_id))]),a("li",{attrs:{title:t.customer_name}},[e._v(e._s(t.customer_name))]),a("li",{attrs:{title:t.contact_name}},[e._v(e._s(t.contact_name))]),a("li",{attrs:{title:t.customer_mobile}},[e._v(e._s(t.customer_mobile))]),a("li",[e._v(e._s(t.province_name)+"/"+e._s(t.city_name)+"/"+e._s(t.area_name))])])])}))],2)],1),a("el-form-item",{attrs:{label:"单据号",size:"mini"}},[a("el-input",{staticClass:"shortSearchInput",attrs:{placeholder:"请输入"},model:{value:e.params.order_sn,callback:function(t){e.$set(e.params,"order_sn",t)},expression:"params.order_sn"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"table_container"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableData.tableData,"max-height":"600"},on:{"row-click":e.selectTableData}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"50",label:"选择"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{attrs:{label:t.row.order_id},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(null))])]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"company_name",label:"销售组织","min-width":"120"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"order_sn",label:"单据号","min-width":"148"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"department_name",label:"部门","min-width":"100"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"customer_name",label:"客户名称","min-width":"120"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"num",label:"商品数量",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"order_price",label:"订单金额",align:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.order_price)+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"credit_price",label:"本单使用授信",align:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.credit_price)+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"rebate_price",label:"本单使用返利",align:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.rebate_price)+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"settlement_price",label:"结算金额",align:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.settlement_price)+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"business_time",label:"业务日期",width:"110"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"abstract",width:"180",label:"备注"}})],1)],1),a("div",{staticClass:"page_container"},[a("div",{staticClass:"pageNumber"},[e._v("每页显示")]),a("el-pagination",{staticClass:"erp-pagination",attrs:{"current-page":e.goPage,"page-size":e.pageSize1,"page-sizes":[30,50,100,500],layout:"sizes, prev, pager, next",prevText:"上一页",nextText:"下一页",total:e.TableData.total},on:{"update:currentPage":function(t){e.goPage=t},"update:current-page":function(t){e.goPage=t},"current-change":e.handleCurrentChange}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit()}}},[e._v("确 定")])],1)])},c=[],m=a("65b0"),d={data:function(){return{radio:null,order_id:null,timeValue:[],searchParams:{},TableData:{tableData:[],total:10},is_shop:0,loading:!1}},props:["companyId"],methods:{selectTableData:function(e){this.radio=e.order_id,this.order_id=e.order_id},cancel:function(){this.$emit("closedialog",!1)},submit:function(){var e=this;this.order_id?this.$axMethod.referenceOrderInfo({order_id:this.order_id,order_type:1}).then((function(t){var a=t.data;e.$emit("dialogformInline",a.data)})):this.$message.warning("请选择订单"),Object.assign(this.searchParams.params,this.params,{page:1}),Object(m["g"])(this.searchParams)},handleCurrentChange:function(e){Object.assign(this.searchParams.params,{page:e}),Object(m["g"])(this.searchParams)},onSearch:function(){this.timeValue&&2==this.timeValue.length?(this.params.business_start_time=this.timeValue[0],this.params.business_end_time=this.timeValue[1]):this.params.business_start_time=this.params.business_end_time="",Object.assign(this.searchParams.params,this.params,{page:1}),Object(m["g"])(this.searchParams)},onReset:function(){this.$set(this,"params",{order_type:1,company_id:this.companyId.company_id}),this.timeValue=[],this.$set(this,"searchParams",{params:this.params,TableData:this.TableData,API:"referenceOrderListPublics",vm:this}),Object(m["g"])(this.searchParams)}},mounted:function(){var e=this;this.$set(this,"params",{order_type:1,company_id:this.companyId.company_id}),this.companyId.company_name?this.$nextTick((function(){e.companyList=[{company_id:e.companyId.company_id,company_name:e.companyId.company_name}]})):this.$nextTick((function(){e.companyList=[{company_id:e.companyId.company_id,company_name:localStorage.company_name}]})),this.$set(this,"searchParams",{params:this.params,TableData:this.TableData,API:"referenceOrderListPublics",vm:this}),Object(m["g"])(this.searchParams)}},p=d,_=a("2877"),u=Object(_["a"])(p,l,c,!1,null,"181e8eb2",null),b=u.exports,h=a("89d8"),f={name:"instorageThreeoutstorageThreeoutstorageAddOrder",mixins:[h["a"]],data:function(){return{authority:{},defaultArea:[0],defaultAreaName:"",rowIndex:null,params:{},tableData:[],multipleSelection:[],multiGoodsList:{},cityList:[],dialogBillVisible:!1,totalPrice:0}},components:{sourceBill:b},computed:Object(o["a"])({},Object(n["c"])(["threeoutstorageAddGet"])),methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])(["threeoutstorageAddACT","threeoutstorageIndexACT","creditmanageAdd_show"])),{},{settlement_price:function(e,t,a,i){return 1==e.business_type?(this.$set(this.TableData.tableData[i],"settlement_price",-e.claim_price?-e.claim_price:0),Number(e.settlement_price).toFixed(2)):(this.$set(this.TableData.tableData[i],"settlement_price",e.goods_num*e.new_goods_price?Number(e.goods_num)*Number(e.new_goods_price):0),Number(e.settlement_price).toFixed(2))},confirm:function(e,t,a){var i=this;if("batch_id"==a&&Array.isArray(e.batchList)){var s=e.batchList.filter((function(t){return t.batch_id==e.batch_id}))[0];["warehouse_id","warehouse_name","allocation_name","allocation_id","batch","batch_id"].forEach((function(e){i.$set(i.TableData.tableData[t],e,s[e])}))}},getBatchList:function(e,t){var a=this;this.$axMethod.getBatchlist({company_id:this.params.company_id,customer_id:this.params.customer_id,goods_id:e.goods_id}).then((function(e){a.$set(a.TableData.tableData[t],"batchList",e.data.data)}))},paymentMethodChange:function(e){var t=this;2===this.params.payment_method?setTimeout((function(){t.$refs.TableDataRef.validateField(["settlement_customer_id"])}),50):this.$refs.TableDataRef.clearValidate("settlement_customer_id")},goBack:function(){this.$router.push({path:"/inventory/threeoutstorage"})},countSettlementPrice:function(){var e=this,t=["rebate_price","credit_price","deposits_price"];t.forEach((function(t){e.$set(e.params,t,!e.params[t]||e.params[t]<0?0:e.params[t])}));var a=Number(this.totalPrice)-Number(this.params.rebate_price)-Number(this.params.credit_price)-Number(this.params.deposits_price);this.$set(this.params,"settlement_price",a.toFixed(2))},toFixed2:function(e){var t=this;this.$nextTick((function(){t.params[e]&&!isNaN(t.params[e])||(t.params[e]=0),t.params[e]=Number(t.params[e]).toFixed(2)}))},seeMoneyDetail:function(){this.$router.push({path:"/custom/accountlog"})},getCustomerInfo:function(){var e=this,t={customer_id:this.params.customer_id,company_id:this.params.company_id,is_three_packs:1};this.$axMethod.getCustomerInfoNEWqx(t).then((function(t){var a=t.data;e.$set(e.params,"deposits",a.data.deposits),e.$set(e.params,"credit_balance",a.data.credit_balance),e.$set(e.params,"balance",a.data.balance),e.$set(e.params,"rebate_balance",a.data.rebate_balance),e.countSettlementPrice()}))},quoteOrder:function(){this.dialogBillVisible=!0},closeDialog:function(e){this.dialogBillVisible=!1},changeDefaultArea:function(e){this.params.cityList=e.join(","),this.params.province_id=e[0],this.params.city_id=e[1],this.params.area_id=e[2]},dialogformInline:function(e){var t=this,a={};this.logisticsList.push({logistics_id:e.intentional_logistics_id,logistics_name:e.intentional_logistics}),Object.keys(e).forEach((function(t){"goods_info"!=t&&(a[t]=e[t])})),a.settlement_customer_id=this.params.settlement_customer_id?this.params.settlement_customer_id:e.intentional_logistics_id,this.defaultAreaName="".concat(e.province_name,"/").concat(e.city_name,"/").concat(e.area_name),this.defaultArea=[e.province_id,e.city_id,e.area_id],this.params.cityList=this.defaultArea.join(","),this.params.province_id=this.defaultArea[0],this.params.city_id=this.defaultArea[1],this.params.area_id=this.defaultArea[2],Object(m["l"])(this,a),this.$set(this,"params",Object.assign({},this.params,a)),this.tableData=[],e.goods_info.forEach((function(e,a){t.tableData.push(Object(r["a"])({order_goods_id:e.order_goods_id,claim_price:e.claim_price,business_type:e.business_type,business_type_name:e.business_type_name,brand_name:e.brand_name,goods_id:e.goods_id,goods_name:e.goods_name,batch_id:e.batch_id,batch:e.batch,unit_name:e.unit_name,warehouse_name:e.warehouse_name,warehouse_id:e.warehouse_id?e.warehouse_id:"",allocation_name:e.allocation_name,allocation_id:e.allocation_id?e.allocation_id:"",real_num:e.goods_num,goods_num:e.goods_num,goods_price:e.goods_price,discount_unit_price:e.discount_price,new_goods_price:e.new_goods_price,abrasion_price:e.abrasion_price,intube_price:e.intube_price,batchList:[{batch:e.batch,batch_id:e.batch_id}],total_price:e.total_price,settlement_price:e.settlement_price,remark:e.remark},"batchList",[{batch:e.batch,batch_id:e.batch_id}]))})),this.dialogBillVisible=!1,this.getCustomerInfo(),this.$nextTick((function(){t.$refs.xTable.updateFooter()}))},submit:function(e){var t=this,a=!0,i=this;this.params.rebate_price||(this.params.rebate_price=0),this.params.goods_info=[],this.$refs[e].validate((function(e){if(e){if(!t.$refs.xTable.getTableData().fullData.length)return t.$message.error("请先选择订单"),!1;if(a=t.$refs.xTable.getTableData().fullData.every((function(e){return 2==e.business_type&&e.batch_id||2!=e.business_type})),!a)return t.$message({message:"请选择批次",type:"error"}),!1;t.$refs.xTable.getTableData().fullData.forEach((function(e){t.params.goods_info.push({order_goods_id:e.order_goods_id,goods_id:e.goods_id,batch_id:e.batch_id,unit_name:e.unit_name,warehouse_id:e.warehouse_id,warehouse_name:e.warehouse_name,allocation_id:e.allocation_id?e.allocation_id:0,allocation_name:e.allocation_name?e.allocation_name:"",discount_unit_price:e.discount_unit_price,unit_credit_price:e.unit_credit_price,unit_rebate_price:e.unit_rebate_price,unit_deposits_price:e.unit_deposits_price,company_id:t.params.company_id,company_name:t.params.company_name,remark:e.remark,real_num:e.real_num,claim_price:e.claim_price,business_type:e.business_type,goods_price:e.goods_price,outstock_goods_id:e.outstock_goods_id?e.outstock_goods_id:0,batch:e.batch,new_goods_price:e.new_goods_price,abrasion_price:e.abrasion_price,total_price:e.total_price,intube_price:e.intube_price})})),t.params.goods_info=JSON.stringify(t.params.goods_info);var s=t.params.goods_info;if(s=JSON.parse(s),s=s.filter((function(e){return 2==e.business_type})),a){var r=s.map((function(e){return{warehouse_id:e.warehouse_id,warehouse_name:e.warehouse_name,allocation_id:e.allocation_id,goods_id:e.goods_id,order_goods_id:e.order_goods_id||0,sale_price:e.new_goods_price||0,batch:e.batch,batch_id:e.batch_id,goods_num:e.real_num}}));t.$baseData.checkCarDoctor({company_id:t.params.company_id,company_name:t.params.company_name,bill_type:13,operation_type:1,goods_info:JSON.stringify(r)}).then((function(){t.$axMethod.safetyStockCheck({company_id:t.params.company_id,company_name:t.params.company_name,business_time:t.params.business_time,bill_logogram:"tbck",order_type:1,goods_info:JSON.stringify(r)}).then((function(){Object(m["m"])(t,{company_id:t.params.company_id,goods_info:JSON.stringify(s),status:1,type:3},(function(){i.$axMethod.addThreeOutStorage(i.params).then((function(e){var t=e.data;200==t.code&&(i.$message({message:t.data,type:"success"}),i.goBack())}))}))}))}))}}}))},companyChange:function(e){this.tableData=[],this.$set(this.params,"department_id",null),e&&(this.params.company_name=this.companyList.filter((function(t){return t.company_id===e}))[0].company_name),this.params.credit_balance=null,this.params.deposits=null,this.params.balance=null,this.params.rebate_balance=null}}),created:function(){var e=localStorage,t=e.employee_id,a=e.company_admin_id;[0,1,2].includes(Number(t))||a>0?this.$set(this,"params",{business_time:this.$publicFution.formatData(new Date),company_id:Number(localStorage.company_id),company_admin_id:Number(localStorage.company_admin_id)}):this.$set(this,"params",{business_time:this.$publicFution.formatData(new Date),company_id:Number(localStorage.company_id),department_id:Number(localStorage.department_id),business_id:Number(localStorage.employee_id),company_admin_id:Number(localStorage.company_admin_id)}),Object(m["l"])(this,localStorage)}},g=f,y=(a("69d3"),Object(_["a"])(g,i,s,!1,null,"09416d2c",null));t["default"]=y.exports},b680:function(e,t,a){"use strict";var i=a("23e7"),s=a("da84"),r=a("e330"),o=a("5926"),n=a("408a"),l=a("1148"),c=a("d039"),m=s.RangeError,d=s.String,p=Math.floor,_=r(l),u=r("".slice),b=r(1..toFixed),h=function(e,t,a){return 0===t?a:t%2===1?h(e,t-1,a*e):h(e*e,t/2,a)},f=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},g=function(e,t,a){var i=-1,s=a;while(++i<6)s+=t*e[i],e[i]=s%1e7,s=p(s/1e7)},y=function(e,t){var a=6,i=0;while(--a>=0)i+=e[a],e[a]=p(i/t),i=i%t*1e7},v=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var i=d(e[t]);a=""===a?i:a+_("0",7-i.length)+i}return a},w=c((function(){return"0.000"!==b(8e-5,3)||"1"!==b(.9,0)||"1.25"!==b(1.255,2)||"1000000000000000128"!==b(0xde0b6b3a7640080,0)}))||!c((function(){b({})}));i({target:"Number",proto:!0,forced:w},{toFixed:function(e){var t,a,i,s,r=n(this),l=o(e),c=[0,0,0,0,0,0],p="",b="0";if(l<0||l>20)throw m("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return d(r);if(r<0&&(p="-",r=-r),r>1e-21)if(t=f(r*h(2,69,1))-69,a=t<0?r*h(2,-t,1):r/h(2,t,1),a*=4503599627370496,t=52-t,t>0){g(c,0,a),i=l;while(i>=7)g(c,1e7,0),i-=7;g(c,h(10,i,1),0),i=t-1;while(i>=23)y(c,1<<23),i-=23;y(c,1<<i),g(c,1,1),y(c,2),b=v(c)}else g(c,0,a),g(c,1<<-t,0),b=v(c)+_("0",l);return l>0?(s=b.length,b=p+(s<=l?"0."+_("0",l-s)+b:u(b,0,s-l)+"."+u(b,s-l))):b=p+b,b}})}}]);
//# sourceMappingURL=chunk-08fcebac.6e3606db.js.map