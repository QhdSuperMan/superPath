(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-fc33e80e"],{"31dc":function(e,t,a){"use strict";a("3bbf")},"3bbf":function(e,t,a){},adbe:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading1,expression:"loading1"}],staticClass:"customReceiptWrapper"},[a("div",{staticClass:"search_container"},[a("el-form",{ref:"TableDataRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"财务组织",size:"mini",prop:"company_id"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",remote:"","remote-method":e.companyListInvok,maxlength:"100"},on:{change:e.companyChange,focus:e.companyListInvok},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"单据号",size:"mini"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"100"},model:{value:e.params.business_sn,callback:function(t){e.$set(e.params,"business_sn",t)},expression:"params.business_sn"}})],1),a("el-form-item",{attrs:{label:"往来类型",size:"mini"}},[a("el-select",{attrs:{"collapse-tags":"",multiple:""},on:{focus:e.getCurrentAccountListInvok,change:e.accountsTypeChange},model:{value:e.accountsTypeArr,callback:function(t){e.accountsTypeArr=t},expression:"accountsTypeArr"}},e._l(e.customAccountypeList,(function(e){return a("el-option",{key:e.accounts_type_id,attrs:{label:e.accounts_type_name,value:e.accounts_type_id}})})),1)],1),a("el-form-item",{attrs:{label:"客户名称",size:"mini"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请输入",loading:e.loading,remote:"","remote-method":e.clienteleListInvok},on:{change:e.getCustomer,focus:e.clienteleListInvok},model:{value:e.params.customer_id,callback:function(t){e.$set(e.params,"customer_id",t)},expression:"params.customer_id"}},[a("ul",{staticClass:"customer customer-ul4 customer-ul2"},[a("li",[e._v("客户编号")]),a("li",[e._v("客户名称")]),a("li",[e._v("联系人")]),a("li",[e._v("联系电话")]),a("li",[e._v("区域")])]),e._l(e.customerList,(function(t){return a("el-option",{key:t.customer_id,attrs:{label:t.customer_name,value:t.customer_id}},[a("ul",{staticClass:"customer customer-ul4"},[a("li",{attrs:{title:t.customer_id}},[e._v(e._s(t.customer_id))]),a("li",{attrs:{title:t.customer_name}},[e._v(e._s(t.customer_name))]),a("li",{attrs:{title:t.contact_name}},[e._v(e._s(t.contact_name))]),a("li",{attrs:{title:t.customer_mobile}},[e._v(e._s(t.customer_mobile))]),a("li",[e._v(e._s(t.province_name)+"/"+e._s(t.city_name)+"/"+e._s(t.area_name))])])])}))],2)],1),a("el-form-item",{attrs:{label:"核销单据号",size:"mini"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入",maxlength:"100"},model:{value:e.params.bill_sn,callback:function(t){e.$set(e.params,"bill_sn",t)},expression:"params.bill_sn"}})],1),a("el-form-item",{attrs:{label:"核销类型",size:"mini"}},[a("el-select",{attrs:{clearable:"","collapse-tags":"",multiple:""},on:{change:e.billTypeChange},model:{value:e.billArr,callback:function(t){e.billArr=t},expression:"billArr"}},[a("el-option",{attrs:{label:"销售出库单",value:1}},[e._v("销售出库单")]),a("el-option",{attrs:{label:"销售退货单",value:2}},[e._v("销售退货单")]),a("el-option",{attrs:{label:"客户期初",value:3}},[e._v("客户期初")]),a("el-option",{attrs:{label:"调拨出库",value:4}},[e._v("调拨出库")]),a("el-option",{attrs:{label:"三包出库",value:5}},[e._v("三包出库")])],1)],1),a("el-form-item",{attrs:{label:"部门",size:"mini"}},[e._v(" "+e._s(function(){0==e.params.department_id&&(e.params.department_id=null)}())+" "),a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",remote:"","remote-method":e.DepartmentListInvok},on:{focus:e.DepartmentListInvok},model:{value:e.params.department_id,callback:function(t){e.$set(e.params,"department_id",t)},expression:"params.department_id"}},e._l(e.departmentList,(function(e){return a("el-option",{key:e.department_id,attrs:{label:e.department_name,value:e.department_id}})})),1)],1),a("el-form-item",{attrs:{label:"业务员",size:"mini"}},[a("el-select",{attrs:{clearable:""},on:{focus:e.EmployeeListInvok},model:{value:e.params.business_id,callback:function(t){e.$set(e.params,"business_id",t)},expression:"params.business_id"}},e._l(e.employeeList,(function(e){return a("el-option",{key:e.employee_id,attrs:{label:e.employee_name,value:e.employee_id}})})),1)],1),a("el-form-item",{attrs:{label:"物流公司",size:"mini"}},[a("el-select",{attrs:{clearable:"",filterable:"",remote:"","remote-method":e.logisticsInvok},on:{clear:function(t){return e.clickClear(e.params,["settlement_customer_name"])},focus:e.logisticsInvok},model:{value:e.params.logistics_id,callback:function(t){e.$set(e.params,"logistics_id",t)},expression:"params.logistics_id"}},e._l(e.logisticsList,(function(e){return a("el-option",{key:e.logistics_id,attrs:{label:e.logistics_name,value:e.logistics_id}})})),1)],1),a("el-form-item",{attrs:{label:"审核状态",size:"mini"}},[a("el-select",{attrs:{clearable:""},model:{value:e.params.auditor_status,callback:function(t){e.$set(e.params,"auditor_status",t)},expression:"params.auditor_status"}},[a("el-option",{attrs:{label:"全部",value:0}},[e._v("全部")]),a("el-option",{attrs:{label:"未审核",value:1}},[e._v("未审核")]),a("el-option",{attrs:{label:"已审核",value:2}},[e._v("已审核")]),a("el-option",{attrs:{label:"作废",value:3}},[e._v("作废")])],1)],1),a("el-form-item",{attrs:{label:"业务日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:""},on:{change:function(t){return e.timeChange(t,1)}},model:{value:e.businessTimeValue,callback:function(t){e.businessTimeValue=t},expression:"businessTimeValue"}})],1),a("el-form-item",{attrs:{label:"审核日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:""},on:{change:e.timeChange},model:{value:e.auditorTimeValue,callback:function(t){e.auditorTimeValue=t},expression:"auditorTimeValue"}})],1),a("el-form-item",{attrs:{label:"备注",size:"mini"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入备注"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.params.remark,callback:function(t){e.$set(e.params,"remark",t)},expression:"params.remark"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1),1==e.authority.b_export&&e.listShow?a("div",{staticClass:"add_delet"},[a("el-dropdown",{attrs:{placement:"bottom-start"}},[a("span",{staticStyle:{cursor:"pointer",color:"#4e90e2"},attrs:{"split-button":""}},[a("el-button",{attrs:{plain:"",icon:"iconfont icon-daochu10",size:"mini"}},[e._v("导出")])],1),a("el-dropdown-menu",{staticStyle:{"margin-top":"10px"},attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(1)}}},[e._v("导出Excel文件")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(2)}}},[e._v("导出CSV逗号分隔")])],1)],1)],1):e._e(),a("div",{staticClass:"table_container"},[a("vxe-grid",{ref:"xTable",attrs:{border:"","show-header-overflow":!0,"show-overflow":"tooltip","show-footer":"true","footer-method":e.footerMethod,data:e.TableData.tableData,columns:e.tableColumn,size:"mini",resizable:"","max-height":350}}),a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"report_row"},[e._v("生成时间："+e._s(e.TableData.now_time))])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"textAr report_row"},[e._v(" 制表人："+e._s(e.TableData.user_name))])])],1),a("div",{staticClass:"page_container"},[a("div",{staticClass:"pageNumber"},[e._v("每页显示")]),a("el-pagination",{staticClass:"erp-pagination",attrs:{"current-page":e.goPage,"page-size":e.pageSize1,"page-sizes":e.per_page,layout:"total,sizes, prev, pager, next,jumper",prevText:"上一页",nextText:"下一页",total:e.TableData.total},on:{"size-change":e.module_handleSizeChange,"update:currentPage":function(t){e.goPage=t},"update:current-page":function(t){e.goPage=t},"current-change":e.module_handleCurrentChange}})],1)],1)])},s=[],l=a("5530"),r=(a("d3b7"),a("25f0"),a("159b"),a("a9e3"),a("caad"),a("65b0")),o=(a("d81d"),{data:function(){return{tableColumn:[{type:"index",title:"序号",width:60,align:"center",showOverflow:!0},{field:"company_name",title:"财务组织",width:180,showOverflow:!0},{field:"business_time",title:"业务日期",width:150,showOverflow:!0},{field:"business_sn",title:"单据号",width:180,showOverflow:!0},{field:"accounts_type_name",title:"往来类型",width:100,showOverflow:!0},{field:"total_price",title:"收款金额",width:100,showOverflow:!0,formatter:this.formatterValue},{field:"bill_sn",title:"核销单据号",width:180,showOverflow:!0},{field:"bill_type",title:"核销类型",width:100,showOverflow:!0},{field:"customer_name",title:"客户名称",width:100,showOverflow:!0},{field:"bill_business_time",title:"核销业务日期",width:100,showOverflow:!0},{field:"sales_price",title:"核销应收总额",width:100,showOverflow:!0,formatter:this.formatterValue},{field:"bill_receipt_price",title:"本单核销金额",width:100,showOverflow:!0,formatter:this.formatterValue},{field:"logistics_name",title:"物流公司",width:100,showOverflow:!0},{field:"logistics_number",title:"物流票号",width:100,showOverflow:!0},{field:"department_name",title:"部门",width:100,showOverflow:!0},{field:"business_name",title:"业务员",width:100,showOverflow:!0},{field:"add_user_name",title:"创建人",width:100,showOverflow:!0},{field:"add_time",title:"创建时间",width:150,showOverflow:!0},{field:"auditor_status",title:"审核状态",width:100,showOverflow:!0},{field:"auditor_user_name",title:"审核人",width:100,showOverflow:!0},{field:"auditor_time",title:"审核日期",width:150,showOverflow:!0},{field:"remark",title:"收款备注",width:150,showOverflow:!0},{field:"bill_remark",title:"核销备注",width:150,showOverflow:!0}],tableData:[]}},methods:{updateFooter:function(){this.$refs.xTable.updateFooter()},rowspanMethod:function(e){var t=e.row,a=(e.$rowIndex,e.column),i=(e.data,["company_name","business_time","business_sn","accounts_type_name","total_price"]);if(i.includes(a.property))return t.rowspan||0==t.rowspan?{rowspan:t.rowspan,colspan:1}:{rowspan:1,colspan:1}},footerMethod:function(e){var t=this,a=e.columns,i=e.data;return[a.map((function(e,a){return 1===a?"页小计":["bill_receipt_price","total_price"].includes(e.property)?t.$options.filters["priceFormatNone"](t.$utils.sum(i,e.property)):null})),a.map((function(e,a){return 1===a?"合计":"bill_receipt_price"==e.property?t.TableData.all_bill_receipt_price:"total_price"==e.property?t.TableData.all_total_price:null}))]}}}),n=o,c={name:"customCustomerbillCustomeReceiptDetail",mixins:[n],data:function(){return{totalLoading:!1,billArr:[],accountsTypeArr:[],listShow:!1,auditorTimeValue:[],businessTimeValue:[],loading:!1}},components:{},computed:{customAccountypeList:function(){var e=this.accountypeList;return e.length>0&&e.push({accounts_type_id:4,accounts_type_name:"预收冲应收"}),e}},methods:{portGetList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.TableData=this.TableData,t.API="getCustomReceiptBillDetailList",t.vm=this,this.portGetTotalSum(t.params),Object(r["g"])(t,"",(function(t){if(200==t.data.code){var a=t.data.data;e.$set(e.TableData,"user_name",a.user_name),e.$set(e.TableData,"now_time",a.now_time),e.listShow=!0,e.$nextTick((function(){e.updateFooter()}))}}))},portGetTotalSum:function(e){var t=this;this.totalLoading=!0,this.$axMethod.getCustomReceiptBillDetailSum(e).then((function(e){var a=e.data;t.totalLoading=!1;var i=0,s=0;200==a.code?(i=t.$options.filters["priceFormatNone"](a.data.all_bill_receipt_price),s=t.$options.filters["priceFormatNone"](a.data.all_total_price)):403==a.code&&(i="无权限",s="无权限"),t.$set(t.TableData,"all_bill_receipt_price",i),t.$set(t.TableData,"all_total_price",s),t.$nextTick((function(){t.updateFooter()}))})).catch((function(e){t.totalLoading=!1}))},exportOrder:function(e){var t={params:Object(l["a"])({export_type:e},this.params),API:"exportCustomReceiptBillDetailListUrl"};Object(r["d"])(t)},module_handleSizeChange:function(e){Object.assign(this.searchParams.params,{per_page:e,page:1}),this.portGetList(this.searchParams)},module_handleCurrentChange:function(e){Object.assign(this.searchParams.params,{page:e}),this.portGetList(this.searchParams)},formatterValue:function(e){var t=e.cellValue,a=(e.row,e.column,this.$options.filters["priceFormatNone"](t));return a},companyChange:function(e){var t=this,a=["customer_id","business_id","department_id"];a.forEach((function(e){t.$set(t.params,e,"")}))},accountsTypeChange:function(e){this.params.accounts_type_id=this.accountsTypeArr.toString()},billTypeChange:function(e){this.params.bill_type=this.billArr.toString()},timeChange:function(e,t){var a="",i="";if(e&&e.length>=2)try{a=e[0],i=e[1]}catch(s){console.log("程序出错请检查。。。")}switch(t){case 1:this.params.business_start_time=a,this.params.business_end_time=i;break;default:this.params.auditor_start_time=a,this.params.auditor_end_time=i}},clickClear:function(e,t){t.forEach((function(t){e[t]=""}))},getCustomer:function(e){var t=this;if(e){if(!this.params.company_id)return;this.$axMethod.getCustomerInfoV2({company_id:this.params.company_id,customer_id:e}).then((function(e){var a=e.data;200==a.code&&a.data.business_id&&(t.$set(t.params,"business_id",a.data.business_id),t.employeeList=[{employee_id:a.data.business_id,employee_name:a.data.business_name}])}))}},getSummaries:function(e){var t=this,a=e.columns,i=e.data,s=[],l=["total_price","bill_receipt_price"],r=function(e){var t=0;return i.length>0&&(t=i.reduce((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1?arguments[1]:void 0;return isNaN(Number(a[e]))?t:t+Number(a[e])}),0)),t};return a.forEach((function(e,a){1!==a?l.includes(e["property"])?s[a]=t.$options.filters["priceFormatNone"](r(e["property"])):s[a]="":s[a]="页小计"})),s},initDownData:function(){var e=Number(localStorage.company_id);this.params={},this.$set(this.params,"company_id",e),this.$set(this.params,"auditor_status",0),this.companyList=[{company_id:Number(localStorage.company_id),company_name:localStorage.company_name}]},onReset:function(){this.accountsTypeArr=[],this.businessTimeValue=[],this.auditorTimeValue=[],this.billArr=[],this.initDownData(),this.listShow=!1,Object.assign(this.params,{page:1}),this.searchParams.params=this.params,this.portGetList(this.searchParams)},onSearch:function(){Object.assign(this.params,{page:1}),this.searchParams.params=this.params,this.portGetList(this.searchParams)}},mounted:function(){this.initDownData(),this.onSearch()}},m=c,p=(a("31dc"),a("2877")),u=Object(p["a"])(m,i,s,!1,null,"2ad9e0b5",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-fc33e80e.cbdd006f.js.map