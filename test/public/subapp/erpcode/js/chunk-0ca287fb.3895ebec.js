(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-0ca287fb"],{"0946":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"params"},[a("div",{attrs:{id:"leixin"}},[a("div",{staticClass:"search_container"},[a("el-form",{ref:"filterFormRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params}},[a("el-form-item",{attrs:{label:"公司名称",size:"mini"}},[a("erpCompanyList",{attrs:{fatherParams:t.params},model:{value:t.params.company_id,callback:function(e){t.$set(t.params,"company_id",e)},expression:"params.company_id"}})],1),a("el-form-item",{attrs:{label:"策略名称",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch(1)}},model:{value:t.params.price_strategy_name,callback:function(e){t.$set(t.params,"price_strategy_name",e)},expression:"params.price_strategy_name"}})],1),a("el-form-item",{attrs:{label:"品牌",size:"mini"}},[a("getBrand",{on:{change:function(e){return t.onSearch(1)}},model:{value:t.params.brand_id,callback:function(e){t.$set(t.params,"brand_id",e)},expression:"params.brand_id"}})],1),a("el-form-item",{attrs:{label:"策略有效年月",size:"mini"}},[a("el-date-picker",{attrs:{type:"monthrange","value-format":"yyyy-MM","range-separator":"至","start-placeholder":"开始月份","end-placeholder":"结束月份"},model:{value:t.policyMonth,callback:function(e){t.policyMonth=e},expression:"policyMonth"}})],1),a("el-form-item",{attrs:{label:"状态",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(e){return t.onSearch(1)}},model:{value:t.params.auditor_status,callback:function(e){t.$set(t.params,"auditor_status",e)},expression:"params.auditor_status"}},[a("el-option",{attrs:{label:"全部",value:0}},[t._v("全部")]),a("el-option",{attrs:{label:"未审核",value:1}},[t._v("未审核")]),a("el-option",{attrs:{label:"已审核",value:2}},[t._v("已审核")])],1)],1),a("el-form-item",{attrs:{label:"创建日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(e){return t.onSearch(1)}},model:{value:t.createdDay,callback:function(e){t.createdDay=e},expression:"createdDay"}})],1),a("el-form-item",{attrs:{label:"创建人",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch(1)}},model:{value:t.params.add_user_name,callback:function(e){t.$set(t.params,"add_user_name",e)},expression:"params.add_user_name"}})],1),a("el-form-item",{attrs:{label:"审核日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(e){return t.onSearch(1)}},model:{value:t.examineDay,callback:function(e){t.examineDay=e},expression:"examineDay"}})],1),a("el-form-item",{attrs:{label:"审核人",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch(1)}},model:{value:t.params.auditor_name,callback:function(e){t.$set(t.params,"auditor_name",e)},expression:"params.auditor_name"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.onSearch(1)}}},[t._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:t.onReset}},[t._v("重置")])],1)],1)],1),a("div",{staticClass:"add_delet"},[1==t.authority.b_add?a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:function(e){return t.goAdd({})}}},[t._v("新增")]):t._e(),1==t.authority.b_del?a("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.examination("删除")}}},[t._v("删除")]):t._e(),1==t.authority.b_pass?a("el-button",{attrs:{type:"primary",icon:"iconfont icon-pass",size:"mini"},on:{click:function(e){return t.examination("审核")}}},[t._v("审核")]):t._e(),1==t.authority.b_nopass?a("el-button",{staticClass:"addBtn",attrs:{plain:"",icon:"iconfont icon-fanshenhe",size:"mini"},on:{click:function(e){return t.examination("弃审")}}},[t._v("弃审")]):t._e(),1==t.authority.b_export?a("el-dropdown",{staticStyle:{margin:"0 10px"}},[a("span",{staticStyle:{cursor:"pointer",color:"#4e90e2"},attrs:{"split-button":""}},[a("el-button",{attrs:{plain:"",icon:"iconfont icon-daochu10",size:"mini"}},[t._v("导出")])],1),a("el-dropdown-menu",{staticStyle:{"margin-top":"10px"},attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(e){return t.exportOrder(1)}}},[t._v("导出Excel文件")]),a("el-dropdown-item",{nativeOn:{click:function(e){return t.exportOrder(2)}}},[t._v("导出CSV逗号分隔")])],1)],1):t._e()],1),a("div",[a("xTable",{ref:"xTable",attrs:{ajax:{url:"getPriceStrategyList",params:t.params},tableColumn:t.tableColumn}})],1)])])},r=[],n=(a("d81d"),a("a15b"),a("caad"),a("b680"),a("8ba4"),a("a9e3"),{company_id:localStorage.getItem("company_id"),company_name:localStorage.getItem("company_name"),price_strategy_name:"",brand_id:"",auditor_status:0,add_user_name:"",auditor_name:"",effective_start_time:"",effective_end_time:"",add_start_time:"",add_end_time:"",auditor_start_time:"",auditor_end_time:""}),o={data:function(){var t=this,e=this.$createElement;return{footerData:{},tableColumn:[{type:"checkbox",width:44,align:"center",fixed:"left"},{type:"index",title:"序号",width:50},{field:"name",title:"操作",width:100,fixed:"right",slots:{default:function(a){return[e("el-button",{attrs:{size:"small",type:"text",disabled:1!==t.authority.b_info},on:{click:function(){return t.goDetail(a.row)}}},[" 查看 "]),e("el-button",{attrs:{size:"small",type:"text",disabled:!(1===a.row.auditor_status&&1===t.authority.b_edit)},on:{click:function(){return t.goAdd(a.row)}}},[" 修改  "])]}}},{title:"单据号",field:"price_strategy_sn",width:150,slots:{default:function(a){var i=a.row;return[e("a",{attrs:{href:"javaScript:void()"},on:{click:function(){return t.goDetail(i)}}},[i.price_strategy_sn])]}}},{title:"组织名称",field:"company_name",width:150},{title:"策略名称",field:"price_strategy_name"},{title:"品牌",field:"brand_name",width:70},{title:"策略有效年月",field:"effective_time",headerAlign:"right",align:"right",width:170},{title:"审核状态",field:"auditor_status_name",width:70},{title:"创建时间",field:"add_time",width:150},{title:"创建人",field:"add_user_name",width:140},{title:"审核时间",field:"auditor_time",width:160},{title:"审核人",field:"auditor_name",width:84}]}},methods:{footerMethod:function(t){var e=this,a=t.columns,i=t.data;return[a.map((function(t,a){if(2===a)return"页小计";if(["total_num","total_price"].includes(t.property)){var r=e.$utils.sum(i,t.property);return"total_price"===t.property?e.$publicFution.priceFormatNone(r):"total_num"===t.property?e.$publicFution.priceFormatNone(r.toFixed(2)):Number.isInteger(r)?r:r.toFixed(2)}return null})),a.map((function(t,a){return 2===a?"合计":"total_num"===t.property&&e.footerData.total_num?e.$publicFution.priceFormatNone(e.footerData.total_num-0):"total_price"===t.property&&e.footerData.total_price?e.$publicFution.priceFormatNone((e.footerData.total_price-0).toFixed(2)):["total_num","total_price"].includes(t.property)?"计算中...":null}))]}}},l={mixins:[o],name:"shoplowPriceSearch",data:function(){return{policyMonth:[],createdDay:[],examineDay:[],params:this.$publicFution.deepCopy(n)}},methods:{onReset:function(){this.params=this.$publicFution.deepCopy(n),this.policyMonth=[],this.createdDay=[],this.examineDay=[],this.onSearch(1)},examination:function(t){var e=this;if(0!==this.multipleSelection.length){var a,i=this.multipleSelection.map((function(t){return t.price_strategy_id}));"审核"===t?a="auditorPriceStrategy":"弃审"===t?a="unAuditorPriceStrategy":"删除"===t&&(a="delPriceStrategy"),this.$confirm("是否继续?","温馨提示！",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){e.$axios({method:"post",data:{price_strategy_id:i.join(",")},url:e.$api[a]}).then((function(t){var a=t.data;200===a.code&&(e.onSearch(),e.$message.success(a.msg))}))})).catch((function(){}))}else this.$message.warning("请勾选单据！")},exportOrder:function(t){var e=Object.assign(this.params,{export_type:t});this.$axios({method:"get",params:e,url:this.$api.exportPriceStrategy}).then((function(t){200==t.data.code&&(window.location.href=t.data.data.url)}))},getTime:function(t){return Array.isArray(t)?t:[]},onSearch:function(t){this.params.effective_start_time=this.getTime(this.policyMonth)[0]?this.getTime(this.policyMonth)[0]+"-01":"",this.params.effective_end_time=this.getTime(this.policyMonth)[1]?this.getTime(this.policyMonth)[1]+"-01":"",this.params.add_start_time=this.getTime(this.createdDay)[0],this.params.add_end_time=this.getTime(this.createdDay)[1],this.params.auditor_start_time=this.getTime(this.examineDay)[0],this.params.auditor_end_time=this.getTime(this.examineDay)[1],this.$refs.xTable._getData(t)},goDetail:function(t){this.$router.push({path:"/purchase/shoplowPrice/shoplowPriceSee",query:{id:t.price_strategy_id}})},goAdd:function(t){this.$router.push({path:"/purchase/shoplowPrice/shoplowPriceAdd",query:{id:t.price_strategy_id}})}},activated:function(){this.onSearch(window.goPage)}},s=l,c=a("2877"),u=Object(c["a"])(s,i,r,!1,null,null,null);e["default"]=u.exports},"8ba4":function(t,e,a){var i=a("23e7"),r=a("eac5");i({target:"Number",stat:!0},{isInteger:r})},b680:function(t,e,a){"use strict";var i=a("23e7"),r=a("da84"),n=a("e330"),o=a("5926"),l=a("408a"),s=a("1148"),c=a("d039"),u=r.RangeError,d=r.String,m=Math.floor,p=n(s),h=n("".slice),f=n(1..toFixed),_=function(t,e,a){return 0===e?a:e%2===1?_(t,e-1,a*t):_(t*t,e/2,a)},y=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},b=function(t,e,a){var i=-1,r=a;while(++i<6)r+=e*t[i],t[i]=r%1e7,r=m(r/1e7)},g=function(t,e){var a=6,i=0;while(--a>=0)i+=t[a],t[a]=m(i/e),i=i%e*1e7},v=function(t){var e=6,a="";while(--e>=0)if(""!==a||0===e||0!==t[e]){var i=d(t[e]);a=""===a?i:a+p("0",7-i.length)+i}return a},x=c((function(){return"0.000"!==f(8e-5,3)||"1"!==f(.9,0)||"1.25"!==f(1.255,2)||"1000000000000000128"!==f(0xde0b6b3a7640080,0)}))||!c((function(){f({})}));i({target:"Number",proto:!0,forced:x},{toFixed:function(t){var e,a,i,r,n=l(this),s=o(t),c=[0,0,0,0,0,0],m="",f="0";if(s<0||s>20)throw u("Incorrect fraction digits");if(n!=n)return"NaN";if(n<=-1e21||n>=1e21)return d(n);if(n<0&&(m="-",n=-n),n>1e-21)if(e=y(n*_(2,69,1))-69,a=e<0?n*_(2,-e,1):n/_(2,e,1),a*=4503599627370496,e=52-e,e>0){b(c,0,a),i=s;while(i>=7)b(c,1e7,0),i-=7;b(c,_(10,i,1),0),i=e-1;while(i>=23)g(c,1<<23),i-=23;g(c,1<<i),b(c,1,1),g(c,2),f=v(c)}else b(c,0,a),b(c,1<<-e,0),f=v(c)+p("0",s);return s>0?(r=f.length,f=m+(r<=s?"0."+p("0",s-r)+f:h(f,0,r-s)+"."+h(f,r-s))):f=m+f,f}})},eac5:function(t,e,a){var i=a("861d"),r=Math.floor;t.exports=Number.isInteger||function(t){return!i(t)&&isFinite(t)&&r(t)===t}}}]);
//# sourceMappingURL=chunk-0ca287fb.3895ebec.js.map