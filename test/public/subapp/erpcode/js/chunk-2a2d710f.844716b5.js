(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-2a2d710f"],{"3d5d":function(t,e,a){"use strict";a("8cf5")},"4e58":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("common",{attrs:{returnUrl:"/inventory/salesoutstorage",sourceType:2}})},s=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"seePage"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[t._v(t._s(1===t.sourceType?"销售":"库存")+"管理")]),a("el-breadcrumb-item",[t._v("销售出库管理")]),a("el-breadcrumb-item",{staticClass:"attrbute"},[a("span",{on:{click:t.goBack}},[t._v("销售出库")])]),a("el-breadcrumb-item",[t._v("销售出库单详情")])],1),a("div",{attrs:{id:"leixin"}},[a("div",{staticClass:"search_container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params}},[a("el-form-item",{attrs:{label:"销售组织：",size:"mini"}},[a("span",[t._v(t._s(t.params.company_name))])]),a("el-form-item",{attrs:{label:"单据号：",size:"mini"}},[a("span",[t._v(t._s(t.params.outstock_sn))])]),a("el-form-item",{attrs:{label:"业务日期：",size:"mini"}},[a("span",[t._v(t._s(t.params.business_time))])]),a("el-form-item",{attrs:{label:"客户名称：",size:"mini"}},[a("span",[t._v(t._s(t.params.customer_name))])]),a("el-form-item",{attrs:{label:"部门：",size:"mini"}},[a("span",[t._v(t._s(t.params.department_name))])]),a("el-form-item",{attrs:{label:"业务员：",size:"mini"}},[a("span",[t._v(t._s(t.params.business_name))])]),a("el-form-item",{attrs:{label:"收货人：",size:"mini"}},[a("span",[t._v(t._s(t.params.consignee_name))])]),a("el-form-item",{attrs:{label:"电话：",size:"mini"}},[a("span",[t._v(t._s(t.params.consignee_mobile))])]),a("el-form-item",{attrs:{label:"所属区域：",size:"mini"}},[a("span",[t._v(t._s(t.params.province_name)+"  "+t._s(t.params.city_name)+"  "+t._s(t.params.area_name))])]),a("el-form-item",{attrs:{size:"mini",label:"详细地址："}},[a("span",[t._v(t._s(t.params.address))])]),a("el-form-item",{attrs:{size:"mini",label:"关联单据号："}},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.goHref(t.params)}}},[t._v(" "+t._s(t.params.order_sn)+" ")])],1),a("el-form-item",{attrs:{label:"回款方式：",size:"mini"}},[1==t.params.payment_method?a("span",[t._v("客户自结")]):t._e(),2==t.params.payment_method?a("span",[t._v("物流代收")]):t._e(),3==t.params.payment_method?a("span",[t._v("电商结算")]):t._e()]),a("el-form-item",{attrs:{label:"物流公司：",size:"mini"}},[a("span",[t._v(t._s(t.params.settlement_customer_name))])]),a("el-form-item",{attrs:{label:"送货需求：",size:"mini"}},[a("span",[t._v(t._s(t.params.delivery_demand_name))])]),a("el-form-item",{attrs:{label:"交货方式：",size:"mini"}},[t._v(" "+t._s(t.params.hand_over_name)+" ")]),a("el-form-item",{attrs:{label:"出库类型：",size:"mini"}},[a("span",[t._v(t._s(t.params.outstock_type_name))])]),a("el-form-item",{attrs:{label:"仓库名称：",size:"mini"}},[a("span",[t._v(t._s(t.params.warehouse_name))])]),a("el-form-item",{attrs:{label:"打印次数：",size:"mini"}},[a("span",[t._v(t._s(t.params.print_times))])]),a("el-form-item",{attrs:{label:"单据状态",size:"mini"}},[t._v(" "+t._s(t.params.auditor_status_name)+" ")]),a("el-form-item",{attrs:{label:"摘要："}},[t._v(" "+t._s(t.params.abstract)+" ")])],1)],1),a("div",{staticClass:"table_container"},[a("xTable",{ref:"xTable",attrs:{isShowTool:!0,isList:!0,footerMethod:t.footerMethod,tableColumn:t.tableColumn,xData:t.tableData}}),a("el-form",{staticClass:"from_table"},[a("el-form-item",{attrs:{label:"出库金额:",size:"mini"}},[a("span",[t._v(t._s(t._f("priceFormat")(t.params.outstock_price?t.params.outstock_price:0))+"元")])]),a("el-form-item",{attrs:{label:"使用返利:",size:"mini"}},[a("span",[t._v(t._s(t._f("priceFormat")(t.params.rebate_price?t.params.rebate_price:0)))])]),a("el-form-item",{attrs:{label:"使用授信:",size:"mini"}},[a("span",[t._v(t._s(t._f("priceFormat")(t.params.credit_price?t.params.credit_price:0)))])]),a("el-form-item",{attrs:{label:"使用预存款:",size:"mini"}},[a("span",[t._v(t._s(t._f("priceFormat")(t.params.deposits_price?t.params.deposits_price:0)))])]),a("el-form-item",{attrs:{label:"结算金额:",size:"mini"}},[a("span",[t._v(t._s(t._f("priceFormat")(t.params.settlement_price?t.params.settlement_price:0)))])])],1),a("div",[a("span",{staticStyle:{"font-size":"14px"}},[t._v("开票信息：")]),a("el-input",{staticStyle:{width:"50%","vertical-align":"text-top"},attrs:{type:"textarea",disabled:""},model:{value:t.params.invoice_info,callback:function(e){t.$set(t.params,"invoice_info",e)},expression:"params.invoice_info"}})],1),a("div",{staticClass:"refundauditFoot"},[a("span",[t._v("制单人："+t._s(t.params.add_user_name))]),a("span",[t._v("单据时间："+t._s(t.params.add_time))]),a("span",[t._v("审核人："+t._s(t.params.auditor_name))]),a("span",[t._v("审核时间："+t._s(t.params.auditor_time))]),a("span",[t._v("修改人："+t._s(t.params.update_user_name))]),a("span",[t._v("修改时间："+t._s(t.params.update_time))])])],1)]),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center","margin-top":"20px"}},[1==t.authority.b_add?a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:t.addF}},[t._v("新增")]):t._e(),t.params.printStatus?[t.authority.b_printingpick&&2==t.params.auditor_status?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.lodopDe("salesPickingOrders")}}},[t._v("拣货单打印")]):t._e(),1==t.authority.b_printingoutstock&&2==t.params.auditor_status?a("el-button",{on:{click:function(e){return t.lodopDe("outboundOrder")}}},[t._v("出库单打印")]):t._e(),1==t.authority.b_printingpartslist&&2==t.params.auditor_status?a("el-button",{on:{click:function(e){return t.lodopDe("autoPartsList")}}},[t._v("汽配单打印")]):t._e()]:[1==t.authority.b_printingpick?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.lodopDe("salesPickingOrders")}}},[t._v("拣货单打印")]):t._e(),1==t.authority.b_printingoutstock?a("el-button",{on:{click:function(e){return t.lodopDe("outboundOrder")}}},[t._v("出库单打印")]):t._e(),1==t.authority.b_printingpartslist?a("el-button",{on:{click:function(e){return t.lodopDe("autoPartsList")}}},[t._v("汽配单打印")]):t._e()],2==t.params.auditor_status?[1==t.authority.b_nopass?a("el-button",{attrs:{plain:"",size:"mini"},on:{click:function(e){return t.auditOrUnaudit("salesAuditorNoPass")}}},[t._v("弃审")]):t._e()]:t._e(),1==t.params.auditor_status?[1==t.authority.b_pass?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.shenhe("salesOutstockAuidtorPass")}}},[t._v("审核")]):t._e()]:t._e(),3==t.params.auditor_status||1!=t.authority.b_invalid&&1!=t.authority.b_pass?[a("el-button",{on:{click:t.goBack}},[t._v("返回")])]:a("el-button",{on:{click:t.goBack}},[t._v("取消")])],2),t.printingStatusGet?a("div",[a("lodopDelivery",{ref:"lodopDelivery",attrs:{title:t.title}})],1):t._e()],1)},o=[],n=a("5530"),l=(a("e9c4"),a("d3b7"),a("159b"),a("b0c0"),a("2f62")),u=(a("d81d"),a("caad"),{data:function(){var t=this.$createElement;return{tableColumn:[{type:"index",title:"序号",width:50},{title:"业务类型",field:"business_type_name",width:110},{field:"goods_id",title:"商品编号",width:80},{field:"goods_name",title:"商品名称",width:300},{field:"batch",title:"年周/批次",width:200},{field:"production_time",title:"生产日期",width:80,slots:{header:function(){return[t("el-tooltip",{class:"item",attrs:{content:"Bottom center",effect:"light"}},[t("p",{slot:"content"},[" 生产日期列后期将会隐藏， 同时新增商品入库日期列 "])," ",t("span",{class:"el-icon-question",style:"cursor:pointer;font-weight:bold;"},[" 生产日期 "])," "])]}}},{field:"real_num",title:"数量",width:150,headerAlign:"right",align:"right"},{field:"unit_price",title:"售价",width:150,headerAlign:"right",align:"right"},{field:"discount_unit_price",title:"优惠单价",width:150,headerAlign:"right",align:"right"},{field:"preferential_price",title:"优惠金额",width:150,headerAlign:"right",align:"right"},{field:"outstock_price",title:"小计金额",width:150,headerAlign:"right",align:"right"},{title:"门店优惠金额",field:"shop_discount_price",headerAlign:"right",align:"right",width:100},{title:"原价金额",field:"original_price",headerAlign:"right",align:"right",width:100},{field:"revenue_price",showOverflow:!0,headerAlign:"right",align:"right",width:100,title:"税额"},{field:"no_revenue_price",showOverflow:!0,headerAlign:"right",align:"right",width:100,title:"不含税金额"},{field:"warehouse_name",title:"仓库",width:120},{field:"allocation_name",title:"货位",width:120},{field:"unit_name",title:"单位",width:110},{field:"policy_name",title:"促销政策",width:150},{title:"工厂代码",field:"factory_code",width:120},{title:"速记码",field:"shorthand_code",showOverflow:!0,width:120},{field:"remark",title:"备注",width:150}]}},methods:{footerMethod:function(t){var e=this,a=t.columns,i=t.data;return[a.map((function(t,a){if(1===a)return"合计";if(["real_num","preferential_price","outstock_price","no_revenue_price","revenue_price"].includes(t.property)){var s=e.$utils.sum(i,t.property);return"real_num"===t.property?e.$publicFution.priceFormatNone(s,0):e.$publicFution.priceFormatNone(s)}return null}))]}}}),c=u,m=a("78d2"),p=a("65b0"),d={mixins:[c],data:function(){return{authority:{},colorFlag:[],sum:null,title:null,tableData:[],params:{},hasAuditorStatusPrint:null}},props:["returnUrl","sourceType"],computed:Object(n["a"])({},Object(l["c"])(["printingStatusGet"])),methods:Object(n["a"])(Object(n["a"])({},Object(l["b"])(["salesorderSee","printingStatus"])),{},{goHref:function(t){this.$router.push({path:"/sales/salesorder/salesorderSee"}),this.salesorderSee({order_id:t.order_id})},addF:function(){1===this.sourceType?this.$router.push({path:"/sales/salesout/salesoutAdd"}):this.$router.push({path:"/inventory/salesoutstorage/instroageSalesoutAdd"})},goBack:function(){this.returnUrl?this.$router.push(this.returnUrl):this.$router.back(-1)},lodopDe:function(t){var e=this;this.printingStatus(!0),this.$set(this,"title",t),this.$nextTick((function(){e.$refs.lodopDelivery.printPdf({outstock_id:e.params.outstock_id})}))},auditOrUnaudit:function(t){var e=this,a=this;"salesOutstockAuidtorPass"==t?this.$baseData.checkCarDoctor({bill_type:9,bill_id:a.params.outstock_id,operation_type:4}).then((function(){e.$axMethod.safetyStockCheck({bill_logogram:"xsck",order_type:2,bill_id:a.params.outstock_id}).then((function(){Object(p["m"])(e,{goods_info:a.params.outstock_id,status:2,type:1},(function(){a.$axios({method:"post",url:a.$api[t],data:{outstock_id:a.params.outstock_id}}).then((function(t){200==t.data.code&&(a.$message({message:t.data.msg||t.data.data,type:"success"}),a.goBack())}))}))}))})):this.$baseData.checkCarDoctor({bill_type:9,bill_id:this.params.outstock_id,operation_type:5}).then((function(){e.$axios({method:"post",url:e.$api[t],data:{outstock_id:e.params.outstock_id}}).then((function(t){200==t.data.code&&(e.$message({message:t.data.msg||t.data.data,type:"success"}),e.goBack())}))}))},shenhe:function(t){for(var e=this,a=[],i=0;i<this.tableData.length;i++)a.push({order_id:this.params.outstock_id,serial_number:i});var s={company_id:this.params.company_id,bill_id:JSON.stringify(a),operation:2,bill_type:2,is_info:1};this.$axMethod.v2setBillCostControl(s).then((function(a){var i=a.data.data;if(200==a.data.code)if(i.length>0)if(0==i[0].bill_setting_status){var s="";i.forEach((function(t,e){s+=e+1+"."+t.name+"<br>"})),e.$confirm(' <div class="colorblue">'.concat(s,"</div> <br>以上商品售价低于成本价，是否继续提交？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,showClose:!1,type:"warning",distinguishCancelAndClose:!0}).then((function(){e.auditOrUnaudit(t)})).catch((function(t){}))}else e.$message({message:"商品售价低于成本价，审核失败！",type:"warning"}),i.forEach((function(t){e.colorFlag.push(t.serial_number)})),e.colorFlag.forEach((function(t){e.tableData[t].canNotDelete=!0})),e.tableData.push({}),e.tableData.pop();else e.auditOrUnaudit(t)}))}}),components:{lodopDelivery:m["a"]},mounted:function(){var t=this;this.authority=JSON.parse(localStorage.getItem("authority")),this.hasAuditorStatusPrint=window.localStorage.hasAuditorStatusPrint,this.params.outstock_id=this.$route.query&&this.$route.query.id,this.params.outstock_id||this.$route.query.outstock_sn?this.$axios({method:"get",url:this.$api.salesCheckOutstock,params:{outstock_id:this.params.outstock_id,outstock_sn:this.$route.query.outstock_sn}}).then((function(e){200==e.data.code&&(t.params=e.data.data,t.params.printStatus=t.$route.query&&t.$route.query.printStatus,t.tableData=e.data.data.goods_info)})):(this.$message.error("单据信息错误"),this.goBack())}},_=d,h=(a("3d5d"),a("2877")),f=Object(h["a"])(_,r,o,!1,null,"d33c899e",null),b=f.exports,g={name:"inventorySalesoutSee",data:function(){return{}},components:{common:b}},v=g,y=Object(h["a"])(v,i,s,!1,null,null,null);e["default"]=y.exports},"8cf5":function(t,e,a){}}]);
//# sourceMappingURL=chunk-2a2d710f.844716b5.js.map