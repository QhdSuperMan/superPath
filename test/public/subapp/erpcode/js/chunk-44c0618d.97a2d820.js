(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-44c0618d"],{"0898":function(a,e,t){},"7ceb":function(a,e,t){"use strict";t.r(e);var o=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("div",{staticClass:"search_container"},[t("el-form",{ref:"filterFormRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:a.params,rules:a.rules}},[t("el-form-item",{attrs:{label:"库存组织",size:"mini",rules:a.rules.company_id,prop:"company_id"}},[t("el-select",{attrs:{placeholder:"请选择",filterable:"","filter-method":a.companyFilter},on:{change:a.companyChange,focus:a.getCompany},model:{value:a.params.company_id,callback:function(e){a.$set(a.params,"company_id",e)},expression:"params.company_id"}},a._l(a.companyList,(function(e){return t("el-option",{key:e.company_id,attrs:{label:e.company_name,value:e.company_id}},[t("span",{class:1==e.type?"optionStyle":""},[a._v(a._s(e.company_name))])])})),1)],1),t("el-form-item",{attrs:{label:"品牌",size:"mini"}},[t("getBrand",{attrs:{disabled:a.getGoods_type_show},model:{value:a.params.brand_id,callback:function(e){a.$set(a.params,"brand_id",e)},expression:"params.brand_id"}})],1),t("el-form-item",{attrs:{label:"仓库",size:"mini"}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:a.warehouseChangeId,focus:a.getWarehouse},model:{value:a.params.warehouse_id,callback:function(e){a.$set(a.params,"warehouse_id",e)},expression:"params.warehouse_id"}},a._l(a.warehouseList.options,(function(a){return t("el-option",{key:a.warehouse_id,attrs:{label:a.warehouse_name,value:a.warehouse_id}})})),1)],1),t("el-form-item",{attrs:{label:"货位",size:"mini"}},[t("erpAllocation",{attrs:{disabled:!a.params.warehouse_id,searchParams:{company_id:a.params.company_id,warehouse_id:a.params.warehouse_id,is_incomplete:3}},model:{value:a.params.allocation_id,callback:function(e){a.$set(a.params,"allocation_id",e)},expression:"params.allocation_id"}})],1),t("el-form-item",{attrs:{label:"工厂代码",size:"mini"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:a.params.factory_code,callback:function(e){a.$set(a.params,"factory_code",e)},expression:"params.factory_code"}})],1),t("el-form-item",{attrs:{label:"商品名称",size:"mini"}},[t("v-GoodsList",{attrs:{scopes:{row:a.params},isFuzzy:!0,vxeParams:{company_id:a.params.company_id},showObj:{goods_id:"商品编号",goods_name:"商品名称"}}})],1),t("el-form-item",{attrs:{label:"年周/批次",size:"mini"}},[t("el-input",{model:{value:a.params.batch,callback:function(e){a.$set(a.params,"batch",e)},expression:"params.batch"}})],1),t("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return a.onSearch("filterFormRef")}}},[a._v("查询")]),t("el-button",{attrs:{plain:"",size:"mini"},on:{click:a.onReset}},[a._v("重置")])],1)],1)],1),1==a.authority.b_export&&a.listShow?t("div",{staticClass:"add_delet"},[t("el-dropdown",{attrs:{placement:"bottom-start"}},[t("span",{staticStyle:{cursor:"pointer",color:"#4e90e2"},attrs:{"split-button":""}},[t("el-button",{attrs:{plain:"",icon:"iconfont icon-daochu10",size:"mini"}},[a._v("导出")])],1),t("el-dropdown-menu",{staticStyle:{"margin-top":"10px"},attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(e){return a.exportOrder(1)}}},[a._v("导出Excel文件")]),t("el-dropdown-item",{nativeOn:{click:function(e){return a.exportOrder(2)}}},[a._v("导出CSV逗号分隔")])],1)],1)],1):a._e(),a.listShow?t("div",{staticClass:"table_container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading1,expression:"loading1"}],staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:a.TableData.tableData,"max-height":a.tableHeight,"summary-method":a.getSummaries,"show-summary":""}},[t("el-table-column",{attrs:{label:"序号",type:"index",width:"46",align:"center"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"company_name",label:"库存组织"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"warehouse_name",label:"仓库名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"allocation_name",label:"货位"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"brand_name",label:"品牌"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_id",label:"商品编号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_name",label:"商品名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"factory_code",label:"工厂代码"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"batch",label:"年周/批次"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,"render-header":a.renderHeaderpro,property:"production_time",width:"80",label:"生产日期"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"stocks",width:"138px",label:"在库库存",align:"left"}})],1),t("div",{staticClass:"table_info"},[t("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[t("el-col",{attrs:{span:8}},[t("div",[a._v("在库库存总计："+a._s(a.TableData.allList.total_stocks))])])],1),t("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[t("el-col",{attrs:{span:12}},[t("div",[a._v("生成时间："+a._s(a.TableData.allList.add_time))])]),t("el-col",{attrs:{span:12}},[t("div",{staticClass:"textAr"},[a._v("制表人："+a._s(a.TableData.allList.user_name))])])],1)],1),t("div",{staticClass:"page_container"},[t("div",{staticClass:"pageNumber"},[a._v("每页显示")]),t("el-pagination",{staticClass:"erp-pagination",attrs:{"current-page":a.goPage,"page-size":a.pageSize1,"page-sizes":a.per_page,layout:"total,sizes, prev, pager, next,jumper",prevText:"上一页",nextText:"下一页",total:a.TableData.total},on:{"size-change":a.handleSizeChange,"update:currentPage":function(e){a.goPage=e},"update:current-page":function(e){a.goPage=e},"current-change":a.handleCurrentChange}})],1)],1):a._e()])},s=[],r=(t("a9e3"),t("d3b7"),t("159b"),t("d81d"),t("65b0")),i={name:"batchsummary",data:function(){return{authority:{},params:{},searchParams:{},listShow:!1,timeValue:[],exportType:null,warehouseList:{options:[]},TableData:{allList:{},tableData:[]},departmentList:{options:[]},companyList:[],optionsW:null,getwarehouseOption:!0,loading:!0,goPage:1,pageSize:30,per_page:[30,50,100,500],loadingBrand:!1,tableHeight:400}},methods:{companyChange:function(a){this.$set(this.params,"warehouse_id"," "),this.$set(this.params,"goods_name"," ")},renderHeaderpro:function(){var a=this.$createElement;return a("el-tooltip",{class:"item",attrs:{content:"Bottom center",effect:"light"}},[a("p",{slot:"content"},["生产日期列后期将会隐藏，同时新增商品入库日期列"]),a("span",{class:"el-icon-question",style:"cursor:pointer;font-weight:bold;"},["生产日期"])])},change:function(a){this.params.start_time=a[0],this.params.end_time=a[1]},onReset:function(){this.$set(this,"params",{company_id:Number(localStorage.company_id)}),this.timeValue=[],this.getwarehouseOption=!0,this.$set(this,"searchParams",{params:{},TableData:this.TableData,API:"getBatchSummaryList",vm:this}),Object.assign(this.searchParams.params,this.params,{page:1}),Object(r["g"])(this.searchParams,2,r["o"].bind(this))},exportOrder:function(a){if(0==this.listShow)return this.$message({message:"请查询需要导出的数据",type:"error"}),!1;Object.assign(this.params,{export_type:a});this.$axMethod.exportBatchSummaryUrl(this.params).then((function(a){200==a.data.code&&(window.location.href=a.data.data.url)}))},getSummaries:function(a){var e=a.columns,t=a.data,o=[];return e.forEach((function(a,e){if(0!==e)if(1!==e){var s=t.map((function(e){return Number(e[a.property])}));s.every((function(a){return isNaN(a)}))?o[e]="":(o[e]=s.reduce((function(a,e){var t=Number(e);return isNaN(t)?a:a+e}),0),o[e]=10===e?o[e]:"")}else o[e]=" ";else o[e]="合计"})),o},warehouseChangeId:function(a){var e=this;this.getwarehouseOption=!1,this.$axMethod.allocationInventoryList({warehouse_id:a}).then((function(a){200==a.data.code&&(e.optionsW=a.data.data,e.$set(e.params,"allocation_id"," "))}))},onSearch:function(){var a=this;this.$refs.filterFormRef.validate((function(e){e&&(a.listShow=!0,a.$set(a,"searchParams",{params:{},TableData:a.TableData,API:"getBatchSummaryList",vm:a}),Object.assign(a.searchParams.params,a.params,{page:1}),Object(r["g"])(a.searchParams,2,r["o"].bind(a)))}))},handleSizeChange:function(a){Object.assign(this.searchParams.params,{per_page:a,page:1}),Object(r["g"])(this.searchParams)},handleCurrentChange:function(a){Object.assign(this.searchParams.params,{page:a}),Object(r["g"])(this.searchParams)},companyFilter:function(a){var e={type:1,company_name:a};Object(r["k"])(this,e)},getCompany:function(){var a={type:1,company_name:null};Object(r["k"])(this,a)},getWarehouse:function(){this.$common.options("getWarehouseListOption",this.warehouseList,{company_id:this.params.company_id})}},mounted:function(){this.authority=JSON.parse(localStorage.getItem("authority")),this.$set(this,"params",{company_id:Number(localStorage.company_id)}),this.companyList=[{company_id:Number(localStorage.company_id),company_name:localStorage.company_name}],r["o"].bind(this)(),window.onresize=r["o"].bind(this)}},n=i,l=(t("dbea"),t("2877")),c=Object(l["a"])(n,o,s,!1,null,"2044dc1a",null);e["default"]=c.exports},dbea:function(a,e,t){"use strict";t("0898")}}]);
//# sourceMappingURL=chunk-44c0618d.97a2d820.js.map