(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-2d0cf13f"],{"61d2":function(a,e,t){"use strict";t.r(e);var i=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[a._v(a._s("stock"==a.from?"库存":"售后")+"管理")]),t("el-breadcrumb-item",{staticClass:"attrbute"},[t("span",{on:{click:a.goBack}},[a._v(a._s("stock"==a.from?"商品出库":"返胎出库"))])]),t("el-breadcrumb-item",[a._v(a._s(this.auditreeoutAdd_Get.reborn_outstock_id?"修改":"新增")+"出库")])],1),t("div",{staticClass:"search_container"},[t("el-form",{ref:"TableDataRef",attrs:{inline:!0,model:a.params}},[t("el-form-item",{attrs:{label:"库存组织",rules:a.rules.company_id,prop:"company_id",size:"mini"}},[t("el-select",{attrs:{placeholder:"请选择",disabled:!!this.auditreeoutAdd_Get.reborn_outstock_id,filterable:""},on:{focus:a.companyListInvok,change:a.companyChange},model:{value:a.params.company_id,callback:function(e){a.$set(a.params,"company_id",e)},expression:"params.company_id"}},a._l(a.companyList,(function(e){return t("el-option",{key:e.company_id,attrs:{label:e.company_name,value:e.company_id}},[t("span",{class:1==e.type?"optionStyle":""},[a._v(a._s(e.company_name))])])})),1)],1),t("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini",prop:"supplier_id",rules:a.rules.supplier_id}},[t("el-select",{attrs:{clearable:"",maxlength:"100",disabled:!!this.auditreeoutAdd_Get.reborn_outstock_id,"filter-method":a.supplierChange,filterable:"",placeholder:"请选择"},on:{focus:a.supplierListInvok,change:a.changeSuppliter},model:{value:a.params.supplier_id,callback:function(e){a.$set(a.params,"supplier_id",e)},expression:"params.supplier_id"}},a._l(a.supplierList,(function(a){return t("el-option",{key:a.supplier_id,attrs:{label:a.supplier_name,value:a.supplier_id}})})),1)],1),t("el-form-item",{attrs:{label:"业务日期",size:"mini",prop:"business_time",rules:a.rules.business_time}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd"},model:{value:a.params.business_time,callback:function(e){a.$set(a.params,"business_time",e)},expression:"params.business_time"}})],1),t("el-form-item",{staticClass:"wauto",attrs:{label:"所属区域",size:"mini",prop:"cityList",rules:a.rules.areaadress}},[a.defaultArea&&a.defaultArea.length?t("getAreaList",{attrs:{defaultArea:a.defaultArea},on:{changeDefaultArea:a.changeDefaultArea}}):a._e()],1),t("el-form-item",{attrs:{label:"详细地址",size:"mini",prop:"address",rules:a.rules.address}},[t("el-input",{model:{value:a.params.address,callback:function(e){a.$set(a.params,"address",e)},expression:"params.address"}})],1),t("el-form-item",{attrs:{label:"收货人",size:"mini",prop:"consignee_name",rules:a.rules.consignee_name}},[t("el-input",{attrs:{maxLength:"7"},model:{value:a.params.consignee_name,callback:function(e){a.$set(a.params,"consignee_name",e)},expression:"params.consignee_name"}})],1),t("el-form-item",{attrs:{label:"手机号码",size:"mini",prop:"consignee_mobile",rules:a.rules.phone}},[t("el-input",{model:{value:a.params.consignee_mobile,callback:function(e){a.$set(a.params,"consignee_mobile",e)},expression:"params.consignee_mobile"}})],1),t("el-form-item",{attrs:{label:"库存部门",size:"mini"}},[a._v(" "+a._s(function(){0==a.params.department_id&&(a.params.department_id=null)}())+" "),t("el-select",{attrs:{clearable:"",disabled:!!this.auditreeoutAdd_Get.reborn_outstock_id,placeholder:"请选择",filterable:""},on:{focus:a.DepartmentListInvok},model:{value:a.params.department_id,callback:function(e){a.$set(a.params,"department_id",e)},expression:"params.department_id"}},a._l(a.departmentList,(function(a){return t("el-option",{key:a.department_id,attrs:{label:a.department_name,value:a.department_id}})})),1)],1),t("el-form-item",{attrs:{label:"出库类型",size:"mini"}},[[t("span",[a._v("返胎出库")])]],2),t("el-form-item",{attrs:{label:"摘要",size:"mini"}},[t("el-input",{attrs:{type:"text",maxlength:"300"},model:{value:a.params.remark,callback:function(e){a.$set(a.params,"remark",e)},expression:"params.remark"}})],1)],1)],1),t("div",{staticClass:"add_delet"},[t("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:a.quoteOrder}},[a._v("引用单据")]),t("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:a.deletes}},[a._v("删行")])],1),t("div",{staticClass:"table_container"},[t("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:a.TableData,"max-height":"600"},on:{"selection-change":a.handleSelectionChange}},[t("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"selection",fixed:"left",align:"center",width:"44"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"brand_name",width:"150",label:"品牌名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_id",width:"150",label:"商品编号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_name","min-width":"500",label:"商品名称"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("pre",[a._v(a._s(e.row.goods_name))])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"batch","min-width":"100",label:"年周/批次"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"160",label:"出库仓库"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-select",{attrs:{filterable:"",placeholder:"请输入",clearable:"","value-key":"allocation_id"},on:{focus:function(t){return a.getWarehouseInfo(e.row,e.$index)},change:function(t){return a.warehouseChange(e.row,e.$index)}},model:{value:e.row.warehouseObj,callback:function(t){a.$set(e.row,"warehouseObj",t)},expression:"scope.row.warehouseObj"}},[t("ul",{staticClass:"customer customer-ul4 customer-ul2"},[t("li",[a._v("仓库")]),t("li",[a._v("货位")]),t("li",{staticStyle:{"text-align":"right"}},[a._v("可用数量")]),t("li",{staticStyle:{"text-align":"right"}},[a._v("在库数量")])]),a._l(e.row.wareHouselist,(function(e){return t("el-option",{key:e.allocation_id,attrs:{label:e.warehouse_name,value:e}},[t("ul",{staticClass:"customer customer-ul4"},[t("li",{attrs:{title:e.warehouse_name}},[a._v(a._s(e.warehouse_name))]),t("li",{attrs:{title:e.allocation_name}},[a._v(a._s(e.allocation_name))]),t("li",{staticStyle:{"text-align":"right"},attrs:{title:e.available_stocks}},[a._v(a._s(e.available_stocks))]),t("li",{staticStyle:{"text-align":"right"},attrs:{title:e.stocks}},[a._v(a._s(e.stocks))])])])}))],2)]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"allocation_name",width:"120",label:"出库货位"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_num",width:"160",label:"返胎数量",align:"right"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(" "+a._s(e.row.goods_num=1)+" ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"tire_un",label:"胎号",width:"180"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:" ",label:" "}})],1)],1),a.salesDocumentsV?t("appraisalDalog",{attrs:{message:a.params.supplier_id,mesCompanyID:a.params.company_id},on:{getAlloca:a.getAllocationList}}):a._e(),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:a.goBack}},[a._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(e){return a.submit("TableDataRef")}}},[a._v("确 定")])],1)],1)},s=[],o=t("b85c"),r=t("2909"),l=t("5530"),n=(t("d81d"),t("d3b7"),t("159b"),t("caad"),t("2532"),t("e9c4"),t("6062"),t("3ca3"),t("ddb0"),t("4de4"),t("a630"),t("a15b"),t("a9e3"),t("2f62")),d=t("65b0"),c=t("d12c"),u=t("2f65"),p={name:"aftersaleAuditreeoutAdd",data:function(){return{authority:{},allocationInventoryList:{},list:[],TableData:[],salesDocumentsV:!1,multipleSelection:[],params:{cityList:[]},defaultArea:[0],from:""}},components:{getAreaList:c["a"],appraisalDalog:u["a"]},methods:Object(l["a"])(Object(l["a"])({},Object(n["b"])(["treeoutreeIndexACT"])),{},{goBack:function(){this.$router.push({path:"/aftersale/treeoutree"})},dongList:function(a){var e=this;if(a.length)if("1"==this.params.outstock_type){var t=this.TableData.map((function(a){return a.company_appraisal_goods_id}));a.forEach((function(a){t.includes(a.company_appraisal_goods_id)?e.$message({message:"此数据已引用",type:"error"}):e.TableData.push(a)}))}else{var i=this.TableData.map((function(a){return a.company_appraisal_goods_id}));a.forEach((function(a){i.includes(a.company_appraisal_goods_id)?e.$message({message:"此数据已引用",type:"error"}):e.TableData.push(a)}))}},getAllocationList:function(a){var e=this;this.$axios({method:"get",url:this.$api.newAllocationList,params:{company_id:this.params.company_id,warehouse_id:this.TableData[a].warehouse_id,goods_id:this.TableData[a].goods_id}}).then((function(t){200==t.data.code&&e.$set(e.TableData[a],"allocationInventoryList",t.data.data)}))},supplierChange:function(a){this.supplierListInvok(a)},submit:function(a){var e=this,t=[];if(!this.params.supplier_id)return this.$message({message:"请选择供应商",type:"error"}),!1;this.params.abstract||(this.params.abstract=""),this.TableData.forEach((function(a){t.push({factory_appraisal_goods_id:a.factory_appraisal_goods_id,goods_id:a.goods_id,warehouse_id:a.warehouse_id,warehouse_name:a.warehouse_name,goods_num:a.goods_num,allocation_id:a.allocation_id,tire_un:a.tire_un})})),this.$refs[a].validate((function(a){if(a){var i=Object(l["a"])(Object(l["a"])({},e.params),{},{goods_json:JSON.stringify(t)}),s=e.auditreeoutAdd_Get.reborn_outstock_id?"editRebornOutstock":"addRebornOutstock";e.$baseData.checkCarDoctor({company_id:e.params.company_id,company_name:e.params.company_name,bill_type:16,bill_id:e.auditreeoutAdd_Get.reborn_outstock_id,operation_type:e.auditreeoutAdd_Get.reborn_outstock_id?2:1,goods_info:JSON.stringify(t)}).then((function(){e.$axMethod[s](i).then((function(a){200==a.data.code&&(e.$message({message:a.data.data,type:"success"}),e.goBack())}))}))}}))},warehouseChange:function(a,e){var t=this;if(Array.isArray(a.wareHouselist))["warehouse_id","warehouse_name","allocation_name","allocation_id"].forEach((function(i){t.$set(t.TableData[e],i,a.warehouseObj[i])}))},deletes:function(){if(this.multipleSelection.length){var a=new Set(this.TableData),e=new Set(this.multipleSelection),t=new Set(Object(r["a"])(a).filter((function(a){return!e.has(a)})));this.TableData=Array.from(t)}else this.$message({message:"请先选择要删除的数据！",type:"warning"})},quoteOrder:function(){this.params.supplier_id?this.salesDocumentsV=!0:this.$message({message:"请选择供应商(厂家)",type:"warning"})},getWarehouseInfo:function(a,e){var t=this;this.$axMethod.getBatchInfo({company_id:this.params.company_id,goods_id:a.goods_id}).then((function(a){"200"==a.data.code&&t.$set(t.TableData[e],"wareHouselist",a.data.data)}))},companyChange:function(a){this.$set(this.params,"department_id",null),this.$set(this.params,"supplier_id",null),this.$set(this,"TableData",[])},changeDefaultArea:function(a){this.params.cityList=a.join(","),this.params.province_id=a[0],this.params.city_id=a[1],this.params.area_id=a[2]},changeSuppliter:function(a){var e=this;if(!a)return this.params.address="",void(this.defaultArea=[0]);if(this.$set(this,"TableData",[]),a)var t=this.supplierList.filter((function(e){return e.supplier_id===a}))[0].associated_supplier_id;this.$axMethod.getSupplierInfo({company_id:this.params.company_id,supplier_id:a,associated_supplier_id:t}).then((function(a){200==a.data.code&&(a.data.data.province_id?(e.defaultArea=[a.data.data.province_id,a.data.data.city_id,a.data.data.area_id],e.params.cityList=e.defaultArea.join(","),e.params.province_id=e.defaultArea[0],e.params.city_id=e.defaultArea[1],e.params.area_id=e.defaultArea[2]):(e.params.cityList="",e.params.province_id=0,e.params.city_id=0,e.params.area_id=0,e.defaultArea=[0]));var t={consignee_name:a.data.data.principal_name,consignee_mobile:a.data.data.principal_mobile,address:a.data.data.address},i=Object.assign({},e.params,t);e.$set(e,"params",i)}))}}),computed:Object(l["a"])({},Object(n["c"])(["auditreeoutAdd_Get","auditreeoutIndex_Get"])),mounted:function(){var a=this;this.auditreeoutAdd_Get.reborn_outstock_id&&this.$axMethod.getRebornOutstockInfo({reborn_outstock_id:this.auditreeoutAdd_Get.reborn_outstock_id}).then((function(e){if(200==e.data.code){var t,i=Object(o["a"])(e.data.data.goods_list);try{for(i.s();!(t=i.n()).done;){var s=t.value;s.wareHouselist=[{warehouse_id:s.warehouse_id,warehouse_name:s.warehouse_name,allocation_id:s.allocation_id,allocation_name:s.allocation_name}],s.warehouseObj={warehouse_id:s.warehouse_id,warehouse_name:s.warehouse_name,allocation_id:s.allocation_id,allocation_name:s.allocation_name}}}catch(r){i.e(r)}finally{i.f()}a.params=e.data.data.info,a.TableData=e.data.data.goods_list,a.defaultArea=[e.data.data.info.province_id,e.data.data.info.city_id,e.data.data.info.area_id],Object(d["l"])(a,e.data.data.info),a.params.cityList=a.defaultArea.join(","),a.params.province_id=a.defaultArea[0],a.params.city_id=a.defaultArea[1],a.params.area_id=a.defaultArea[2]}}));var e=localStorage,t=e.employee_id,i=e.company_admin_id;[0,1,2].includes(Number(t))||i>0?this.$set(this,"params",{business_time:this.$publicFution.formatData(new Date),company_id:Number(localStorage.company_id),company_name:localStorage.company_name}):this.$set(this,"params",{business_time:this.$publicFution.formatData(new Date),company_id:Number(localStorage.company_id),department_id:Number(localStorage.department_id),company_name:localStorage.company_name}),Object(d["l"])(this,localStorage)}},m=p,_=t("2877"),h=Object(_["a"])(m,i,s,!1,null,"59a6ac9f",null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d0cf13f.a63a0082.js.map