(window["webpackJsonp_service"]=window["webpackJsonp_service"]||[]).push([["chunk-91dc7fae"],{2082:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.submitLoading,expression:"submitLoading"}],staticClass:"search_container"},[a("el-form",{ref:"filterFormRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"财务组织",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{focus:e.companyListFun,change:e.companyChange},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"支付单据生成时间",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.PaymentTimeChangeDate},model:{value:e.PaymentTime,callback:function(t){e.PaymentTime=t},expression:"PaymentTime"}})],1),a("el-form-item",{attrs:{label:"付款凭证提交时间",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.PaymentTimeChangeDate},model:{value:e.ProofTime,callback:function(t){e.ProofTime=t},expression:"ProofTime"}})],1),a("el-form-item",{attrs:{label:"客户名称",size:"mini"}},[a("el-select",{attrs:{filterable:"",placeholder:"请输入",clearable:"",loading:e.loading,remote:"","remote-method":e.clienteleListInvok},on:{focus:e.clienteleListInvok,change:e.getCustomerChange},model:{value:e.params.customer_id,callback:function(t){e.$set(e.params,"customer_id",t)},expression:"params.customer_id"}},[a("ul",{staticClass:"customer customer-ul4 customer-ul2"},[a("li",[e._v("客户编号")]),a("li",[e._v("客户名称")]),a("li",[e._v("联系人")]),a("li",[e._v("联系电话")]),a("li",[e._v("区域")])]),e._l(e.customerList,(function(t){return a("el-option",{key:t.customer_id,attrs:{label:t.customer_name,value:t.customer_id}},[a("ul",{staticClass:"customer customer-ul4"},[a("li",{attrs:{title:t.customer_id}},[e._v(e._s(t.customer_id))]),a("li",{attrs:{title:t.customer_name}},[e._v(e._s(t.customer_name))]),a("li",{attrs:{title:t.contact_name}},[e._v(e._s(t.contact_name))]),a("li",{attrs:{title:t.customer_mobile}},[e._v(e._s(t.customer_mobile))]),a("li",[e._v(e._s(t.province_name)+"/"+e._s(t.city_name)+"/"+e._s(t.area_name))])])])}))],2)],1),a("el-form-item",{attrs:{label:"商城订单号",size:"mini"}},[a("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch(1)}},model:{value:e.params.order_sn,callback:function(t){e.$set(e.params,"order_sn",t)},expression:"params.order_sn"}})],1),a("el-form-item",{attrs:{label:"支付单据号",size:"mini"}},[a("el-input",{attrs:{placeholder:"请输入"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch(1)}},model:{value:e.params.pay_sn,callback:function(t){e.$set(e.params,"pay_sn",t)},expression:"params.pay_sn"}})],1),a("el-form-item",{attrs:{label:"订单来源",size:"mini"}},[a("el-select",{attrs:{clearable:""},model:{value:e.params.order_from,callback:function(t){e.$set(e.params,"order_from",t)},expression:"params.order_from"}},[a("el-option",{attrs:{label:"大宗",value:1}},[e._v("大宗")]),a("el-option",{attrs:{label:"服务站",value:5}},[e._v("服务站")]),a("el-option",{attrs:{label:"车郎中",value:6}},[e._v("车郎中")])],1)],1),a("el-form-item",{attrs:{label:"收款状态",size:"mini"}},[a("el-select",{attrs:{clearable:""},model:{value:e.params.pay_state,callback:function(t){e.$set(e.params,"pay_state",t)},expression:"params.pay_state"}},[a("el-option",{attrs:{label:"待付款",value:0}},[e._v("待付款")]),a("el-option",{attrs:{label:"待确认",value:1}},[e._v("待确认")]),a("el-option",{attrs:{label:"拒审",value:2}},[e._v("拒审")]),a("el-option",{attrs:{label:"已确认",value:3}},[e._v("已确认")])],1)],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.onSearch()}}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"add_delet"},[a("el-checkbox",{on:{change:e.CommissionAmount},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("公户待销金额>0")]),e.tableColumn.length>0?a("xTable",{ref:"xTable",attrs:{ajax:{url:"getServiceCollectionList",params:e.params},footerMethod:e.footerMethod,tableColumn:e.tableColumn},on:{getData:e.dealData}}):e._e()],1),a("vxe-modal",{ref:"model",attrs:{"show-footer":"","mask-closable":""},scopedSlots:e._u([{key:"footer",fn:function(){return[a("div",{staticStyle:{"text-align":"center"}},[a("vxe-button",{attrs:{type:"submit",status:"primary"},on:{click:function(t){e.modeStact=!1}}},[e._v("关闭")])],1)]},proxy:!0}]),model:{value:e.modeStact,callback:function(t){e.modeStact=t},expression:"modeStact"}},[a("p",[e._v("应付总金额："+e._s(e.AmountTotal))]),e.modeStact?a("xTable",{ref:"xTablemodel",attrs:{isPage:!1,ajax:{url:"service_getOrderDetailed",params:{pay_sn:e.Securitypay_sn},result:"data.data.order_list"},tableColumn:e.modeltableColumn},on:{getData:e.modeStactDate}}):e._e()],1)],1)},n=[],r=(a("d81d"),a("a9e3"),a("99af"),{data:function(){var e=this;this.$createElement;return{status:!0,tableColumn:[{title:"支付单据号",field:"pay_sn",width:130},{title:"操作",width:150,fixed:"right",align:"center",slots:{default:function(t,a){var i=[],n=t.row.operator_button;return 1!=n.confirm_show&&2!=n.confirm_show||i.push(a("el-button",{attrs:{size:"small",type:"text",disabled:2==n.confirm_show},on:{click:function(){return e.ConfirmGoods(t.row)}}},[" 确认收款 "])),1!=n.refuse_show&&2!=n.refuse_show||i.push(a("el-button",{attrs:{size:"small",type:"text",disabled:2==n.refuse_show},on:{click:function(){return e.RefusalJustice(t.row)}}},[" 拒审  "])),[i]}}},{field:"order_from_name",width:156,title:"订单来源"},{field:"pay_state_name",width:150,title:"收款状态"},{field:"customer_name",width:150,title:"客户名称"},{field:"store_name",width:150,title:"订单所属店铺"},{title:"商城订单明细",field:"department_name",width:100,align:"center",slots:{default:function(t,a){var i=[];return i.push(a("el-link",{attrs:{type:"primary"},on:{click:function(){e.seeDepartOrder(t.row)}}},["查看"])),i}}},{field:"pay_account",width:150,title:"付款账户名"},{title:"收款开户行",field:"account_bank",width:100},{title:"收款开户名",field:"account_name",width:150},{title:"收款账号",field:"account_number",width:84},{title:"应付总金额",field:"pay_price",width:100},{title:"公户待销金额",field:"account_balance",width:150},{title:"付款凭证",field:"pay_pic_url",width:150,slots:{default:function(t,a){return t.row.pay_pic_url.map((function(t){return a("el-image",{attrs:{src:t,"preview-src-list":[t]},class:"imgs",on:{click:function(t){e.handleClickItem(t)}}})}))}}},{title:"实收金额",field:"collection_price",width:110,slots:{default:function(t,a){return 2==t.row.order_pay_type&&1==t.row.pay_state?[a("el-input",{on:{input:function(){return e.linmikNumber(t.row)}},attrs:{placeholder:"请输入"},model:{value:t.row.collection_price,callback:function(a){e.$set(t.row,"collection_price",a)}}})]:[a("span",[t.row.collection_price])]}}},{title:"充值金额",field:"recharge_price",width:160},{title:"到账类型",field:"arrival_type_name",width:120},{title:"操作人",field:"operator_user_name",width:120},{title:"操作时间",field:"operator_time",width:120}],modeltableColumn:[{title:"商城订单号",field:"order_sn"},{title:"商品（SKU）数",field:"goods_num"},{title:"金额（元）",field:"order_amount"}]}},methods:{seeDepartOrder:function(e){var t=this;this.Securitypay_sn=e.pay_sn,this.$nextTick((function(){t.modeStact=!0}))},linmikNumber:function(e){Number(e.collection_price)>Number(e.pay_price)?this.$set(e,"recharge_price",Number(e.collection_price)-Number(e.pay_price)):this.$set(e,"recharge_price",0)},confirmDilog:function(e,t,a){var i=this;this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a&&i.$api.service_auditorPass({collection_price:t.collection_price,pay_sn:t.pay_sn}).then((function(e){var t=e.data;200==t.code&&(i.onSearch(),i.$confirm.close())}))}))},ConfirmGoods:function(e){var t;2==e.order_pay_type&&Number(e.collection_price)<=0?this.$message.error("实收金额不能为空"):1==e.order_pay_type?Number(e.account_balance)>=Number(e.pay_price)?(t="客户账户待销金额:".concat(e.account_balance,"，本次收款金额:").concat(e.pay_price,"，是否确认收款？"),this.confirmDilog(t,e,!0)):(t="当前单据应付总金额>公户待销金额，不支持确认收款",this.confirmDilog(t,e,!1)):e.recharge_price>=0?(t="当前单据实收金额:".concat(e.collection_price,"，支付单据金额 ").concat(e.pay_price,"，将有").concat(e.recharge_price,"元充值进入客户余额"),this.confirmDilog(t,e,!0)):(t="当前单据余额充值金额<0，不支持确认收款",this.confirmDilog(t,e,!1))},RefusalJustice:function(e){var t=this;this.$prompt("请输入拒审原因","拒审",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"拒审原因不能为空"}).then((function(a){var i=a.value;t.$api.service_auditorRefuse({pay_sn:e.pay_sn,auditor_reason:i}).then((function(e){var a=e.data;200==a.code&&(t.$message.success(a.msg),t.$refs.xTable._getData())}))}))},handleClickItem:function(e){e.stopPropagation(),this.$nextTick((function(){var e=document.querySelector(".el-image-viewer__mask");console.log(e),e&&e.addEventListener("click",(function(){document.querySelector(".el-image-viewer__close").click()}))}))}}}),o={mixins:[r],data:function(){return{params:{},modeStact:!1,Securitypay_sn:null,timeValue:[],PaymentTime:[],AmountTotal:0,ProofTime:[],checked:!1}},methods:{onSearch:function(){this.params=this.$publicFution.dealParams(this.params),this.$refs.xTable._getData(1)},CommissionAmount:function(e){this.params.is_common_balance=e?1:0,this.$refs.xTable._getData(1)},onReset:function(){this.params={},this.PaymentTime=this.ProofTime=[],this.$refs.xTable._getData(1)},modeStactDate:function(e){this.AmountTotal=e.data.data.pay_price},PaymentTimeChangeDate:function(){this.PaymentTime?(this.params.start_add_time=this.PaymentTime[0],this.params.end_add_time=this.PaymentTime[1]):this.params.start_add_time=this.params.end_add_time="",this.ProofTime?(this.params.start_payment_time=this.ProofTime[0],this.params.end_payment_time=this.ProofTime[1]):this.params.start_payment_time=this.params.end_payment_time=""},companyListFun:function(){var e=this;this.$api.getVisibleCompany().then((function(t){var a=t.data;200==a.code&&e.$axMethod.getCompanyListDefalut({company_id:a.data}).then((function(t){e.companyList=t.data.data.company_list}))}))}}},l=o,s=(a("5ca3"),a("2877")),c=Object(s["a"])(l,i,n,!1,null,"d7f051d4",null);t["default"]=c.exports},"5ca3":function(e,t,a){"use strict";a("9d9f")},"9d9f":function(e,t,a){}}]);
//# sourceMappingURL=chunk-91dc7fae.d0d99669.js.map