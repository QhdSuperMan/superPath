(window["webpackJsonp_service"]=window["webpackJsonp_service"]||[]).push([["chunk-7fc9821d"],{3684:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"stock_alarm_search"},[a("div",{staticClass:"search_container"},[a("el-form",{ref:"formSearch",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"库存组织",size:"mini",prop:"company_id"}},[a("erpCompanyList",{ref:"erpCompanyList",attrs:{fatherParams:e.params},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}})],1),a("el-form-item",{attrs:{label:"仓库",size:"mini",prop:"warehouse_id"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{focus:e.warehouseInvok},model:{value:e.params.warehouse_id,callback:function(t){e.$set(e.params,"warehouse_id",t)},expression:"params.warehouse_id"}},e._l(e.allWarehouseList,(function(e){return a("el-option",{key:e.warehouse_id,attrs:{label:e.warehouse_name,value:e.warehouse_id}})})),1)],1),a("el-form-item",{attrs:{label:"预警类型",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.params.early_warning_type,callback:function(t){e.$set(e.params,"early_warning_type",t)},expression:"params.early_warning_type"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"上限预警",value:"ceiling"}}),a("el-option",{attrs:{label:"安全库存预警",value:"lower"}})],1)],1),a("el-form-item",{attrs:{label:"商品编号",size:"mini"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入"},model:{value:e.params.goods_sn,callback:function(t){e.$set(e.params,"goods_sn",t)},expression:"params.goods_sn"}})],1),a("el-form-item",{attrs:{label:"商品名称",size:"mini"}},[a("v-GoodsList",{attrs:{scopes:{row:e.params},beforeGetList:e.beforeGetList,updateArray:["goods_id"],vxeParams:{company_id:e.params.company_id},showObj:{goods_id:"商品编号",goods_name:"商品名称"}}})],1),a("el-form-item",{attrs:{label:"品牌",size:"mini"}},[a("getBrand",{model:{value:e.params.brand_id,callback:function(t){e.$set(e.params,"brand_id",t)},expression:"params.brand_id"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"add_delet"},[e.authority?a("el-button",{staticClass:"addBtn",attrs:{size:"mini"},on:{click:e.turnToPurchasing}},[e._v("转采购")]):e._e()],1),a("div",{staticClass:"table_container"},[a("vxe-grid",{ref:"xTable",attrs:{border:"","show-header-overflow":!0,"show-overflow":"tooltip","show-footer":"true","footer-method":e.footerMethod,"tooltip-config":{theme:"light"},data:e.TableData.tableData,columns:e.tableColumn,size:"mini",resizable:"","max-height":380}}),a("div",{staticClass:"page_container"},[a("div",{staticClass:"pageNumber"},[e._v("每页显示")]),a("el-pagination",{staticClass:"erp-pagination",attrs:{"current-page":e.goPage,"page-size":e.pageSize1,"page-sizes":e.per_page,layout:"total,sizes, prev, pager, next,jumper",prevText:"上一页",nextText:"下一页",total:e.TableData.total},on:{"size-change":e.moduleHandleSizeChange,"current-change":e.moduleHandleCurrentChange,"update:currentPage":function(t){e.goPage=t},"update:current-page":function(t){e.goPage=t}}})],1)],1)])},i=[],r=(a("a9e3"),a("d81d"),a("a15b"),a("d398")),n=(a("caad"),{data:function(){var e=this,t=this.$createElement;return{tableColumn:[{type:"checkbox",align:"center",width:50},{type:"index",title:"序号",width:60},{field:"company_name",title:"库存组织",width:200,showOverflow:!0},{field:"goods_id",title:"商品编号",width:150,showOverflow:!0},{field:"goods_name",title:"商品名称",width:300,showOverflow:!0},{field:"warehouse_name",title:"预警仓库",width:200,showOverflow:!0},{field:"brand_name",title:"品牌",width:100,showOverflow:!0},{field:"ceiling_inventory",title:"库存上限",width:100,showOverflow:!0},{field:"lower_inventory",title:"安全库存",width:100,showOverflow:!0},{field:"stocks",title:"在库库存",width:100,showOverflow:!0},{field:"available_stocks",title:"可用库存",width:100,showOverflow:!0},{field:"quantity_adjusted",title:"建议调整数量",width:100,showOverflow:!0,slots:{default:function(a){var s=a.row,i=(a.rowIndex,a.column,a.scope,t("span",{style:e.setCellClass(s,"quantity_adjusted")},[s.quantity_adjusted]));return[i]}}},{field:"explain",title:"说明",width:120,showOverflow:!0,slots:{default:function(a){var s=a.row,i=(a.rowIndex,a.column,a.scope,t("span",{style:e.setCellClass(s,"quantity_adjusted")},[s.explain]));return[i]}}}],tableData:[]}},methods:{getSelectRecords:function(){var e=this.$refs.xTable.getCheckboxRecords();return e=e.map((function(e){return e._XID&&delete e._XID,e})),e},updateTableFooter:function(){this.$refs.xTable.updateFooter()},footerMethod:function(e){var t=this,a=e.columns,s=e.data;return[a.map((function(e,a){return 1===a?"页小计":["ceiling_inventory","lower_inventory","available_stocks","stocks","quantity_adjusted"].includes(e.property)?t.$utils.sum(s,e.property):null})),a.map((function(e,a){if(1===a)return"合计";if(t.TableData.allList){if("ceiling_inventory"==e["property"])return t.TableData.allList.total_ceiling_inventory;if("lower_inventory"==e["property"])return t.TableData.allList.total_lower_inventory;if("available_stocks"==e["property"])return t.TableData.allList.total_available_stocks;if("stocks"==e["property"])return t.TableData.allList.total_stocks;if("quantity_adjusted"==e["property"])return t.TableData.allList.total_quantity_adjusted}return null}))]}}}),o=n,l=a("65b0"),c={name:"inventoryWarningStockEarlyWarningQuery",mixins:[r["a"],o],data:function(){return{loading:!1}},methods:{beforeGetList:function(){if(!this.params.company_id)return this.$message.warning("所有公司商品数量过大，请选择单一库存组织，筛选商品"),!1},getTableList:function(e){var t=this,a=e;a.TableData=this.TableData,a.API="getService_stationWarningQueryList",a.vm=this,Object(l["b"])(a,2,(function(e){t.$nextTick((function(){t.updateTableFooter()}))}))},initHeaderValue:function(){var e=this;this.searchParams.params={},this.$set(this,"params",{early_warning_type:"",warehouse_id:"",company_id:"",company_name:""}),setTimeout((function(){e.$refs.erpCompanyList._setList({company_id:"",company_name:"全部"})}),500),this.warehouseList=[{warehouse_id:-1,warehouse_name:"全部仓库"}]},setCellClass:function(e,t){var a=Number(e[t]),s="",i="";return a&&!isNaN(a)&&(a>0?(s="库存数量低于安全库存",i={color:"red"}):a<0&&(s="库存数量高于上限"),this.$set(e,"explain",s)),i},onSearch:function(){var e=this;this.$refs.formSearch.validate((function(t){t&&(Object.assign(e.searchParams.params,e.params,{page:1}),e.getTableList(e.searchParams))}))},onReset:function(){this.initHeaderValue(),Object.assign(this.searchParams.params,this.params,{page:1}),this.getTableList(this.searchParams)},turnToPurchasing:function(){var e=this.getSelectRecords();e.length<=0?this.messageTip("请勾选明细信息"):this.goReturnTo()},goReturnTo:function(){for(var e,t=this.getSelectRecords(),a=t.map((function(e){return e.inventory_goods_id})),s=0;s<t.length;s++){if(e&&e!==t[s].company_id)return void this.$message.warning("请选择同一家公司进行转单");e=t[s].company_id}this.$router.push({name:"jybdorderIndex",params:{inventory_goods_id:a.join()}})}},created:function(){var e=this;this.initHeaderValue(),Object.assign(this.searchParams.params,this.params,{page:1}),this.$route.params&&1===this.$route.params.type&&(this.params.company_id="",this.params.warehouse_id="",this.params.early_warning_type="lower",setTimeout((function(){e.$refs.erpCompanyList._setList({company_id:"",company_name:"全部"})}),500)),Object.assign(this.searchParams.params,this.params,{page:1}),this.getTableList(this.searchParams)}},u=c,d=(a("d868"),a("2877")),m=Object(d["a"])(u,s,i,!1,null,"624e6c9e",null);t["default"]=m.exports},"9fdc":function(e,t,a){},d398:function(e,t,a){"use strict";a("d3b7"),a("159b");var s={data:function(){return{downLoading:!1,goodsList:[]}},computed:{allWarehouseList:function(){var e=this.warehouseList;return e.length>0&&e.unshift({relation_warehouse_id:0,warehouse_id:-1,warehouse_name:"全部仓库"}),e}},methods:{moduleHandleSizeChange:function(e){Object.assign(this.searchParams.params,{per_page:e,page:1}),this.getTableList(this.searchParams)},moduleHandleCurrentChange:function(e){Object.assign(this.searchParams.params,{page:e}),this.getTableList(this.searchParams)},companyChange:function(e){-1!=this.params.warehouse_id&&this.$set(this.params,"warehouse_id","")},messageTip:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tip",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";void 0==this._messageBox?this._messageBox=[]:this._messageBox.forEach((function(e){e.close()}));var a=this.$message({message:e,type:t});this._messageBox.push(a)},messageBox:function(e){var t=this,a=e.title,s=void 0===a?"提示":a,i=e.tipMsg,r=void 0===i?"":i,n=e.type,o=void 0===n?"warning":n,l=e.conBtnText,c=void 0===l?"确定":l,u=e.canBtnText,d=void 0===u?"取消":u,m=e.cancelMsg,h=e.callBack;this.$confirm(r,{title:s,confirmButtonText:c,cancelButtonText:d,showCancelButton:!!d,dangerouslyUseHTMLString:!0,type:o}).then((function(){h&&h()})).catch((function(){m&&t.$message({type:"info",message:m})}))}},mounted:function(){var e=this.$refs.tableName,t=this.$refs.table_sum;if(e&&t){var a=e.$el.getElementsByClassName("el-table__body-wrapper")[0];a.addEventListener("scroll",(function(){t.scrollLeft=this.scrollLeft}))}}};t["a"]=s},d868:function(e,t,a){"use strict";a("9fdc")}}]);
//# sourceMappingURL=chunk-7fc9821d.1cf51fc6.js.map