(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-1c794e5d"],{a952:function(e,t,a){"use strict";a("f482")},b680:function(e,t,a){"use strict";var o=a("23e7"),i=a("da84"),r=a("e330"),s=a("5926"),n=a("408a"),l=a("1148"),c=a("d039"),p=i.RangeError,m=i.String,h=Math.floor,u=r(l),d=r("".slice),g=r(1..toFixed),_=function(e,t,a){return 0===t?a:t%2===1?_(e,t-1,a*e):_(e*e,t/2,a)},f=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},b=function(e,t,a){var o=-1,i=a;while(++o<6)i+=t*e[o],e[o]=i%1e7,i=h(i/1e7)},w=function(e,t){var a=6,o=0;while(--a>=0)o+=e[a],e[a]=h(o/t),o=o%t*1e7},y=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var o=m(e[t]);a=""===a?o:a+u("0",7-o.length)+o}return a},v=c((function(){return"0.000"!==g(8e-5,3)||"1"!==g(.9,0)||"1.25"!==g(1.255,2)||"1000000000000000128"!==g(0xde0b6b3a7640080,0)}))||!c((function(){g({})}));o({target:"Number",proto:!0,forced:v},{toFixed:function(e){var t,a,o,i,r=n(this),l=s(e),c=[0,0,0,0,0,0],h="",g="0";if(l<0||l>20)throw p("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return m(r);if(r<0&&(h="-",r=-r),r>1e-21)if(t=f(r*_(2,69,1))-69,a=t<0?r*_(2,-t,1):r/_(2,t,1),a*=4503599627370496,t=52-t,t>0){b(c,0,a),o=l;while(o>=7)b(c,1e7,0),o-=7;b(c,_(10,o,1),0),o=t-1;while(o>=23)w(c,1<<23),o-=23;w(c,1<<o),b(c,1,1),w(c,2),g=y(c)}else b(c,0,a),b(c,1<<-t,0),g=y(c)+u("0",l);return l>0?(i=g.length,g=h+(i<=l?"0."+u("0",l-i)+g:d(g,0,i-l)+"."+d(g,i-l))):g=h+g,g}})},d5b1:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search_container"},[a("el-form",{ref:"filterFormRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params,rules:e.rules}},[a("el-form-item",{attrs:{label:"库存组织",size:"mini",rules:e.rules.company_id,prop:"company_id"}},[a("el-select",{attrs:{placeholder:"请选择","filter-method":e.companyFilter,filterable:""},on:{change:e.companyChange,focus:e.getCompany},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"仓库",size:"mini",prop:"warehouse_id",rules:[{required:!0,message:"请选择仓库",trigger:"change"}]}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.warehouseChangeId,focus:e.warehouseInvok},model:{value:e.params.warehouse_id,callback:function(t){e.$set(e.params,"warehouse_id",t)},expression:"params.warehouse_id"}},e._l(e.warehouseList,(function(e){return a("el-option",{key:e.warehouse_id,attrs:{label:e.warehouse_name,value:e.warehouse_id}})})),1)],1),a("el-form-item",{attrs:{label:"货位",size:"mini",prop:"allocation_id",rules:[{required:!0,message:"请选择货位",trigger:"change"}]}},[a("erpAllocation",{attrs:{searchParams:{company_id:e.params.company_id,warehouse_id:e.params.warehouse_id,is_incomplete:3}},model:{value:e.params.allocation_id,callback:function(t){e.$set(e.params,"allocation_id",t)},expression:"params.allocation_id"}})],1),a("el-form-item",{attrs:{label:"商品名称",size:"mini",prop:"goods_name",rules:[{required:!0,message:"请选择商品",trigger:"change"}]}},[a("v-GoodsList",{attrs:{scopes:{row:e.params},vxeParams:{company_id:e.params.company_id},changeGoods:e.handleSelect,showObj:{goods_id:"商品编号",goods_name:"商品名称"}}})],1),a("el-form-item",{attrs:{label:"年周/批次",size:"mini",prop:"batch",rules:[{required:!0,message:"请选择批次",trigger:"change"}]}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},on:{focus:e.getBatchListInvok},model:{value:e.params.batch,callback:function(t){e.$set(e.params,"batch",t)},expression:"params.batch"}},e._l(e.batchList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.batch,value:e.batch}})})),1)],1),a("el-form-item",{attrs:{label:"审核日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:""},on:{change:e.change},model:{value:e.timeValue,callback:function(t){e.timeValue=t},expression:"timeValue"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1),1==e.authority.b_export&&e.listShow?a("div",{staticClass:"add_delet"},[a("el-dropdown",{attrs:{placement:"bottom-start"}},[a("span",{staticStyle:{cursor:"pointer",color:"#4e90e2"},attrs:{"split-button":""}},[a("el-button",{attrs:{plain:"",icon:"iconfont icon-daochu10",size:"mini"}},[e._v("导出")])],1),a("el-dropdown-menu",{staticStyle:{"margin-top":"10px"},attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(1)}}},[e._v("导出Excel文件")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(2)}}},[e._v("导出CSV逗号分隔")])],1)],1)],1):e._e(),e.listShow?a("div",{staticClass:"table_container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading1,expression:"loading1"}],staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableData.tableData,"max-height":e.tableHeight,"summary-method":e.getSummaries,"show-summary":""}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"company_name",width:"150",label:"库存组织"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_id",width:"180",label:"商品编号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_name","min-width":"500",label:"商品名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.goods_name))])]}}],null,!1,3380057349)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"batch",width:"180",label:"年周/批次"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"warehouse_name",width:"132",label:"仓库名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"allocation_name",width:"180",label:"货位名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"order_sn",width:"180",label:"单据号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"add_time",width:"180",label:"单据日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"auditor_time",width:"180",label:"审核日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"type",width:"180",label:"单据类型"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"in_num",width:"180",label:"入库数量",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"in_price",width:"180",label:"入库单价",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"in_costprice",width:"180",label:"入库成本",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"out_num",width:"180",label:"出库数量",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"out_price",width:"180",label:"出库单价",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"out_costprice",width:"180",label:"出库成本",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("priceFormatNone")(t.row.out_costprice))+" ")]}}],null,!1,1248515447)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"bond_num",width:"180",label:"结存数量",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"bond_price",width:"180",label:"结存单价",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("priceFormatNone")(t.row.bond_price))+" ")]}}],null,!1,1868728181)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"bond_cost_price",width:"180",label:"结存成本",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("priceFormatNone")(t.row.bond_cost_price))+" ")]}}],null,!1,120342369)})],1),a("div",{staticClass:"page_container"},[a("div",{staticClass:"pageNumber"},[e._v("每页显示")]),a("el-pagination",{staticClass:"erp-pagination",attrs:{"current-page":e.goPage,"page-size":e.pageSize1,"page-sizes":e.per_page,layout:"total,sizes, prev, pager, next,jumper",prevText:"上一页",nextText:"下一页",total:e.TableData.total},on:{"size-change":e.handleSizeChange,"update:currentPage":function(t){e.goPage=t},"update:current-page":function(t){e.goPage=t},"current-change":e.handleCurrentChange}})],1)],1):e._e()])},i=[],r=(a("d3b7"),a("159b"),a("caad"),a("d81d"),a("a9e3"),a("b680"),a("65b0")),s={name:"reportCostdetail",data:function(){return{authority:{},params:{},searchParams:{},listShow:!1,timeValue:[],optionsW:null,exportType:null,companyList:{},TableData:{allList:{},tableData:[]},goPage:1,pageSize:30,getwarehouseOption:!0,per_page:[30,50,100,500],loading:!1,goodsList:[],list:[],tableHeight:600}},methods:{getSummaries:function(e){var t=e.columns,a=e.data,o=[];return t.forEach((function(e,t){if(0!==t){if(["in_num","out_num"].includes(e.property)){var i=a.map((function(t){return Number(t[e.property]||0)}));o[t]=i.reduce((function(e,t){Number(t);return e+t}),0)}else if(["in_costprice","out_costprice"].includes(e.property)){var r=a.map((function(t){return Number(t[e.property]||0)}));o[t]=r.reduce((function(e,t){Number(t);return Number((e+t).toFixed(2))}),0),o[t]=o[t].toFixed(2)}}else o[t]="合计"})),o},change:function(e){this.params.start_time=e[0],this.params.end_time=e[1]},changeDefaultArea:function(e){this.params.province_id=e[0],this.params.city_id=e[1],this.params.area_id=e[2]},exportOrder:function(e){if(0==this.listShow)return this.$message({message:"请查询需要导出的数据",type:"error"}),!1;Object.assign(this.params,{export_type:e});this.$axMethod.exportCostDetailUrl(this.params).then((function(e){200==e.data.code&&(window.location.href=e.data.data.url)}))},changeProvince:function(){this.$common.options("getAreaListOption",this.city,{level:3,p_id:this.params.province_id}),this.$set(this.params,"city_id",""),this.$set(this.params,"area_id","")},changeCity:function(){this.$common.options("getAreaListOption",this.area,{level:4,p_id:this.params.city_id})},companyChange:function(e){this.$set(this.params,"warehouse_id",""),this.$set(this.params,"goods_name",""),this.$set(this.params,"goods_id",""),this.$set(this.params,"allocation_id",""),this.$set(this.params,"batch","")},warehouseChangeId:function(e){this.getwarehouseOption=!1,this.$set(this.params,"goods_name",""),this.$set(this.params,"goods_id",""),this.$set(this.params,"allocation_id",""),this.$set(this.params,"batch","")},allocationChange:function(){this.$set(this.params,"goods_name",""),this.$set(this.params,"goods_id",""),this.$set(this.params,"batch","")},onReset:function(){this.$set(this,"params",{company_id:Number(localStorage.company_id)}),this.timeValue=[],this.$set(this.TableData,"tableData",[]),this.listShow=!1},handleSelect:function(e){this.$set(this.params,"goods_id",e.goods_id),this.$set(this.params,"goods_name",e.goods_name),this.$set(this.params,"batch","")},onSearch:function(){var e=this;console.log(this.params),this.$refs.filterFormRef.validate((function(t){t&&(e.listShow=!0,e.timeValue&&2==e.timeValue.length?(e.params.start_time=e.timeValue[0],e.params.end_time=e.timeValue[1]):e.params.start_time=e.params.end_time="",Object.assign(e.searchParams.params,e.params,{page:1}),Object(r["g"])(e.searchParams,2,r["o"].bind(e)))}))},handleSizeChange:function(e){Object.assign(this.searchParams.params,{per_page:e,page:1}),Object(r["g"])(this.searchParams)},handleCurrentChange:function(e){Object.assign(this.searchParams.params,{page:e}),Object(r["g"])(this.searchParams)},companyFilter:function(e){var t={type:1,company_name:e};Object(r["k"])(this,t)},getCompany:function(){var e={type:1,company_name:null};Object(r["k"])(this,e)}},mounted:function(){this.authority=JSON.parse(localStorage.getItem("authority")),this.$set(this,"params",{company_id:Number(localStorage.company_id)}),this.companyList=[{company_id:Number(localStorage.company_id),company_name:localStorage.company_name}],this.$set(this,"searchParams",{params:{},TableData:this.TableData,API:"v2GetCostDetailList",vm:this}),r["o"].bind(this)(),window.onresize=r["o"].bind(this)}},n=s,l=(a("a952"),a("2877")),c=Object(l["a"])(n,o,i,!1,null,"589d621c",null);t["default"]=c.exports},f482:function(e,t,a){}}]);
//# sourceMappingURL=chunk-1c794e5d.bc14acaa.js.map