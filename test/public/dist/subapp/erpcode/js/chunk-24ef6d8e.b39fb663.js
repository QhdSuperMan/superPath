(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-24ef6d8e"],{"0cb2":function(t,e,a){var r=a("e330"),o=a("7b0b"),i=Math.floor,n=r("".charAt),l=r("".replace),s=r("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,a,r,d,p){var h=a+t.length,_=r.length,b=u;return void 0!==d&&(d=o(d),b=c),l(p,b,(function(o,l){var c;switch(n(l,0)){case"$":return"$";case"&":return t;case"`":return s(e,0,a);case"'":return s(e,h);case"<":c=d[s(l,1,-1)];break;default:var u=+l;if(0===u)return o;if(u>_){var p=i(u/10);return 0===p?o:p<=_?void 0===r[p-1]?n(l,1):r[p-1]+n(l,1):o}c=r[u-1]}return void 0===c?"":c}))}},2370:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"seePage"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[t._v("售后管理")]),a("el-breadcrumb-item",{staticClass:"attrbute"},[a("span",{on:{click:t.goBack}},[t._v("三包退货")])]),a("el-breadcrumb-item",[t._v("查看三包退货")])],1),a("div",{staticClass:"search_container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.TableData}},[a("el-form-item",{attrs:{label:"销售组织："}},[t._v(" "+t._s(t.TableData.company_name)+" ")]),a("el-form-item",{attrs:{label:"单据号："}},[t._v(" "+t._s(t.TableData.return_sn)+" ")]),a("el-form-item",{attrs:{label:"业务日期："}},[t._v(" "+t._s(t.TableData.business_time)+" ")]),a("el-form-item",{attrs:{label:"客户名称："}},[t._v(" "+t._s(t.TableData.customer_name)+" ")]),a("el-form-item",{attrs:{label:"部门："}},[t._v(" "+t._s(t.TableData.department_name)+" ")]),a("el-form-item",{attrs:{label:"业务员："}},[t._v(" "+t._s(t.TableData.business_name)+" ")]),a("el-form-item",{attrs:{label:"来源单号："}},[t._v(" "+t._s(t.TableData.outstock_sn)+" ")]),a("el-form-item",{attrs:{label:"意向物流："}},[t._v(" "+t._s(t.TableData.intentional_logistics)+" ")]),a("el-form-item",{attrs:{label:"退货原因："}},[t._v(" "+t._s(t.TableData.reason_name)+" ")]),a("el-form-item",{attrs:{label:"单据状态："}},[t._v(" "+t._s(t.TableData.auditor_status_name)+" ")]),a("el-form-item",{attrs:{label:"备注："}},[t._v(" "+t._s(t.TableData.remark)+" ")])],1)],1),a("div",{staticClass:"table_container"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:t.TableData.goods_info,"summary-method":t.getSummaries,"show-summary":"","max-height":"600"}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"index",width:"50",label:"序号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_id",label:"商品编号",width:"80"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_name",label:"商品名称",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("pre",[t._v(t._s(e.row.goods_name))])]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"batch",label:"年周/批次",width:"88"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"数量",property:"return_goods_num",type:"number",width:"70",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"unit_price",label:"销售单价",width:"100",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("pre",[t._v(t._s(t._f("priceFormatNone")(e.row.true_unit_price)))])]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"return_subtotal_price",label:"金额",align:"right",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("pre",[t._v(t._s(t._f("priceFormatNone")(e.row.return_subtotal_price)))])]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"warehouse_name",label:"仓库",width:"132"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"allocation_name",label:"货位",width:"130"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,"render-header":t.renderHeaderpro,property:"production_time",width:"80",label:"生产日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"unit_name",label:"单位",width:"88"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"remark",label:"备注"}})],1),10002==t.TableData.outstock_type_id&&t.TableData.outstock_sn?a("div",{staticClass:"leftfootlist"},[a("span",{staticClass:"yeban"},[t._v("本单退还返利："+t._s(t.TableData.rebate_price))]),a("span",{staticClass:"yeban"},[t._v("本单退还预收："+t._s(t.TableData.deposits_price))])]):t._e(),a("div",{staticClass:"refundauditFoot"},[a("span",[t._v("制单人："+t._s(t.TableData.add_user_name))]),a("span",[t._v("单据时间："+t._s(t.TableData.add_time))]),a("span",[t._v("审核人："+t._s(t.TableData.auditor_name))]),a("span",[t._v("审核时间："+t._s(t.TableData.auditor_time))]),a("span",[t._v("修改人："+t._s(t.TableData.update_user_name))]),a("span",[t._v("修改时间："+t._s(t.TableData.update_time))])])],1),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center","margin-top":"20px"}},[1==t.TableData.after_auditor_print_status?[1==t.authority.b_print&&2==t.TableData.auditor_status?a("el-button",{attrs:{type:"primary"},on:{click:t.printSheet}},[t._v("打印")]):t._e()]:[1==t.authority.b_print?a("el-button",{attrs:{type:"primary"},on:{click:t.printSheet}},[t._v("打印")]):t._e()],2==t.TableData.auditor_status?[1==t.authority.b_invalid?a("el-button",{on:{click:function(e){return t.audit("auditInvalidThressReturn")}}},[t._v("作废")]):t._e(),1==t.authority.b_nopass?a("el-button",{on:{click:t.auditNoThressReturn}},[t._v("弃审")]):t._e()]:t._e(),1==t.TableData.auditor_status?[1==t.authority.b_pass?a("el-button",{attrs:{type:"primary"},on:{click:t.shenhe}},[t._v("审核")]):t._e(),1==t.authority.b_invalid?a("el-button",{on:{click:function(e){return t.audit("auditInvalidThressReturn")}}},[t._v("作废")]):t._e()]:t._e(),3==t.TableData.auditor_status||1!=t.authority.b_invalid&&1!=t.authority.b_pass?[a("el-button",{on:{click:t.goBack}},[t._v("返回")])]:a("el-button",{on:{click:t.goBack}},[t._v("取消")])],2),t.dialogUserVisible?a("div",[a("el-dialog",{staticClass:"dialogForm",attrs:{"close-on-click-modal":!1,title:"审核确认",visible:t.dialogUserVisible,width:"800px"},on:{"update:visible":function(e){t.dialogUserVisible=e}}},[a("div",{staticStyle:{width:"750px"}},[a("span",{staticStyle:{color:"red"}},[t._v("提示：由于以下商品无结存成本或者结存成本为0，请先输入成本单价！")]),a("el-table",{staticStyle:{width:"750px",float:"left","margin-top":"5px",cursor:"pointer"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:t.leftList,height:"242"}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"company_name",width:"100",label:"销售组织"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"warehouse_name",width:"132",label:"仓库"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"allocation_name",width:"100",label:"货位"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_id",width:"100",label:"商品编号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_name",width:"138",label:"商品名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"batch",width:"100",label:"年周/批次"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"cost_price",width:"110",label:"成本单价","render-header":t.renderHeader},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{size:"small",type:"number","suffix-icon":"el-icon-edit-outline",placeholder:"请输入"},on:{change:function(a){return t.getcost(e.row,e.$index)}},model:{value:e.row.cost_price,callback:function(a){t.$set(e.row,"cost_price",a)},expression:"scope.row.cost_price"}})]}}],null,!1,2149983207)})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"margin-top":"10px"},on:{click:function(e){t.dialogUserVisible=!1}}},[t._v("取 消")]),a("el-button",{staticClass:"tx",staticStyle:{"margin-top":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.submitUserForm()}}},[t._v("确 定")])],1)])],1):t._e(),a("publicPrint",{ref:"printDelieveryBill",attrs:{title:"threeReturn"},on:{Search:t.onSearch}})],1)},o=[],i=(a("b680"),a("a9e3"),a("d3b7"),a("159b"),a("d81d"),a("ac1f"),a("5319"),a("25f0"),a("78d2")),n={name:"salesSalesReturnSee",data:function(){return{authority:{},TableData:{},printFlag:!1,dialogUserVisible:!1,chaid:!1,hasAuditorStatusPrint:null}},methods:{renderHeaderpro:function(){var t=this.$createElement;return t("el-tooltip",{class:"item",attrs:{content:"Bottom center",effect:"light"}},[t("p",{slot:"content"},["生产日期列后期将会隐藏，同时新增商品入库日期列"]),t("span",{class:"el-icon-question",style:"cursor:pointer;font-weight:bold;"},["生产日期"])])},checkThreeReturn:function(){var t=this;this.$axios({method:"post",url:this.$api.auditThressReturn,data:{return_id:this.TableData.return_id}}).then((function(e){200==e.data.code&&(t.$message({message:e.data.msg||e.data.data,type:"success"}),t.goBack())}))},auditNoThressReturn:function(){var t=this;this.$baseData.checkCarDoctor({bill_type:7,bill_id:this.TableData.return_id,operation_type:5}).then((function(){t.$axios({url:t.$api.auditNoThressReturn,method:"post",data:{return_id:t.TableData.return_id}}).then((function(e){var a=e.data;200==a.code&&(t.$message({message:a.msg||a.data,type:"success"}),t.goBack())}))}))},shenhe:function(){var t=this;this.$baseData.checkCarDoctor({bill_type:7,bill_id:this.TableData.return_id,operation_type:4}).then((function(){t.$axMethod.checkThreeReturnGoods({return_id:t.TableData.return_id}).then((function(e){var a=e.data;200==a.code&&(1==a.data.is_success?t.checkThreeReturn():(t.leftList=a.data,t.dialogUserVisible=!0))}))}))},printSheet:function(){var t=this;this.printFlag=!0,this.$nextTick((function(){t.$refs.printDelieveryBill.printPdf({return_id:t.TableData.return_id})}))},renderHeader:function(t,e){var a=e.column;e.$index;return t("span",{class:"start",style:"cursor:pointer"},[" ",a.label," "])},submitUserForm:function(){for(var t=0;t<this.leftList.length;t++)if(void 0==this.leftList[t].cost_price||null==this.leftList[t].cost_price||""==this.leftList[t].cost_price)return this.$message({message:"成本单价不能为空且必须为正数",type:"warning"}),!1;this.checkThreeReturn()},getcost:function(t,e){if(t.cost_price<0||isNaN(t.cost_price))this.$message.warning("成本单价不能为空且必须为正数"),this.$set(this.leftList[e],"cost_price","");else if(t.cost_price>=1e8)this.$message.warning("数值不能超过一亿"),this.$set(this.leftList[e],"cost_price",0);else{var a=parseFloat(Number(t.cost_price)).toFixed(2);this.$set(this.leftList[e],"cost_price",a)}},goBack:function(){this.$router.push({path:"/aftersale/threepackagereturn"})},audit:function(t){var e=this;this.$baseData.checkCarDoctor({bill_type:7,bill_id:this.TableData.return_id,operation_type:6}).then((function(){e.$axios({method:"post",url:e.$api[t],data:{return_id:e.TableData.return_id}}).then((function(t){200==t.data.code&&(e.$message({message:t.data.msg||t.data.data,type:"success"}),e.goBack())}))}))},getSummaries:function(t){var e=t.columns,a=t.data,r=[];return e.forEach((function(t,e){if(1!==e){if("return_goods_num"===t.property){var o=a.map((function(e){return Number(e[t.property])}));r[e]=o.reduce((function(t,e){Number(e);return Number(t+e)}),0)}if("return_subtotal_price"===t.property){var i=a.map((function(e){return Number(e[t.property])}));r[e]=i.reduce((function(t,e){Number(e);return Number((t+e).toFixed(2))}),0),r[e]=r[e].toFixed(2).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}}else r[e]="合计"})),r}},components:{publicPrint:i["a"]},created:function(){var t=this;this.authority=JSON.parse(localStorage.getItem("authority")),this.hasAuditorStatusPrint=window.localStorage.hasAuditorStatusPrint,this.$axios({method:"get",url:this.$api.SeeThressReturn,params:{return_id:this.$route.query.id,return_sn:this.$route.query.return_sn}}).then((function(e){var a=e.data;200==a.code&&(a.data.goods_info.forEach((function(t){t.unit_price=t.return_unit_price})),t.$set(t,"TableData",a.data))}))}},l=n,s=(a("f36b"),a("2877")),c=Object(s["a"])(l,r,o,!1,null,"1286a450",null);e["default"]=c.exports},5319:function(t,e,a){"use strict";var r=a("2ba4"),o=a("c65b"),i=a("e330"),n=a("d784"),l=a("d039"),s=a("825a"),c=a("1626"),u=a("5926"),d=a("50c4"),p=a("577e"),h=a("1d80"),_=a("8aa5"),b=a("dc4a"),f=a("0cb2"),m=a("14c3"),v=a("b622"),g=v("replace"),w=Math.max,y=Math.min,T=i([].concat),D=i([].push),$=i("".indexOf),k=i("".slice),x=function(t){return void 0===t?t:String(t)},S=function(){return"$0"==="a".replace(/./,"$0")}(),N=function(){return!!/./[g]&&""===/./[g]("a","$0")}(),C=!l((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));n("replace",(function(t,e,a){var i=N?"$":"$0";return[function(t,a){var r=h(this),i=void 0==t?void 0:b(t,g);return i?o(i,t,r,a):o(e,p(r),t,a)},function(t,o){var n=s(this),l=p(t);if("string"==typeof o&&-1===$(o,i)&&-1===$(o,"$<")){var h=a(e,n,l,o);if(h.done)return h.value}var b=c(o);b||(o=p(o));var v=n.global;if(v){var g=n.unicode;n.lastIndex=0}var S=[];while(1){var N=m(n,l);if(null===N)break;if(D(S,N),!v)break;var C=p(N[0]);""===C&&(n.lastIndex=_(l,d(n.lastIndex),g))}for(var F="",R=0,B=0;B<S.length;B++){N=S[B];for(var L=p(N[0]),U=w(y(u(N.index),l.length),0),I=[],P=1;P<N.length;P++)D(I,x(N[P]));var V=N.groups;if(b){var E=T([L],I,U,l);void 0!==V&&D(E,V);var M=p(r(o,void 0,E))}else M=f(L,l,U,I,V,o);U>=R&&(F+=k(l,R,U)+M,R=U+L.length)}return F+k(l,R)}]}),!C||!S||N)},b680:function(t,e,a){"use strict";var r=a("23e7"),o=a("da84"),i=a("e330"),n=a("5926"),l=a("408a"),s=a("1148"),c=a("d039"),u=o.RangeError,d=o.String,p=Math.floor,h=i(s),_=i("".slice),b=i(1..toFixed),f=function(t,e,a){return 0===e?a:e%2===1?f(t,e-1,a*t):f(t*t,e/2,a)},m=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},v=function(t,e,a){var r=-1,o=a;while(++r<6)o+=e*t[r],t[r]=o%1e7,o=p(o/1e7)},g=function(t,e){var a=6,r=0;while(--a>=0)r+=t[a],t[a]=p(r/e),r=r%e*1e7},w=function(t){var e=6,a="";while(--e>=0)if(""!==a||0===e||0!==t[e]){var r=d(t[e]);a=""===a?r:a+h("0",7-r.length)+r}return a},y=c((function(){return"0.000"!==b(8e-5,3)||"1"!==b(.9,0)||"1.25"!==b(1.255,2)||"1000000000000000128"!==b(0xde0b6b3a7640080,0)}))||!c((function(){b({})}));r({target:"Number",proto:!0,forced:y},{toFixed:function(t){var e,a,r,o,i=l(this),s=n(t),c=[0,0,0,0,0,0],p="",b="0";if(s<0||s>20)throw u("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return d(i);if(i<0&&(p="-",i=-i),i>1e-21)if(e=m(i*f(2,69,1))-69,a=e<0?i*f(2,-e,1):i/f(2,e,1),a*=4503599627370496,e=52-e,e>0){v(c,0,a),r=s;while(r>=7)v(c,1e7,0),r-=7;v(c,f(10,r,1),0),r=e-1;while(r>=23)g(c,1<<23),r-=23;g(c,1<<r),v(c,1,1),g(c,2),b=w(c)}else v(c,0,a),v(c,1<<-e,0),b=w(c)+h("0",s);return s>0?(o=b.length,b=p+(o<=s?"0."+h("0",s-o)+b:_(b,0,o-s)+"."+_(b,o-s))):b=p+b,b}})},c436:function(t,e,a){},f36b:function(t,e,a){"use strict";a("c436")}}]);
//# sourceMappingURL=chunk-24ef6d8e.b39fb663.js.map