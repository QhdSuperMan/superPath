(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-c880d4fc"],{4997:function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return u}));var a=i("1da1"),n=i("ade3"),r=i("d4ec"),s=i("bee2"),l=(i("96cf"),i("d3b7"),i("25f0"),i("159b"),i("4de4"),i("caad"),i("2532"),i("4360"));function o(t){if("function"===typeof t&&t().then)return!0}var c=function(){function t(e){Object(r["a"])(this,t),this._this=e._this,this.addr=[],this.indexSign=null,this.URL=e.url,this.id=e.id,this.errId=e.errId?e.errId:e.id,this.title=e.title?e.title:"审核",this.allTitle=e.allTitle,this.params=e.params,this.before=e.before,this.checkbox=null,this.Data=null,this.showConfirm=e.showConfirm,this.callbackFunc=e.callbackFunc}return Object(s["a"])(t,[{key:"verify",value:function(){return!(this._this.multipleSelection.length<1)||(this._this.$message({message:"请选择需要".concat(this.title,"的信息"),type:"warning"}),!1)}},{key:"confirm",value:function(){var t="确定要“"+this.title+"”此条信息?";return this.allTitle&&(t=this.allTitle),this._this.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}},{key:"sendAjax",value:function(t,e,i){var a,r=this,s=Object.assign(Object(n["a"])({},this.id,t),this.params);this._this.$axMethod[this.URL]?a=this._this.$axMethod[this.URL](s):this._this.$api[this.URL]&&(a=this._this.$axios({url:this._this.$api[this.URL],method:"post",data:s})),a.then((function(t){r.checkbox=r._this.multipleSelection,r.callbackFunc&&r.callbackFunc(t.data),200==t.data.code?(e(t),r.Data=t):i(t)})).catch((function(t){i(t)}))}},{key:"logic",value:function(){var t=this;if(!this.verify())return!1;for(var e=0;e<this._this.multipleSelection.length;e++)this.addr.push(this._this.multipleSelection[e][this.id]);var i=this.addr.toString();return new Promise((function(e,a){if(1==t.showConfirm)t.confirm().then((function(){if(o(t.before))t.before(i).then((function(){return t.sendAjax(i,e,a)}));else if(t.before&&t.before()||!t.before)return t.sendAjax(i,e,a)}));else if(o(t.before))t.before(i).then((function(){return t.sendAjax(i,e,a)}));else if(t.before&&t.before()||!t.before)return t.sendAjax(i,e,a)}))}},{key:"send",value:function(){var t=this;this.logic().then((function(e){var i=e.data;200===i.code&&(t._this.$message.success(i.msg?i.msg:i.data),t._this.onSearch&&t._this.onSearch())}))}},{key:"callback",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,i,a,n,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.logic();case 3:this.Data&&this.Data.data&&this.Data.data.data.length?(e=this.Data.data.data,i=[],e.forEach((function(t){i.push(t.serial)})),a=this.checkbox.filter((function(t){return 1==i.includes(t[r.errId])})),this._this.indexSign.arr=a,this._this.indexSign.str=this.errId,l["a"].commit("setErrorObj",{msg:this.Data.data.msg,table:this.Data.data.data,state:!0})):(n=this.Data.data.msg?this.Data.data.msg:this.Data.data.data,this._this.indexSign.arr=[],this._this.$message({message:n,type:"success"}),this._this.multipleSelection=[],this._this.onSearch&&this._this.onSearch()),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),console.log();case 9:case"end":return t.stop()}}),t,this,[[0,6]])})));function e(){return t.apply(this,arguments)}return e}()}]),t}(),u=function(){function t(e){var i=e._this,a=e.url,n=e.list,s=void 0===n?[]:n,l=e.params,o=void 0===l?{}:l,c=e.before;Object(r["a"])(this,t),this._this=i,this.url=a,this.list=s,this.params=o,this.before=c}return Object(s["a"])(t,[{key:"sendAjax",value:function(t,e){var i;this._this.$axMethod[this.url]?i=this._this.$axMethod[this.url](this.params):this._this.$api[this.url]&&(i=this._this.$axios({url:this._this.$api[this.url],method:"post",data:this.params})),i.then((function(i){200==i.data.code?t(i):e(i)})).catch((function(t){e(t)}))}},{key:"edit",value:function(){var t=this;return new Promise((function(e,i){if(o(t.before))t.before().then((function(){return t.sendAjax(e,i)}));else if(t.before&&t.before()||!t.before)return t.sendAjax(e,i)}))}},{key:"callback",value:function(){var t=this;return new Promise((function(e,i){t.edit().then((function(a){if(a.data&&a.data.data&&a.data.data.length){l["a"].commit("setErrorObj",{msg:a.data.msg,table:a.data.data,state:!0});var n=[];a.data.data.forEach((function(t){n.push(t.serial)})),t._this.indexSign=n,i(a)}else t._this.$message({message:a.data.msg?a.data.msg:a.data.data,type:"success"}),e(a)}))}))}}]),t}()},9374:function(t,e,i){},"9d20":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"errorDialog"},[i("vxe-modal",{attrs:{width:"520",showHeader:"false","mask-closable":"true"},on:{close:t.close},model:{value:t.errorState,callback:function(e){t.errorState=e},expression:"errorState"}},[i("div",{staticClass:"titles"},[t._v("提示:"+t._s(t.errorData.msg))]),i("vxe-grid",{attrs:{height:"200","show-overflow":"tooltip",border:"",columns:t.titleName,size:"mini",data:t.errorData.data}})],1)],1)},n=[],r={props:{errorData:{type:Object,default:function(){return{}}},errorState:{type:Boolean,default:!1},titleName:{type:Array,default:function(){return[{type:"seq",title:"序号",width:50},{field:"serial",width:200,title:"单据号"},{field:"msg",title:"失败原因"}]}}},methods:{close:function(){this.$parent.errorState=!1}}},s=r,l=(i("fa01"),i("a43d"),i("2877")),o=Object(l["a"])(s,a,n,!1,null,"21c7364e",null);e["a"]=o.exports},a43d:function(t,e,i){"use strict";i("9374")},c1ac:function(t,e,i){},d434:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"params"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.purchaseprice,expression:"purchaseprice"}],attrs:{id:"leixin"}},[i("div",{staticClass:"search_container"},[i("el-form",{ref:"filterFormRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params}},[i("el-form-item",{attrs:{label:"库存组织",size:"mini"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{change:t.companyChange,focus:t.companyListInvok},model:{value:t.params.company_id,callback:function(e){t.$set(t.params,"company_id",e)},expression:"params.company_id"}},t._l(t.companyList,(function(e){return i("el-option",{key:e.company_id,attrs:{label:e.company_name,value:e.company_id}},[i("span",{class:1==e.type?"optionStyle":""},[t._v(t._s(e.company_name))])])})),1)],1),i("el-form-item",{attrs:{label:"业务日期",size:"mini"}},[i("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.timeValue,callback:function(e){t.timeValue=e},expression:"timeValue"}})],1),i("el-form-item",{attrs:{label:"单据号",size:"mini"}},[i("el-input",{attrs:{placeholder:"请输入"},model:{value:t.params.instorage_sn,callback:function(e){t.$set(t.params,"instorage_sn",e)},expression:"params.instorage_sn"}})],1),i("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini"}},[i("el-select",{attrs:{clearable:"",maxlength:"100","filter-method":t.supplierListInvok,filterable:"",placeholder:"请选择"},on:{change:t.supplierchange,focus:t.supplierListInvok},model:{value:t.params.supplier_id,callback:function(e){t.$set(t.params,"supplier_id",e)},expression:"params.supplier_id"}},t._l(t.supplierList,(function(t){return i("el-option",{key:t.supplier_id,attrs:{label:t.supplier_name,value:t.supplier_id}})})),1)],1),i("el-form-item",{attrs:{label:"仓库名称",size:"mini"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{focus:t.warehouseInvok,change:t.ckChange},model:{value:t.params.warehouse_id,callback:function(e){t.$set(t.params,"warehouse_id",e)},expression:"params.warehouse_id"}},t._l(t.warehouseList,(function(t){return i("el-option",{key:t.warehouse_id,attrs:{label:t.warehouse_name,value:t.warehouse_id}})})),1)],1),i("el-form-item",{attrs:{label:"入库类型",size:"mini"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.params.type,callback:function(e){t.$set(t.params,"type",e)},expression:"params.type"}},[i("el-option",{attrs:{label:"其他入库",value:2}}),i("el-option",{attrs:{label:"盘盈入库",value:4}}),i("el-option",{attrs:{label:"调拨入库",value:5}})],1)],1),i("el-form-item",{attrs:{label:"部门",size:"mini"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{change:t.departmentChange,focus:function(e){return t.DepartmentListInvok(t.params)}},model:{value:t.params.department_id,callback:function(e){t.$set(t.params,"department_id",e)},expression:"params.department_id"}},t._l(t.departmentList,(function(t){return i("el-option",{key:t.department_id,attrs:{label:t.department_name,value:t.department_id}})})),1)],1),i("el-form-item",{attrs:{label:"采购员",size:"mini"}},[i("el-select",{attrs:{clearable:""},on:{change:t.businessIdChange,focus:t.EmployeeListInvok},model:{value:t.params.buyer_id,callback:function(e){t.$set(t.params,"buyer_id",e)},expression:"params.buyer_id"}},t._l(t.employeeList,(function(t){return i("el-option",{key:t.employee_id,attrs:{label:t.employee_name,value:t.employee_id}})})),1)],1),i("el-form-item",{attrs:{label:"关联单号",size:"mini"}},[i("el-input",{attrs:{placeholder:"请输入"},model:{value:t.params.order_sn,callback:function(e){t.$set(t.params,"order_sn",e)},expression:"params.order_sn"}})],1),i("el-form-item",{attrs:{label:"审核状态",size:"mini"}},[i("el-select",{attrs:{clearable:""},model:{value:t.params.auditor_status,callback:function(e){t.$set(t.params,"auditor_status",e)},expression:"params.auditor_status"}},[i("el-option",{attrs:{label:"全部",value:0}},[t._v("全部")]),i("el-option",{attrs:{label:"未审核",value:1}},[t._v("未审核")]),i("el-option",{attrs:{label:"已审核",value:2}},[t._v("已审核")]),i("el-option",{attrs:{label:"作废",value:3}},[t._v("作废")])],1)],1),i("el-form-item",{attrs:{size:"mini"}},[i("el-checkbox",{staticStyle:{"margin-left":"110px"},attrs:{"false-label":"0","true-label":"1",name:"type"},model:{value:t.params.is_zero,callback:function(e){t.$set(t.params,"is_zero",e)},expression:"params.is_zero"}},[t._v(" 打印次数为0")])],1),i("el-form-item",{staticClass:"search-style",attrs:{size:"mini"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.onSearch(1)}}},[t._v("查询")]),i("el-button",{attrs:{plain:"",size:"mini"},on:{click:t.onReset}},[t._v("重置")])],1)],1)],1),i("div",{staticClass:"add_delet"},[1==t.authority.b_add?i("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:t.addF}},[t._v("新增")]):t._e(),1==t.authority.b_del?i("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:t.deletes}},[t._v("删除")]):t._e(),1==t.authority.b_pass?i("el-button",{attrs:{icon:"iconfont icon-pass",type:"primary",size:"mini"},on:{click:function(e){return t.abolishFun(1)}}},[t._v("审核")]):t._e(),1==t.authority.b_invalid?i("el-button",{staticClass:"addBtn",attrs:{plain:"",icon:"iconfont icon-zuofei",size:"mini"},on:{click:function(e){return t.abolishFun(2)}}},[t._v("作废")]):t._e(),1==t.authority.b_nopass?i("el-button",{attrs:{plain:"",icon:"iconfont icon-fanshenhe",size:"mini"},on:{click:t.AUDIT_GET}},[t._v(" 弃审")]):t._e(),1==t.authority.b_export_file?i("el-button",{attrs:{plain:"",icon:"el-icon-download",size:"mini"},on:{click:t.downloadF}},[t._v("下载模板 ")]):t._e(),1==t.authority.b_import?i("el-button",{staticClass:"addBtn",attrs:{plain:"",icon:"iconfont icon-daoru5",size:"mini"},on:{click:t.dialogEmployee}},[t._v("导入")]):t._e(),1==t.authority.b_print?i("el-button",{attrs:{plain:"",size:"mini",icon:"el-icon-printer"},on:{click:function(e){return t.printF()}}},[t._v("批量打印 ")]):t._e()],1),i("div",{staticClass:"table_container"},[i("xTable",{ref:"xTable",attrs:{ajax:{url:"otherStorageGetInStorageList",params:t.params},sign:t.indexSign,tableColumn:t.tableColumn,xData:t.tableData}})],1),i("upload",{ref:"upload",attrs:{options:t.options},on:{receiveUploadMsg:t.receiveUploadMsg}}),i("errorDialog",{attrs:{errorData:t.trunErrTable,errorState:t.errorState}})],1),t.printingStatusGet?i("div",[i("lodopDelivery",{ref:"lodopDelivery",attrs:{title:t.title},on:{Search:t.onSearch}})],1):t._e()])},n=[],r=i("5530"),s=(i("a9e3"),i("4de4"),i("d3b7"),i("159b"),i("d81d"),i("99af"),i("a15b"),i("e9c4"),i("25f0"),i("78d2")),l=i("9d20"),o={data:function(){var t=this;this.$createElement;return{footerData:{},tableColumn:[{type:"checkbox",width:44,align:"center"},{type:"index",title:"序号",width:50},{title:"操作",width:120,fixed:"right",slots:{default:function(e,i){return[i("el-button",{attrs:{size:"small",type:"text",disabled:1!==t.authority.b_info},on:{click:function(){return t.seeF(e,e.row)}}},[" 查看 "]),i("el-button",{attrs:{size:"small",type:"text",disabled:!("其他入库"===e.row.type&&"未审核"==e.row.auditor_status_name&&1==t.authority.b_edit)},on:{click:function(){return t.modify(e,e.row)}}},[" 修改  "]),i("el-button",{attrs:{size:"small",type:"text",disabled:!(1==e.row.after_auditor_print_status&&1==t.authority.b_print&&2==e.row.auditor_status||1!==e.row.after_auditor_print_status&&1==t.authority.b_print)},on:{click:function(){return t.printSheet(e.row)}}},[" 打印  "])]}}},{title:"库存组织",field:"company_name",width:150},{title:"单据号",field:"instorage_sn",width:160,slots:{default:function(e,i){return[i("el-link",{on:{click:function(){t.seeF(e,e.row)}}},[e.row.instorage_sn," "])]}}},{title:"供应商(厂家)",field:"supplier_name",width:150},{title:"入库数量",field:"num",width:70},{title:"入库金额",field:"total_price",formatter:"priceFormat",width:100},{title:"部门",field:"department_name",width:100},{title:"采购员",field:"buyer_name",width:100},{title:"入库仓库",field:"warehouse_name",width:132},{title:"入库类型",field:"type",width:70},{title:"创建人",field:"add_user_name",width:130},{title:"审核状态",field:"auditor_status_name",width:70},{title:"审核人",field:"auditor_name",width:84},{title:"业务日期",field:"business_time",width:130},{title:"单据时间",field:"add_time",width:130},{title:"审核时间",field:"auditor_time",width:130},{title:"来源单号",field:"order_sn",width:156},{title:"修改人",field:"update_user_name",width:130},{title:"修改时间",field:"update_time",width:130},{title:"备注",field:"remark",width:150},{title:"打印次数",field:"print_times",width:80}]}}},c=i("4997"),u=i("65b0"),h=i("2f62"),d={name:"instorageOtheninstorageInstorageIndex",mixins:[o],data:function(){return{options:{title:"导入",url:"/inventory/OtherStorage/importOtherStorage"},title:"",indexSign:{noDisabled:!0,arr:[]},errorState:!1,trunErrTable:{},purchaseprice:!0,planAdds:!1,examineprice:!1,lock:0,AccordingParams:{},tableHeight:600}},props:{type:{type:[Number,String],default:0},analyzeType:{type:[Number,String],default:0}},computed:Object(r["a"])({},Object(h["c"])(["printingStatusGet"])),components:{lodopDelivery:s["a"],errorDialog:l["a"]},methods:Object(r["a"])(Object(r["a"])({},Object(h["b"])(["printingStatus"])),{},{supplierchange:function(t){""!=t&&(this.params.supplier_name=this.supplierList.filter((function(e){return e.supplier_id===t}))[0].supplier_name)},ckChange:function(t){""!=t&&(this.params.warehouse_name=this.warehouseList.filter((function(e){return e.warehouse_id===t}))[0].warehouse_name)},businessIdChange:function(t){""!=t&&(this.params.buyer_name=this.employeeList.filter((function(e){return e.employee_id===t}))[0].employee_name)},dialogEmployee:function(){this.$refs.upload.stateOpen()},receiveUploadMsg:function(){this.$refs.xTable._getData()},printF:function(){for(var t=this,e=!1,i=this.multipleSelection,a=1;a<i.length;a++)if(i[a-1].company_id!=i[a].company_id){e=!0;break}if(this.multipleSelection.length)if(e)this.$message({message:"请选择相同公司单据进行打印",type:"warning"});else{var n=!0,r=[];if(this.multipleSelection.forEach((function(t){1==t.after_auditor_print_status&&2!=t.auditor_status&&(r.push(t.instorage_sn),n=!1)})),n)this.multipleSelection.forEach((function(e){t.printSheet(e,!0)}));else{var s=r.map((function(t,e){return"".concat(e+1,".").concat(t)}));this.$alert('以下未审核的单据不可打印：<br/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            <div style="color:#e6a23c">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t              '.concat(s.join("，"),"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            <div>"),"提示",{dangerouslyUseHTMLString:!0})}}else this.$message({message:"请选择单据进行打印",type:"warning"})},printSheet:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.printingStatus(!0),this.$set(this,"title","otherStoragePrint"),this.$nextTick((function(){e.$refs.lodopDelivery.printPdf({instorage_id:t.instorage_id},i)}))},companyChange:function(t){""!=t&&(this.params.company_name=this.companyList.filter((function(e){return e.company_id===t}))[0].company_name),Object(u["a"])(this,this.params)},downloadF:function(){this.$axMethod.downloadFileUrlinventory().then((function(t){200==t.data.code&&window.open(t.data.data.url)}))},AUDIT_GET:function(){var t=this;if(this.multipleSelection.length<1)return this.$message({message:"请选择需要弃审的信息！",type:"warning"}),!1;for(var e=[],i=[],a=0;a<this.multipleSelection.length;a++)e.push(this.multipleSelection[a].instorage_id),i.push({bill_id:this.multipleSelection[a].instorage_id,bill_type:"其他入库"===this.multipleSelection[a].type?2:"调拨入库"===this.multipleSelection[a].type?4:3});this.$baseData.checkCarDoctor({bill_type:2,bill_id:e.join(","),operation_type:5,type_info:JSON.stringify(i)}).then((function(){var e=new c["a"]({_this:t,id:"instorage_id",url:"OtherunAuditorPass",title:"弃审",errId:"instorage_sn",params:{is_list:1}});e.callback()}))},abolishFun:function(t){var e=this,i="",a="";switch(t){case 1:i="审核",a="otherStorageAuditorPassInStorage";break;case 2:i="作废",a="otherStorageAuditorInvalidInStorage";break;default:break}if(this.multipleSelection.length<1)return this.$message({message:"请选择需要".concat(i,"的信息！"),type:"warning"}),!1;for(var n=[],r=[],s=0;s<this.multipleSelection.length;s++)n.push(this.multipleSelection[s].instorage_id),r.push({bill_id:this.multipleSelection[s].instorage_id,bill_type:"其他入库"===this.multipleSelection[s].type?2:"调拨入库"===this.multipleSelection[s].type?4:3});this.$baseData.checkCarDoctor({bill_type:2,bill_id:n.join(","),operation_type:1===t?4:6,type_info:JSON.stringify(r)}).then((function(){var t=n.toString(),i={eachData:{instorage_id:t.toString()},UrlApi:a,list:{}};e.$common.audit(i,e.onSearch)}))},departmentChange:function(t){""!=t&&(this.params.department_name=this.departmentList.filter((function(e){return e.department_id===t}))[0].department_name),this.$set(this.params,"buyer_id","")},onReset:function(){this.timeValue=[],this.auditValue=[],this.$set(this,"params",{auditor_status:0}),this.indexSign.arr=[],this.onSearch()},seeF:function(t,e){this.$router.push({path:"/inventory/otheninstorage/otheninstorageSee",query:{instorage_id:e.instorage_id,after_auditor_print_status:e.after_auditor_print_status}})},addF:function(){this.$router.push({path:"/inventory/otheninstorage/otheninstorageAdd"})},modify:function(t,e){if(e&&1==e.is_execute)return this.$message.error("wms系统正在操作此单据，暂不支持单据修改"),!1;this.$router.push({path:"/inventory/otheninstorage/otheninstorageAdd",query:{instorage_id:e.instorage_id}})},onSearch:function(t){this.timeValue?(this.params.start_time=this.timeValue[0],this.params.end_time=this.timeValue[1]):this.params.start_time=this.params.end_time="",t&&(this.indexSign.arr=[]),this.$refs.xTable._getData(t)},deletes:function(){var t=this;if(this.multipleSelection.length<1)return this.$message({message:"请选择需要删除的信息！",type:"warning"}),!1;for(var e=[],i=[],a=0;a<this.multipleSelection.length;a++)e.push(this.multipleSelection[a].instorage_id),i.push({bill_id:this.multipleSelection[a].instorage_id,bill_type:"其他入库"===this.multipleSelection[a].type?2:"调拨入库"===this.multipleSelection[a].type?4:3});this.$baseData.checkCarDoctor({bill_type:2,bill_id:e.join(","),operation_type:3,type_info:JSON.stringify(i)}).then((function(){var e={deleID:"instorage_id",deleSelect:t.multipleSelection,deleApi:"otherStorageDelInStorage",list:{}};t.$common.deletes(e,"删除",t,t.onSearch)}))}}),created:function(){this.authority=JSON.parse(localStorage.getItem("authority")),this.$set(this,"params",{auditor_status:0})},activated:function(){this.onSearch(window.goPage)}},p=d,m=i("2877"),f=Object(m["a"])(p,a,n,!1,null,null,null);e["default"]=f.exports},fa01:function(t,e,i){"use strict";i("c1ac")}}]);
//# sourceMappingURL=chunk-c880d4fc.79f56f44.js.map