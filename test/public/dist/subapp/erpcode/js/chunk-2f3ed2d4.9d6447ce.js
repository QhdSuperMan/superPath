(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-2f3ed2d4"],{"0cb2":function(e,t,a){var r=a("e330"),i=a("7b0b"),s=Math.floor,o=r("".charAt),n=r("".replace),l=r("".slice),d=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,c=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,a,r,u,m){var p=a+e.length,_=r.length,f=c;return void 0!==u&&(u=i(u),f=d),n(m,f,(function(i,n){var d;switch(o(n,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,a);case"'":return l(t,p);case"<":d=u[l(n,1,-1)];break;default:var c=+n;if(0===c)return i;if(c>_){var m=s(c/10);return 0===m?i:m<=_?void 0===r[m-1]?o(n,1):r[m-1]+o(n,1):i}d=r[c-1]}return void 0===d?"":d}))}},"13d3":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"seePage"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("采购管理")]),a("el-breadcrumb-item",{staticClass:"attrbute"},[a("span",{on:{click:e.goBack}},[e._v("采购订单")])]),a("el-breadcrumb-item",[e._v("查看采购订单")])],1),a("div",{staticClass:"search_container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"采购组织:",size:"mini"}},[e._v(" "+e._s(e.params.company_name)+" ")]),a("el-form-item",{attrs:{label:"单据号:",size:"mini"}},[e._v(" "+e._s(e.params.order_sn)+" ")]),a("el-form-item",{attrs:{label:"来源单号:",size:"mini"}},[e._v(" "+e._s(e.params.plan_sn)+" ")]),a("el-form-item",{attrs:{label:"业务日期:",size:"mini"}},[e._v(" "+e._s(e.params.business_time)+" ")]),a("el-form-item",{attrs:{label:"供应商(厂家):",size:"mini"}},[e._v(" "+e._s(e.params.supplier_name)+" ")]),a("el-form-item",{attrs:{label:"采购仓库:",size:"mini"}},[e._v(" "+e._s(e.params.warehouse_name)+" ")]),a("el-form-item",{attrs:{label:"订单类型:",size:"mini"}},[e._v(" "+e._s(e.params.order_type_name)+" ")]),a("el-form-item",{attrs:{label:"部门:",size:"mini"}},[e._v(" "+e._s(e.params.department_name)+" ")]),a("el-form-item",{attrs:{label:"采购员:",size:"mini"}},[e._v(" "+e._s(e.params.buyer_name)+" ")]),a("el-form-item",{attrs:{label:"支付方式:",size:"mini"}},[e._v(" "+e._s(e.params.pay_method_name)+" ")]),a("el-form-item",{attrs:{label:"付款方式:",size:"mini"}},[e._v(" "+e._s(e.params.receivables_mode_name)+" ")]),a("el-form-item",{attrs:{label:"审核状态:",size:"mini"}},[e._v(" "+e._s(e.params.auditor_status_name)+" ")]),a("el-form-item",{attrs:{label:"备注:",size:"mini"}},[e._v(" "+e._s(e.params.remark)+" ")]),e.is_company_service?a("el-form-item",{attrs:{label:"商城订单号",size:"mini"}},[e._v(" "+e._s(e.params.ec_order_sn)+" ")]):e._e()],1)],1),a("div",{staticClass:"table_container"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableData.goods_list,"summary-method":e.getSummaries,"show-summary":"","max-height":"600"}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"index",label:"序号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_id",label:"商品编号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_name",label:"商品名称","min-width":"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.goods_name))])]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"factory_code",label:"工厂代码",width:"100"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_num",label:"数量",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"purchase_price",label:"采购价",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("priceFormat")(t.row.purchase_price))+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"subtotal_price",label:"小计金额",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("priceFormat")(t.row.subtotal_price))+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"remark",label:"备注"}})],1)],1),e.params.ec_order_id?a("div",[a("ul",{staticClass:"Logistics"},[a("li",[a("span",[e._v("收货信息:")]),e._v(e._s(e.activities.reciver_info||""))]),a("li",[a("span",[e._v("物流公司:")]),e._v(e._s(e.activities.shipping_express_name||""))]),a("li",[a("span",[e._v("物流单号:")]),e._v(e._s(e.activities.shipping_code||""))])]),a("el-timeline",{attrs:{reverse:e.reverse}},e._l(e.activities.list,(function(t,r){return a("el-timeline-item",{key:r,attrs:{timestamp:t.time}},[e._v(" "+e._s(t.context)+" ")])})),1)],1):e._e(),a("div",{staticClass:"refundauditFoot"},[a("div",{staticStyle:{"text-align":"left"}},[e._v(" 使用返利: "+e._s(e.params.rebate_price)+"     余额："+e._s(e.params.rebate_balance)+" ")]),a("span",[e._v("创建人："+e._s(e.params.add_user_name))]),a("span",[e._v("创建时间："+e._s(e.params.add_time))]),a("span",[e._v("审核人："+e._s(e.params.auditor_name))]),a("span",[e._v("审核时间："+e._s(e.params.auditor_time))]),a("span",[e._v("修改人："+e._s(e.params.update_user_name))]),a("span",[e._v("修改时间："+e._s(e.params.update_time))])]),a("p",{staticStyle:{"text-align":"center","padding-top":"30px"}},[1==e.params.auditor_status?[1==e.authority.b_pass?a("el-button",{attrs:{type:"primary"},on:{click:e.examineFun}},[e._v("审 核")]):e._e(),1==e.authority.b_invalid?a("el-button",{on:{click:e.abolishFun}},[e._v("作 废")]):e._e()]:e._e(),a("el-button",{on:{click:e.goBack}},[e._v("返 回")])],2)],1)},i=[],s=a("5530"),o=(a("d3b7"),a("159b"),a("d81d"),a("a9e3"),a("ac1f"),a("5319"),a("25f0"),a("b680"),a("2f62")),n=a("cf50"),l={name:"purchaseOrderSee",mixins:[n["a"]],data:function(){return{authority:{},TableData:{},chaid:!1,Logistics:{},reverse:!0,activities:{},params:{}}},computed:Object(s["a"])({},Object(o["c"])(["orderSeeGet"])),methods:Object(s["a"])(Object(s["a"])({},Object(o["b"])(["orderIndexACT"])),{},{goBack:function(){this.$router.push({path:"/purchase/order"})},getLogInfo:function(e){var t=this;this.$axMethod.getLogisticsInfo({ec_order_id:e}).then((function(e){t.activities=e.data.data}))},examineFun:function(){var e=this;this.$axios({method:"post",url:this.$api.orderAuditorOrder,data:{order_id:this.order_id}}).then((function(t){200==t.data.code&&(e.$message({message:t.data.data,type:"success"}),e.goBack())}))},closeF:function(){var e=this;this.$axMethod.closePurchaseOrder({order_id:this.order_id}).then((function(t){200==t.data.code&&(e.$message({message:t.data.data,type:"success"}),e.goBack())}))},abolishFun:function(){var e=this;this.$axios({method:"post",url:this.$api.orderAuditorInvalid,data:{order_id:this.orderSeeGet.order_id}}).then((function(t){200==t.data.code&&(e.$message({message:t.data.data,type:"success"}),e.goBack())}))},getSummaries:function(e){var t=e.columns,a=e.data,r=[];return t.forEach((function(e,t){if(0!==t){var i=a.map((function(t){return Number(t[e.property])}));i.every((function(e){return isNaN(e)}))?r[t]="":(r[t]=i.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),r[t]=4==t?parseFloat(r[t]):6==t?parseFloat(r[t]).toFixed(2).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):"")}else r[t]="总计"})),r}}),mounted:function(){var e=this;this.authority=JSON.parse(localStorage.getItem("authority")),this.order_id=this.orderSeeGet.order_id,this.$axios({method:"get",url:this.$api.getOrderInfoPurchase,params:{order_id:this.order_id}}).then((function(t){200==t.data.code&&(e.TableData=t.data.data,e.params=t.data.data.info,e.getRebatePrice(),e.params.ec_order_id&&e.getLogInfo(e.params.ec_order_id))}))}},d=l,c=(a("1b7d"),a("2877")),u=Object(c["a"])(d,r,i,!1,null,"0678cf2f",null);t["default"]=u.exports},"1b7d":function(e,t,a){"use strict";a("e0a1")},5319:function(e,t,a){"use strict";var r=a("2ba4"),i=a("c65b"),s=a("e330"),o=a("d784"),n=a("d039"),l=a("825a"),d=a("1626"),c=a("5926"),u=a("50c4"),m=a("577e"),p=a("1d80"),_=a("8aa5"),f=a("dc4a"),h=a("0cb2"),b=a("14c3"),v=a("b622"),g=v("replace"),y=Math.max,w=Math.min,$=s([].concat),x=s([].push),k=s("".indexOf),S=s("".slice),O=function(e){return void 0===e?e:String(e)},I=function(){return"$0"==="a".replace(/./,"$0")}(),z=function(){return!!/./[g]&&""===/./[g]("a","$0")}(),F=!n((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));o("replace",(function(e,t,a){var s=z?"$":"$0";return[function(e,a){var r=p(this),s=void 0==e?void 0:f(e,g);return s?i(s,e,r,a):i(t,m(r),e,a)},function(e,i){var o=l(this),n=m(e);if("string"==typeof i&&-1===k(i,s)&&-1===k(i,"$<")){var p=a(t,o,n,i);if(p.done)return p.value}var f=d(i);f||(i=m(i));var v=o.global;if(v){var g=o.unicode;o.lastIndex=0}var I=[];while(1){var z=b(o,n);if(null===z)break;if(x(I,z),!v)break;var F=m(z[0]);""===F&&(o.lastIndex=_(n,u(o.lastIndex),g))}for(var N="",C=0,j=0;j<I.length;j++){z=I[j];for(var M=m(z[0]),A=y(w(c(z.index),n.length),0),T=[],E=1;E<z.length;E++)x(T,O(z[E]));var P=z.groups;if(f){var B=$([M],T,A,n);void 0!==P&&x(B,P);var D=m(r(i,void 0,B))}else D=h(M,n,A,T,P,i);A>=C&&(N+=S(n,C,A)+D,C=A+M.length)}return N+S(n,C)}]}),!F||!I||z)},b680:function(e,t,a){"use strict";var r=a("23e7"),i=a("da84"),s=a("e330"),o=a("5926"),n=a("408a"),l=a("1148"),d=a("d039"),c=i.RangeError,u=i.String,m=Math.floor,p=s(l),_=s("".slice),f=s(1..toFixed),h=function(e,t,a){return 0===t?a:t%2===1?h(e,t-1,a*e):h(e*e,t/2,a)},b=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},v=function(e,t,a){var r=-1,i=a;while(++r<6)i+=t*e[r],e[r]=i%1e7,i=m(i/1e7)},g=function(e,t){var a=6,r=0;while(--a>=0)r+=e[a],e[a]=m(r/t),r=r%t*1e7},y=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var r=u(e[t]);a=""===a?r:a+p("0",7-r.length)+r}return a},w=d((function(){return"0.000"!==f(8e-5,3)||"1"!==f(.9,0)||"1.25"!==f(1.255,2)||"1000000000000000128"!==f(0xde0b6b3a7640080,0)}))||!d((function(){f({})}));r({target:"Number",proto:!0,forced:w},{toFixed:function(e){var t,a,r,i,s=n(this),l=o(e),d=[0,0,0,0,0,0],m="",f="0";if(l<0||l>20)throw c("Incorrect fraction digits");if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return u(s);if(s<0&&(m="-",s=-s),s>1e-21)if(t=b(s*h(2,69,1))-69,a=t<0?s*h(2,-t,1):s/h(2,t,1),a*=4503599627370496,t=52-t,t>0){v(d,0,a),r=l;while(r>=7)v(d,1e7,0),r-=7;v(d,h(10,r,1),0),r=t-1;while(r>=23)g(d,1<<23),r-=23;g(d,1<<r),v(d,1,1),g(d,2),f=y(d)}else v(d,0,a),v(d,1<<-t,0),f=y(d)+p("0",l);return l>0?(i=f.length,f=m+(i<=l?"0."+p("0",l-i)+f:_(f,0,i-l)+"."+_(f,i-l))):f=m+f,f}})},cf50:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("5530"),i=(a("d3b7"),a("159b"),a("b64b"),a("a9e3"),a("d81d"),a("2f62")),s=a("65b0"),o={data:function(){return{}},activated:function(){var e=this.$route.params;e.transferType&&this.portStockEarlyWarningChangeOrderInfo(e)},methods:Object(r["a"])(Object(r["a"])({},Object(i["b"])(["salesorderAdd"])),{},{getRebatePrice:function(){var e=this;this.params.supplier_id&&this.params.company_id&&this.$axMethod.getRebatePrice({brand_id:-1,supplier_id:this.params.supplier_id,company_id:this.params.company_id}).then((function(t){var a=t.data;200==a.code&&e.$set(e.params,"rebate_balance",a.data.rebate_balance)}))},turnSaleOrder:function(e){this.salesorderAdd({type:"采购单转销售订单",Buy_order:e,random:Math.floor(1e4*Math.random())}),this.$router.push({path:"/sales/salesorder/salesorderAdd"})},portStockEarlyWarningChangeOrderInfo:function(e){var t=this;this.loading=!0,this.$axMethod.stockEarlyWarningChangeOrderInfo(e.portParams).then((function(a){var r=a.data;if(t.loading=!1,200==r.code){var i=r.data.info,o=r.data.goods_list;switch(Object.keys(i).forEach((function(e){t.$set(t.params,e,i[e])})),t.params.remark=i.abstract,0==t.params.warehouse_id&&(t.params.warehouse_id=""),Number(localStorage.company_id)!=i.company_id?(t.$set(t.params,"department_id",""),t.$set(t.params,"buyer_id","")):t.params.department_id||(t.$set(t.params,"department_id",Number(localStorage.department_id)),t.$set(t.params,"buyer_id",Number(localStorage.employee_id))),Object(s["l"])(t,i),e.transferType){case 1:t.orderAddGet.order_id&&t.orderIndexACT({}),o=o.map((function(e){return e.unit_name&&delete e.unit_name,e.unit_id&&delete e.unit_id,e.remaining_goods_num=e.goods_num,t.handleEdit({row:e,column:{property:"goods_num"}}),e})),t.$refs.xTable._proxy("loadData",o);break;case 2:o=o.map((function(e){e.batch||t.$set(e,"batch",t.getWeek()),t.$set(e,"remaining_goods_num",e.goods_num),e.goods_num&&delete e.goods_num;var a={num:"remaining_goods_num",price:"purchase_price",totalPrice:"subtotal_price"};return t.$publicFution.computeTotal(e,a,"remaining_goods_num",t),e})),t.tableData=o;break}}})).catch((function(e){console.log(e),t.loading=!1,t.$message({type:"error",message:"转单失败请重试"})}))}})}},e0a1:function(e,t,a){}}]);
//# sourceMappingURL=chunk-2f3ed2d4.9d6447ce.js.map