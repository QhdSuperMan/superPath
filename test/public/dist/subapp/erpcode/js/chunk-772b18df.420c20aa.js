(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-772b18df"],{"1da4":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.headScreenStart,expression:"headScreenStart"}],staticStyle:{"border-bottom":"1px dashed #e5e5e5"}},[a("div",{staticClass:"search_container",staticStyle:{display:"inline-block"}},[a("el-form",{ref:"TableDataRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-radio-group",{staticClass:"groupDate",staticStyle:{"margin-left":"33px"},on:{change:e.change},model:{value:e.params.is_cycle,callback:function(t){e.$set(e.params,"is_cycle",t)},expression:"params.is_cycle"}},[a("el-radio",{attrs:{label:0}},[a("el-form-item",{staticClass:"timeValue",attrs:{prop:"timeValue",label:"业务日期",rules:e.block?{}:e.rules.timeValue}},[a("el-date-picker",{ref:"rqdata",attrs:{disabled:e.block,size:"mini","value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.business},model:{value:e.params.timeValue,callback:function(t){e.$set(e.params,"timeValue",t)},expression:"params.timeValue"}})],1)],1),a("el-radio",{attrs:{label:1}},[a("el-form-item",{staticClass:"valueFormats",attrs:{prop:"period",label:"毛利增长率分析周期",rules:e.block?e.rules.timeValue:{}}},[e._l(e.buttonText,(function(t,r){return a("el-button",{key:r,class:{activeTab:r===e.tabtton},staticStyle:{width:"auto"},attrs:{size:"mini",disabled:!e.block},on:{click:function(t){return e.buttonCLICK(r)}}},[e._v(e._s(t))])})),a("el-date-picker",{attrs:{size:"mini",disabled:!e.block,type:e.montsted.period,"value-format":"yyyy-MM-dd",format:e.montsted.formats,"picker-options":e.pickerOptions,placeholder:e.montsted.place},model:{value:e.params.period,callback:function(t){e.$set(e.params,"period",t)},expression:"params.period"}})],2)],1)],1),a("el-form-item",{attrs:{label:"单据状态",size:"mini",rules:e.rules.auditor_status,prop:"auditor_status"}},[a("el-select",{attrs:{clearable:""},model:{value:e.params.auditor_status,callback:function(t){e.$set(e.params,"auditor_status",t)},expression:"params.auditor_status"}},[a("el-option",{attrs:{label:"全部",value:0}},[e._v("全部")]),a("el-option",{attrs:{label:"未审核",value:1}},[e._v("未审核")]),a("el-option",{attrs:{label:"已审核",value:2}},[e._v("已审核")])],1)],1),a("el-form-item",{attrs:{label:"销售组织",size:"mini",prop:"company_id"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{focus:e.getCompany,change:e.companyChangeId},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"审核日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.auditValue,callback:function(t){e.auditValue=t},expression:"auditValue"}})],1),a("el-form-item",{attrs:{label:"业务类型",size:"mini"}},[a("el-select",{attrs:{"collapse-tags":"",multiple:"",placeholder:"请选择"},on:{change:e.changebusiness},model:{value:e.business_type,callback:function(t){e.business_type=t},expression:"business_type"}},e._l(e.businessTypeList.options,(function(e){return a("el-option",{key:e.business_type_id,attrs:{label:e.business_type_name,value:e.business_type_id}})})),1)],1),a("el-form-item",{attrs:{label:"仓库名称",size:"mini"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},on:{focus:e.warehouseInvok,change:e.warehouseChangeId},model:{value:e.params.warehouse_id,callback:function(t){e.$set(e.params,"warehouse_id",t)},expression:"params.warehouse_id"}},e._l(e.warehouseList,(function(e){return a("el-option",{key:e.warehouse_id,attrs:{label:e.warehouse_name,value:e.warehouse_id}})})),1)],1),a("el-form-item",{attrs:{label:"货位名称",size:"mini"}},[a("el-select",{attrs:{filterable:"",remote:"",clearable:"",placeholder:"请输入"},on:{focus:e.InventoryInvok},model:{value:e.params.allocation_id,callback:function(t){e.$set(e.params,"allocation_id",t)},expression:"params.allocation_id"}},e._l(e.allocationInventoryList,(function(e){return a("el-option",{key:e.allocation_id,attrs:{label:e.allocation_name,value:e.allocation_id}})})),1)],1),a("el-form-item",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.onSearch("TableDataRef")}}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1)]),1==e.authority.b_export&&e.contain?a("div",{staticClass:"add_delet"},[a("el-dropdown",{attrs:{placement:"bottom-start"}},[a("span",{staticStyle:{cursor:"pointer",color:"#4e90e2"},attrs:{"split-button":""}},[a("el-button",{attrs:{plain:"",icon:"iconfont icon-daochu10",size:"mini"}},[e._v("导出")])],1),a("el-dropdown-menu",{staticStyle:{"margin-top":"10px"},attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(1)}}},[e._v("导出Excel文件")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(2)}}},[e._v("导出CSV逗号分隔")])],1)],1)],1):e._e(),a("ul",{staticClass:"sliButton"},e._l(e.tabTitle,(function(t,r){return a("li",{key:r,class:{activeTab:r==e.tabIndex},on:{click:function(a){return e.changeItem(r,t)}}},[e._v(e._s(t))])})),0),e.iframeStart?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.iframeLoading,expression:"iframeLoading"}]},[e._m(0)]):e._e(),e.contain?a("div",{staticClass:"table_container"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading1,expression:"loading1"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableData.data,"max-height":"450","summary-method":e.getSummaries,"show-summary":""}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:e.Name.proName,width:"200",label:e.Name.labelName}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"return_goods_num",width:"150",align:"right",label:"数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"subtotal_price",align:"right",width:"150",label:"销售金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(function(){t.row.subtotal_price=Number(t.row.subtotal_price),t.row["orderSubtotalPrice"+t.$index]=t.row.subtotal_price}())+" "+e._s(e._f("priceFormatNone")(t.row["orderSubtotalPrice"+t.$index]))+" ")]}}],null,!1,2105061285)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"cost_price",width:"150",align:"right",label:"成本金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(function(){t.row.cost_price=Number(t.row.cost_price),t.row["orderCostPrice"+t.$index]=t.row.cost_price}())+" "+e._s(e._f("priceFormatNone")(t.row["orderCostPrice"+t.$index]))+" ")]}}],null,!1,4225348104)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"gross_profit",width:"150",align:"right",label:"毛利金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(function(){t.row.gross_profit=Number(t.row.gross_profit),t.row["orderGrossProfit"+t.$index]=t.row.gross_profit}())+" "+e._s(e._f("priceFormatNone")(t.row["orderGrossProfit"+t.$index]))+" ")]}}],null,!1,3369776162)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"gross_profit_rate",width:"200",align:"right",label:"毛利率"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(function(){t.row["ordergrossProfitRate"+t.$index]=t.row.gross_profit_rate}())+" "+e._s(t.row["ordergrossProfitRate"+t.$index]+"%")+" ")]}}],null,!1,1149332488)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"ring_ratio_growth_rate",width:"160",align:"right",label:"毛利环比增长率"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"year_on_year_growth_rate",width:"160",align:"right",label:"毛利同比增长率"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"net_income",width:"100",align:"right",label:"净收入"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"net_gross_profit",width:"120",align:"right",label:"净毛利"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,sortable:"",property:"net_gross_profit_margin",width:"100",align:"right",label:"净毛利率"}})],1),e.TableData.desc?a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:12}},[a("div",[e._v("业务起始时间:"+e._s(e.TableData.desc.start_time))])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"textAr"},[e._v("业务截止时间:"+e._s(e.TableData.desc.end_time))])])],1):e._e(),e.TableData.desc?a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:12}},[a("div",[e._v("生成时间:"+e._s(e.TableData.desc.search_time))])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"textAr"},[e._v("制表人:"+e._s(e.TableData.desc.make_user))])])],1):e._e()],1):e._e()])},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("iframe",{staticStyle:{height:"90vh",width:"100%"},attrs:{src:e.src,d:"ifra",frameborder:"no",border:"0",marginWidth:"0",marginHeight:"0"},on:{load:e.test}})}],s=(a("a15b"),a("d3b7"),a("159b"),a("a9e3"),a("fb6a"),a("d81d"),a("65b0")),o={name:"reportSalesmulrpt",data:function(){var e=this;return{authority:{},loading:!0,src:"",iframeLoading:!0,iframeStart:!1,businessTypeList:{options:[]},business_type:null,headScreenStart:!0,tabtton:0,block:!1,buttonText:["按月度","按年度"],tabTitle:["按组织统计","按部门统计","按业务员统计","按客户统计","按客户分类统计","按品牌统计","按商品统计","按地区统计"],contain:!1,TableData:{data:[]},pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"一季度",onClick:function(t){e.tabtton="",e.params.cycle_type=2;var a=new Date,r=a.getYear();r+=r<2e3?1900:0;var i=r+"-01-01";t.$emit("pick",i)}},{text:"二季度",onClick:function(t){e.tabtton="",e.params.cycle_type=2;var a=new Date,r=a.getYear();r+=r<2e3?1900:0;var i=r+"-04-01";t.$emit("pick",i)}},{text:"三季度",onClick:function(t){e.tabtton="",e.params.cycle_type=2;var a=new Date,r=a.getYear();r+=r<2e3?1900:0;var i=r+"-07-01";t.$emit("pick",i)}},{text:"四季度",onClick:function(t){e.tabtton="",e.params.cycle_type=2;var a=new Date,r=a.getYear();r+=r<2e3?1900:0;var i=r+"-10-01";t.$emit("pick",i)}}]},business:{shortcuts:[{text:"本周",onClick:function(e){var t=new Date,a=t.getDay(),r=new Date,i=new Date;i.setTime(i.getTime()-864e5*(a-1)),e.$emit("pick",[i,r])}},{text:"本月",onClick:function(e){var t=new Date,a=t.getMonth(),r=t.getYear();r+=r<2e3?1900:0;var i=new Date(r,a,1),s=i.getFullYear(),o=i.getMonth()+1,l=i.getDate();o<10&&(o="0"+o),l<10&&(l="0"+l);var n=s+"-"+o+"-"+l,c=new Date(r,a+1,1),p=(c-i)/864e5,m=new Date(r,a,p),d=m.getMonth()+1,u=m.getDate();d<10&&(d="0"+d),u<10&&(u="0"+u);var h=s+"-"+d+"-"+u;e.$emit("pick",[n,h])}},{text:"上周",onClick:function(e){var t=new Date,a=t.getDay(),r=new Date,i=new Date;i.setTime(i.getTime()-864e5*(7+a-1)),r.setTime(r.getTime()-864e5*a),e.$emit("pick",[i,r])}},{text:"上月",onClick:function(e){var t=new Date,a=t.getYear();a+=a<2e3?1900:0;var r=t.getMonth(),i=t.getMonth()-1,s=new Date(a,i+1,1),o=new Date(a,i,1),l=(s-o)/864e5,n=a+"-"+r+"-1",c=a+"-"+r+"-"+l;e.$emit("pick",[n,c])}}]},tabIndex:0,state:!0,roleid:"",Name:{labelName:"销售组织",proName:"company_name"},params:{is_cycle:0,cycle_type:1,statistical_type:0,auditor_status:2},timeValue:[(new Date).setTime((new Date).getTime()-2592e6),new Date],auditValue:null,companyList:[],montsted:{period:"month",formats:"yyyy-MM-dd",place:"请选择月份"}}},methods:{changebusiness:function(e){this.params.business_type_ids=e.join(",")},test:function(){this.iframeLoading=!1},changeItem:function(e,t){switch(this.headScreenStart=!0,this.tabIndex=e,this.iframeStart=!1,this.iframeLoading=!0,this.params.statistical_type=e,e){case 0:this.Name={labelName:"销售组织",proName:"company_name"};break;case 1:this.Name={labelName:"部门",proName:"department_name"};break;case 2:this.Name={labelName:"业务员",proName:"business_name"};break;case 3:this.Name={labelName:"客户名称",proName:"customer_name"};break;case 4:this.Name={labelName:"客户级别",proName:"customer_type_name"};break;case 5:this.Name={labelName:"品牌名称",proName:"brand_name"};break;case 6:this.Name={labelName:"商品名称",proName:"goods_name"};break;default:break}if(7==e){this.roleid=localStorage.getItem("role_id");var a={"gyl.taijierp.com":"https://report.jybd.cn/webroot/decision/view/report?viewlet=ERP%252F%25E9%2594%2580%25E5%2594%25AE%25E6%25AF%259B%25E5%2588%25A9%25E5%25A4%259A%25E7%25BB%25B4%25E7%25BB%259F%25E8%25AE%25A1%25E8%25A1%25A8-%25E5%258C%25BA%25E5%259F%259F_gyl.cpt&role=","cloud.taijierp.com":"https://report.jybd.cn/webroot/decision/view/report?viewlet=ERP%252F%25E9%2594%2580%25E5%2594%25AE%25E6%25AF%259B%25E5%2588%25A9%25E5%25A4%259A%25E7%25BB%25B4%25E7%25BB%259F%25E8%25AE%25A1%25E8%25A1%25A8-%25E5%258C%25BA%25E5%259F%259F_cloud.cpt&role=","scm.taijierp.com":"https://report.jybd.cn/webroot/decision/view/report?viewlet=ERP%252F%25E9%2594%2580%25E5%2594%25AE%25E6%25AF%259B%25E5%2588%25A9%25E5%25A4%259A%25E7%25BB%25B4%25E7%25BB%259F%25E8%25AE%25A1%25E8%25A1%25A8-%25E5%258C%25BA%25E5%259F%259F_scm.cpt&role=","xltd.taijierp.com":"https://report.jybd.cn/webroot/decision/view/report?viewlet=ERP%252F%25E9%2594%2580%25E5%2594%25AE%25E6%25AF%259B%25E5%2588%25A9%25E5%25A4%259A%25E7%25BB%25B4%25E7%25BB%259F%25E8%25AE%25A1%25E8%25A1%25A8-%25E5%258C%25BA%25E5%259F%259F_xltd.cpt&role=","xinliantongda.taijierp.com":"https://report.jybd.cn/webroot/decision/view/report?viewlet=ERP%252F%25E9%2594%2580%25E5%2594%25AE%25E6%25AF%259B%25E5%2588%25A9%25E5%25A4%259A%25E7%25BB%25B4%25E7%25BB%259F%25E8%25AE%25A1%25E8%25A1%25A8-%25E5%258C%25BA%25E5%259F%259F_xltd.cpt&role=","192.168.11.174":"https://report.jybd.cn/webroot/decision/view/report?viewlet=ERP%252F%25E9%2594%2580%25E5%2594%25AE%25E6%25AF%259B%25E5%2588%25A9%25E5%25A4%259A%25E7%25BB%25B4%25E7%25BB%259F%25E8%25AE%25A1%25E8%25A1%25A8-%25E5%258C%25BA%25E5%259F%259F_t.cpt&role=","test-www.taijierp.com":"https://report.jybd.cn/webroot/decision/view/report?viewlet=ERP%252F%25E9%2594%2580%25E5%2594%25AE%25E6%25AF%259B%25E5%2588%25A9%25E5%25A4%259A%25E7%25BB%25B4%25E7%25BB%259F%25E8%25AE%25A1%25E8%25A1%25A8-%25E5%258C%25BA%25E5%259F%259F_t.cpt&role="};this.src=a[location.hostname]+this.roleid,this.headScreenStart=!1,this.contain=!1,this.iframeStart=!0}else this.onSearch("TableDataRef");this.params.statistical_type=e},change:function(e){1==e?(this.$set(this.params,"timeValue",""),this.$set(this.params,"cycle_type",1),this.block=!0):(this.$set(this.params,"period",""),this.block=!1)},companyChangeId:function(e){this.$set(this.params,"warehouse_id",""),this.$set(this.params,"allocation_id","")},warehouseChangeId:function(e){this.$set(this.params,"allocation_id","")},buttonCLICK:function(e){this.tabtton=e,0==e?this.monthStar():this.yearStar()},exportOrder:function(e){if(0==this.listShow)return this.$message({message:"请查询需要导出的数据",type:"error"}),!1;Object.assign(this.params,{export_type:e}),this.$axMethod.exportSalesProfitStatisticsUrl(this.params).then((function(e){200==e.data.code&&(window.location.href=e.data.data.url)}))},onSearch:function(e){var t=this;this.$refs[e].validate((function(e){if(e){if(t.state=!0,0==t.params.statistical_type?(t.$set(t.params,"company_id",""),t.$set(t.params,"company_name","")):0===t.tabIndex||t.params.company_id||(t.$message({message:"请选择销售组织",type:"error"}),t.state=!1),!t.state)return t.TableData.data=[],!1;if(t.auditValue?(t.params.auditor_start_time=t.auditValue[0],t.params.auditor_end_time=t.auditValue[1]):t.params.auditor_start_time=t.params.auditor_end_time="",0==t.params.is_cycle&&2==t.params.timeValue.length)t.params.start_time=t.params.timeValue[0],t.params.end_time=t.params.timeValue[1];else if(1==t.params.is_cycle){if(t.params.period||(t.$message({message:"请选择开始时间",type:"error"}),t.state=!1),delete t.params.end_time,t.params.start_time=t.params.period,!t.state)return t.TableData.data=[],!1}else delete t.params.end_time,delete t.params.start_time;t.contain=!0,t.$axios({method:"get",url:t.$api.getSalesProfitStatisticsV2,params:t.$publicFution.deepCopy(t.params)}).then((function(e){200==e.data.code&&(t.TableData=e.data.data,t.TableData.data.forEach((function(e){e.gross_profit_rate=Number(e.gross_profit_rate.slice(0,-1))})),t.loading=!1)}))}}))},onReset:function(){this.auditValue=[],this.business_type=null,this.block=!1,this.$set(this,"params",{is_cycle:0,cycle_type:1,statistical_type:0}),this.tabIndex=0,this.params.statistical_type=0,this.Name={labelName:"销售组织",proName:"company_name"},this.tabtton=0,this.params.is_cycle=0,this.contain=!1},getSummaries:function(e){var t=this,a=e.columns,r=e.data,i=[];return a.forEach((function(e,a){if(0!==a)if(5!==a)if(6!==a)if(7!==a){var s=r.map((function(t){return Number(t[e.property])}));s.every((function(e){return isNaN(e)}))?i[a]="":(i[a]=s.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),i[a]=1==a?t.TableData.desc.return_goods_num:2===a?t.TableData.desc.subtotal_price:3===a?t.TableData.desc.cost_price:4===a?t.TableData.desc.gross_profit:"")}else i[a]=t.TableData.desc?t.TableData.desc.year_on_year_growth_rate:"";else i[a]=t.TableData.desc?t.TableData.desc.ring_ratio_growth_rate:"";else i[a]=t.TableData.desc?t.TableData.desc.gross_profit_rate:"";else i[a]="本页总计"})),i},monthStar:function(){this.authority=JSON.parse(localStorage.getItem("authority")),this.$set(this,"montsted",{period:"month",formats:"yyyy-MM-dd",place:"请选择月份"}),this.params.cycle_type=1},yearStar:function(){this.$set(this,"montsted",{period:"year",formats:"yyyy-MM-dd",place:"请选择年"}),this.params.cycle_type=3},getCompany:function(){Object(s["e"])(this)},formData:function(e){var t=new Date(e),a=""+(t.getMonth()+1),r=""+t.getDate(),i=t.getFullYear();return a.length<2&&(a="0"+a),r.length<2&&(r="0"+r),[i,a,r].join("-")}},mounted:function(){this.authority=JSON.parse(localStorage.getItem("authority")),this.$common.options("businessTypeListOption",this.businessTypeList),this.params.start_time=this.formData(this.timeValue[0]),this.params.end_time=this.formData(this.timeValue[1]),this.$set(this,"params",{is_cycle:0,company_id:Number(localStorage.company_id),company_name:localStorage.company_name,timeValue:[this.params.start_time,this.params.end_time],start_time:this.formData(this.timeValue[0]),end_time:this.formData(this.timeValue[1]),auditor_status:2}),Object(s["l"])(this,localStorage)}},l=o,n=(a("9caf"),a("b45f"),a("2877")),c=Object(n["a"])(l,r,i,!1,null,"7c8f583f",null);t["default"]=c.exports},"9caf":function(e,t,a){"use strict";a("fa98")},b45f:function(e,t,a){"use strict";a("bb09")},bb09:function(e,t,a){},fa98:function(e,t,a){}}]);
//# sourceMappingURL=chunk-772b18df.420c20aa.js.map