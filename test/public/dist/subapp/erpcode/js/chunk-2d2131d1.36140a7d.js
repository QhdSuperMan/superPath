(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-2d2131d1"],{aafa:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search_container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"销售组织",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},model:{value:e.formInline.company_id,callback:function(t){e.$set(e.formInline,"company_id",t)},expression:"formInline.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"客户名称",size:"mini"}},[a("el-input",{model:{value:e.formInline.customer_name,callback:function(t){e.$set(e.formInline,"customer_name",t)},expression:"formInline.customer_name"}})],1),a("el-form-item",{attrs:{label:"业务员",size:"mini"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:""},model:{value:e.formInline.employee_name,callback:function(t){e.$set(e.formInline,"employee_name",t)},expression:"formInline.employee_name"}},e._l(e.employeeList.options,(function(e){return a("el-option",{key:e.employee_id,attrs:{label:e.employee_name,value:e.employee_name}})})),1)],1),a("el-form-item",{attrs:{label:"业务员手机号码","label-width":"130",size:"mini"}},[a("el-input",{model:{value:e.formInline.mobile,callback:function(t){e.$set(e.formInline,"mobile",t)},expression:"formInline.mobile"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"add_delet"},[a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:e.addFun}},[e._v("新增")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.untieFun}},[e._v("解绑")])],1),a("div",{staticClass:"table_container"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableData.tableData,"max-height":"600"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"selection",fixed:"left",align:"center",width:"44"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"company_name",label:"销售组织"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"employee_name",label:"业务员名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"mobile",label:"业务员手机号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"customer_name",label:"客户名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"province_name",label:"客户区域"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.province_name)+" "+e._s(t.row.city_name)+" "+e._s(t.row.area_name)+" ")]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"customer_mobile",label:"客户手机号"}})],1)],1),a("div",{staticClass:"page_container"},[a("div",{staticClass:"pageNumber"},[e._v("每页显示")]),a("el-pagination",{staticClass:"erp-pagination",attrs:{"current-page":e.goPage,"page-size":e.pageSize1,"page-sizes":e.per_page,layout:"total,sizes, prev, pager, next,jumper",prevText:"上一页",nextText:"下一页",total:e.TableData.total},on:{"size-change":e.handleSizeChange,"update:currentPage":function(t){e.goPage=t},"update:current-page":function(t){e.goPage=t},"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{"close-on-click-modal":!1,title:"添加绑定关系",center:"",visible:e.dialogFormVisible,width:"1030px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){return e.closeDialog("ruleForm")}}},[a("el-form",{ref:"ruleForm",staticClass:"dialogForm",attrs:{inline:!0,model:e.ruleForm}},[a("el-form-item",{attrs:{label:"采购组织",size:"mini",prop:"company_id",rules:e.rules.company_id}},[a("el-select",{attrs:{clearable:"",filterable:""},on:{change:function(t){return e.companyChange(e.ruleForm.company_id,"ruleForm")}},model:{value:e.ruleForm.company_id,callback:function(t){e.$set(e.ruleForm,"company_id",t)},expression:"ruleForm.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id,disabled:0==t.is_choose}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"部门",size:"mini",prop:"department_id",rules:e.rules.department_id}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{change:function(t){return e.departmentChange(e.ruleForm.department_id,"ruleForm")}},model:{value:e.ruleForm.department_id,callback:function(t){e.$set(e.ruleForm,"department_id",t)},expression:"ruleForm.department_id"}},e._l(e.departmentList.options,(function(e){return a("el-option",{key:e.department_id,attrs:{label:e.department_name,value:e.department_id}})})),1)],1),a("el-form-item",{attrs:{label:"业务员",size:"mini",prop:"employee_id",rules:e.rules.business_id}},[a("el-select",{attrs:{clearable:"",placeholder:""},model:{value:e.ruleForm.employee_id,callback:function(t){e.$set(e.ruleForm,"employee_id",t)},expression:"ruleForm.employee_id"}},e._l(e.employeeList.options,(function(e){return a("el-option",{key:e.employee_id,attrs:{label:e.employee_name,value:e.employee_id}})})),1)],1),a("br"),a("el-form-item",{attrs:{label:"省",size:"mini",prop:"province_id",rules:[{required:!0,message:"请选择所属省",trigger:"change"}]}},[a("el-select",{staticClass:"shortSearchInput",attrs:{clearable:"",placeholder:""},on:{change:e.changeProvince},model:{value:e.ruleForm.province_id,callback:function(t){e.$set(e.ruleForm,"province_id",t)},expression:"ruleForm.province_id"}},e._l(e.province.options,(function(e){return a("el-option",{key:e.area_id,attrs:{label:e.area_name,value:e.area_id}})})),1)],1),a("el-form-item",{attrs:{label:"市",size:"mini"}},[a("el-select",{staticClass:"shortSearchInput",attrs:{clearable:""},on:{change:e.changeCity},model:{value:e.ruleForm.city_id,callback:function(t){e.$set(e.ruleForm,"city_id",t)},expression:"ruleForm.city_id"}},e._l(e.city.options,(function(e){return a("el-option",{key:e.area_id,attrs:{label:e.area_name,value:e.area_id}})})),1)],1),a("el-form-item",{attrs:{label:"县",size:"mini"}},[a("el-select",{staticClass:"shortSearchInput",attrs:{clearable:"",placeholder:""},model:{value:e.ruleForm.area_id,callback:function(t){e.$set(e.ruleForm,"area_id",t)},expression:"ruleForm.area_id"}},e._l(e.area.options,(function(e){return a("el-option",{key:e.area_id,attrs:{label:e.area_name,value:e.area_id}})})),1)],1),a("el-form-item",{attrs:{label:"客户名称",size:"mini"}},[a("el-input",{model:{value:e.ruleForm.customer_name,callback:function(t){e.$set(e.ruleForm,"customer_name",t)},expression:"ruleForm.customer_name"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onUntieSearch}},[e._v("查询")])],1)],1),a("div",[a("el-transfer",{attrs:{props:{key:"customer_id",label:"customer_name"},titles:["待绑定","已绑定"],data:e.untieData},model:{value:e.untieValue,callback:function(t){e.untieValue=t},expression:"untieValue"}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dialogFormsubmit("ruleForm")}}},[e._v("确 定")])],1)],1)],1)},o=[],l=(a("d3b7"),a("25f0"),a("a9e3"),a("65b0")),n={name:"customeCustomersaleman",data:function(){return{authority:{},formInline:{},formInlineParams:{},employeeList:{options:[]},companyList:[],departmentList:{options:[]},province:{options:[]},city:{options:[]},area:{options:[]},TableData:{tableData:[],per_page:[30,50,100,500],total:10},per_page:[30,50,100,500],pageSize:30,multipleSelection:[],dialogFormVisible:!1,ruleForm:{is_page:1},goPage:1,untieData:[],untieValue:[]}},methods:{companyChange:function(e,t){Object(l["i"])(this,this[t],1)},departmentChange:function(e,t){Object(l["j"])(this,this[t],1)},onSearch:function(){Object.assign(this.formInlineParams.params,this.formInline,{page:1}),Object(l["g"])(this.formInlineParams)},onReset:function(){this.$set(this,"formInline",{}),this.$set(this,"formInlineParams",{params:{},TableData:this.TableData,API:"getBindList",vm:this}),Object(l["g"])(this.formInlineParams)},addFun:function(){this.dialogFormVisible=!0},untieFun:function(){var e=this;console.log(this.multipleSelection);for(var t=[],a=0;a<this.multipleSelection.length;a++)t.push(this.multipleSelection[a].customer_id);var i=this;i.$axios({method:"post",url:i.$api.unbindEmployee,data:{customer_id:t.toString()}}).then((function(t){200==t.data.code&&(e.$message({message:t.data.data,type:"success"}),e.$common.initData("getBindList",e.TableData,{}))}))},dialogFormsubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a=t;a.$axios({method:"post",url:a.$api.addBindEmployee,data:{employee_id:a.ruleForm.employee_id,company_id:a.ruleForm.company_id,department_id:a.ruleForm.department_id,customer_id:a.untieValue.toString()}}).then((function(e){200==e.data.code&&(t.$message({message:e.data.data,type:"success"}),t.dialogFormVisible=!1,t.$common.initData("getBindList",t.TableData,{company_id:Number(localStorage.company_id)}))}))}}))},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){Object.assign(this.formInlineParams.params,{per_page:e,page:1}),Object(l["g"])(this.formInlineParams)},handleCurrentChange:function(e){Object.assign(this.formInlineParams.params,{page:e}),Object(l["g"])(this.formInlineParams)},changeProvince:function(){this.ruleForm.city_id="",this.$common.options("getAreaListOption",this.city,{level:3,p_id:this.ruleForm.province_id})},changeCity:function(){this.$common.options("getAreaListOption",this.area,{level:4,p_id:this.ruleForm.city_id})},changeCompanyDialog:function(){this.$common.options("getDepartmentListOption",this.department,{company_id:this.ruleForm.company_id})},onUntieSearch:function(){var e=this,t=this;t.$axios({method:"get",url:t.$api.getNoUntieCustomerList,params:t.ruleForm}).then((function(t){200==t.data.code&&(console.log(t.data.data),e.untieData=t.data.data)}))},closeDialog:function(e){this.ruleForm={},this.$refs[e].resetFields()}},mounted:function(){this.$set(this,"formInlineParams",{params:{},TableData:this.TableData,API:"getBindList",vm:this}),Object(l["g"])(this.formInlineParams),this.$common.options("getAreaListOption",this.province,{level:2}),Object(l["e"])(this)}},r=n,s=a("2877"),m=Object(s["a"])(r,i,o,!1,null,"31efef4b",null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-2d2131d1.36140a7d.js.map