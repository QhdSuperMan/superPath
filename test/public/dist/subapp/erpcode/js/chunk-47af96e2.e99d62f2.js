(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-47af96e2"],{"0943":function(e,t,a){},"4cba":function(e,t,a){},"6c20":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("采购管理")]),a("el-breadcrumb-item",[e._v("厂家往来")]),a("el-breadcrumb-item",{staticClass:"attrbute"},[a("span",{on:{click:e.goBack}},[e._v("厂家付款单管理")])]),a("el-breadcrumb-item",[e._v(e._s(e.title)+"付款单")])],1),a("div",{staticClass:"search_container"},[a("el-form",{ref:"params",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"财务组织",size:"mini",prop:"company_id",rules:e.rules.company_id}},[e._v(" "+e._s(function(){0==e.params.company_id&&(e.params.company_id=null)}())+" "),a("el-select",{attrs:{placeholder:"请选择",filterable:"",disabled:e.isDisabled},on:{change:e.companyChange,focus:e.companyListInvok},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"单据号",size:"mini"}},[a("el-input",{attrs:{type:"text",disabled:""},model:{value:e.params.payment_sn,callback:function(t){e.$set(e.params,"payment_sn",t)},expression:"params.payment_sn"}})],1),20002!=e.params.factory_accounts_type_id?a("div",{staticStyle:{display:"inline"}},[a("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini",prop:"supplier_id",rules:[{required:!0,message:"请选择",trigger:"change"}]}},[a("el-select",{attrs:{disabled:e.isDisabled,maxlength:"100","filter-method":e.supplierListInvok,filterable:"",placeholder:"请选择"},on:{focus:e.supplierListInvok,change:function(t){e.getHeXiaoData(),e.getSupplier(t)}},model:{value:e.params.supplier_id,callback:function(t){e.$set(e.params,"supplier_id",t)},expression:"params.supplier_id"}},e._l(e.supplierList,(function(e){return a("el-option",{key:e.supplier_id,attrs:{label:e.supplier_name,value:e.supplier_id}})})),1)],1)],1):e._e(),a("el-form-item",{attrs:{label:"应付余额",size:"mini"}},[a("span",[e._v(e._s(e.params.balance||0))])]),a("el-form-item",{attrs:{label:"联系人",size:"mini"}},[a("span",[e._v(e._s(e.params.principal_name||""))])]),a("el-form-item",{attrs:{label:"联系电话",size:"mini"}},[a("span",[e._v(e._s(e.params.principal_mobile||""))])]),a("el-divider"),a("el-form-item",{attrs:{label:"业务日期",size:"mini",prop:"business_time",rules:e.rules.business_time}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",disabled:e.isDisabled},model:{value:e.params.business_time,callback:function(t){e.$set(e.params,"business_time",t)},expression:"params.business_time"}})],1),a("el-form-item",{attrs:{label:"往来类型",size:"mini",prop:"factory_accounts_type_id",rules:e.rules.factory_accounts_type_id}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"",disabled:e.isDisabled},on:{change:e.accountsTypeChange,focus:e.getFactoryAccountInvok},model:{value:e.params.factory_accounts_type_id,callback:function(t){e.$set(e.params,"factory_accounts_type_id",t)},expression:"params.factory_accounts_type_id"}},e._l(e.factoryAccountsList,(function(e){return a("el-option",{key:e.factory_accounts_type_id,attrs:{label:e.factory_accounts_type_name,value:e.factory_accounts_type_id}})})),1)],1),a("el-form-item",{attrs:{label:"部门",size:"mini"}},[e._v(" "+e._s(function(){0==e.params.department_id&&(e.params.department_id=null)}())+" "),a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",disabled:e.isDisabled},on:{change:e.getHeXiaoData,focus:e.DepartmentListInvok},model:{value:e.params.department_id,callback:function(t){e.$set(e.params,"department_id",t)},expression:"params.department_id"}},e._l(e.departmentList,(function(e){return a("el-option",{key:e.department_id,attrs:{label:e.department_name,value:e.department_id}})})),1)],1),a("el-form-item",{attrs:{label:"业务员",size:"mini"}},[e._v(" "+e._s(function(){0==e.params.business_id&&(e.params.business_id=null)}())+" "),a("el-select",{attrs:{clearable:"",filterable:"",disabled:e.isDisabled},on:{focus:e.EmployeeListInvok,change:e.getHeXiaoData},model:{value:e.params.business_id,callback:function(t){e.$set(e.params,"business_id",t)},expression:"params.business_id"}},e._l(e.employeeList,(function(e){return a("el-option",{key:e.employee_id,attrs:{label:e.employee_name,value:e.employee_id}})})),1)],1),20002==e.params.factory_accounts_type_id?a("div",{staticStyle:{display:"inline"}},[a("el-form-item",{attrs:{label:"物流公司",size:"mini",prop:"logistics_id",rules:e.rules.logistics_id}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",disabled:e.isDisabled},on:{change:e.changeLogistics,focus:e.logisticsInvok},model:{value:e.params.logistics_id,callback:function(t){e.$set(e.params,"logistics_id",t)},expression:"params.logistics_id"}},e._l(e.logisticsList,(function(e){return a("el-option",{key:e.logistics_id,attrs:{label:e.logistics_name,value:e.logistics_id}})})),1)],1)],1):e._e(),a("el-form-item",{attrs:{label:"备注",size:"mini"}},[a("el-input",{attrs:{type:"text",maxlength:"300"},model:{value:e.params.remark,callback:function(t){e.$set(e.params,"remark",t)},expression:"params.remark"}})],1)],1),a("div",{staticClass:"add_delet"},[a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:function(t){return e.addPaymangeFun("params")}}},[e._v("增行")]),a("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:e.delFun}},[e._v("删除")])],1)],1),e._m(0),a("div",{staticClass:"table_container"},[a("el-form",{ref:"formTable",staticClass:"form_table",attrs:{model:e.TableData}},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableData.tableData,"summary-method":e.getSummaries,"show-summary":"","max-height":"600"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"selection",fixed:"left",align:"center",width:"80"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"receivables_mode_id",label:"结算方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticClass:"shortInput",attrs:{clearable:"",loading:e.clearingFormLoading},on:{focus:function(a){e.portGetCollectionList(t,t.$index)},change:function(a){return e.receivables(t.row,t.$index)}},model:{value:t.row.receivables_mode_id,callback:function(a){e.$set(t.row,"receivables_mode_id",a)},expression:"scope.row.receivables_mode_id"}},e._l(t.row.clearingForm,(function(e){return a("el-option",{key:e.receivables_mode_id,attrs:{label:e.receivables_mode_name,value:e.receivables_mode_id}})})),1)]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"bank_id",label:e.banktitle},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(function(){0==t.row.brand_id&&(t.row.brand_id=String(-1))}())+" "),10007!=t.row.receivables_mode_id?a("el-form-item",{staticStyle:{width:"100%"},attrs:{prop:"tableData."+t.$index+".bank_id",rules:[{required:10009==t.row.receivables_mode_id,message:"请选择",trigger:"change"}],size:"mini"}},[a("el-select",{key:"1",staticClass:"shortInput",attrs:{loading:e.bankListLoading,clearable:""},on:{focus:function(a){e.portGetCollectingBankList(t,t.$index)},change:function(a){return e.getBanklist(t.row,t.$index,a)}},model:{value:t.row.bank_id,callback:function(a){e.$set(t.row,"bank_id",a)},expression:"scope.row.bank_id"}},e._l(t.row.bankList,(function(e){return a("el-option",{key:e.bank_id,attrs:{label:e.bank_name,value:e.bank_id}})})),1)],1):a("getBrand",{staticClass:"shortInput",attrs:{fatherParams:t.row},on:{change:function(a){return e.getNum(t.row.brand_id,t.row)}},model:{value:t.row.brand_id,callback:function(a){e.$set(t.row,"brand_id",a)},expression:"scope.row.brand_id"}})]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"bank_number",label:"银行账号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticClass:"editor",attrs:{size:"small",type:"number",disabled:"disabled"},model:{value:t.row.bank_number,callback:function(a){e.$set(t.row,"bank_number",a)},expression:"scope.row.bank_number"}})]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"common_price",label:"金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticClass:"editor",attrs:{size:"small",type:"number","suffix-icon":"el-icon-edit-outline"},on:{change:function(a){return e.handleEdit(t)}},model:{value:t.row.common_price,callback:function(a){e.$set(t.row,"common_price",a)},expression:"scope.row.common_price"}})]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"remark",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{staticClass:"editor",attrs:{maxlength:"300","suffix-icon":"el-icon-edit-outline"},model:{value:t.row.remark,callback:function(a){e.$set(t.row,"remark",a)},expression:"scope.row.remark"}})]}}])})],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.is_disabled,expression:"is_disabled"}],staticClass:"aboutList"},[a("div",{staticClass:"paymanageTitle fcsb"},[a("span",[e._v("核销明细")]),a("el-link",{attrs:{type:"primary"},on:{click:e.exportDataEvent}},[e._v("导出核销明细")])],1),a("div",{staticClass:"table_container"},[a("div",[a("vxe-tooltip",{ref:"xTip"}),a("vxe-table",{ref:"xTable",attrs:{border:"","show-overflow":"","show-header-overflow":"",size:"mini","keyboard-config":{isArrow:!0,isDel:!1,isTab:!0,isEdit:!0},"show-footer":"","footer-method":e.getrelationTableSummaries,align:"center","highlight-cell":"","max-height":"500","highlight-hover-row":"","highlight-current-row":"",resizable:"","mouse-config":{selected:!0},"edit-config":{trigger:"dblclick",mode:"cell"},"checkbox-config":{checkStrictly:!0}},on:{"select-change":e.SelectionChange,"cell-mouseenter":e.cellMouseenterEvent,"cell-mouseleave":e.cellMouseleaveEvent,"edit-closed":e.editClosedEvent}},[a("vxe-table-column",{attrs:{type:"checkbox",width:"50","tree-node":""}}),a("vxe-table-column",{attrs:{type:"seq",width:"60",title:"序号"}}),a("vxe-table-column",{attrs:{field:"bill_sn","min-width":"120",title:"单据号"}}),a("vxe-table-column",{attrs:{field:"type_name",width:"120",title:"单据类型"}}),a("vxe-table-column",{attrs:{field:"supplier_name","min-width":"150",title:"供应商(厂家)"}}),a("vxe-table-column",{attrs:{field:"instorage_num",width:"120",title:"采购数量"}}),20001==e.params.factory_accounts_type_id?a("vxe-table-column",{attrs:{field:"order_price",width:"120",title:"采购金额"}}):e._e(),a("vxe-table-column",{attrs:{field:"rebate_price",width:"120",title:"使用返利",visible:Boolean(e.is_company_service)}}),a("vxe-table-column",{attrs:{field:"payable_price",width:"120",title:"实际应付金额",visible:Boolean(e.is_company_service)}}),20002==e.params.factory_accounts_type_id?a("vxe-table-column",{attrs:{field:"order_price",width:"120",title:"其它金额"}}):e._e(),a("vxe-table-column",{attrs:{field:"business_time","min-width":"200",title:"业务日期"}}),a("vxe-table-column",{attrs:{field:"add_time","min-width":"200",title:"单据时间"}}),a("vxe-table-column",{attrs:{field:"price",width:"130",title:"已付款金额"}}),a("vxe-table-column",{attrs:{field:"rest_price",width:"130",title:"未付款金额"}}),a("vxe-table-column",{attrs:{field:"bill_price",title:"本次付款金额",width:"130","edit-render":{name:"vNumber"}}})],1)],1)])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.goBack}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("params")}}},[e._v("确 定")])],1)],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"paymanageTitle"},[a("span",[e._v("结算明细")])])}],r=(a("d3b7"),a("a9e3"),a("b680"),a("159b"),a("4de4"),a("e9c4"),a("caad"),a("a434"),a("d81d"),a("65b0")),n={name:"purchasePaymanage_add",data:function(){return{authority:{},clearingFormLoading:!1,bankListLoading:!1,title:"添加",loading:!1,params:{},banktitle:"开户银行",jshj:0,cxhj:0,sumBill_price:null,isChecked:!1,TableData:{tableData:[]},multipleSelection:[],isDisabled:!1,is_disabled:!1}},methods:{getBanklist:function(e,t,a){var i=this;e.bankList.some((function(t){if(t.bank_id==a)return i.$set(e,"bank_number",t.bank_number),!0}))},portGetCollectionList:function(e,t){var a=this,i=e.row,s={accounts_type_id:this.params.accounts_type_id,company_id:this.params.company_id?this.params.company_id:"",type:1};this.clearingFormLoading=!0,this.$axMethod.getCollectionList(s).then((function(e){var t=e.data;if(a.clearingFormLoading=!1,200==t.code){var s=t.data;a.$set(i,"clearingForm",s)}})).catch((function(e){a.clearingFormLoading=!1}))},portGetCollectingBankList:function(e,t){var a=this,i=e.row,s={company_id:this.params.company_id?this.params.company_id:"",order_by:1};this.bankListLoading=!0,this.$axMethod.getCollectingBankList(s).then((function(e){var t=e.data;if(a.bankListLoading=!1,200==t.code){var s=t.data;a.$set(i,"bankList",s)}})).catch((function(e){a.bankListLoading=!1}))},cellMouseenterEvent:function(e){e.row;var t=e.column,a=e.cell;"selection"==t.type&&null==this.jshj&&this.$refs.xTip.toVisible(a,"请先输入金额")},cellMouseleaveEvent:function(e){e.row,e.column,e.cell;this.$refs.xTip.close()},xTableReloadData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.$refs.xTable.reloadData(e)},xTableGetData:function(){var e=this.$refs.xTable.getTableData(),t=e.tableData,a=void 0===t?[]:t;return a},xTableUpdateFooter:function(){var e=this;this.$nextTick((function(){if(e.$refs.xTable){e.$refs.xTable.updateFooter();var t=e.$refs.xTable.footerData[0];e.cxhj=t[t.length-1]}}))},xTableSelection:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.$refs.xTable.setCheckboxRow(e,t)},xTableGetSelectRecords:function(){return this.$refs.xTable.getSelectRecords()},exportDataEvent:function(){this.$refs.xTable.exportData({filename:"核销明细",type:"csv",original:!0,isHeader:!1,isFooter:!1})},editClosedEvent:function(e,t){var a=e.row;a.bill_price>0?(Number(a.rest_price)<0&&(a.bill_price="0.00"),a.bill_price=Number(a.bill_price).toFixed(2)):Number(a.rest_price)>0&&(a.bill_price="0.00"),this.jshj&&this.xTableSelection(a),this.xTableUpdateFooter()},commonPriceIsZero:function(){var e=this;if(this.jshj<=0){var t=this.xTableGetSelectRecords();t.forEach((function(t){e.$set(t,"bill_price","0.00")})),this.xTableUpdateFooter(),this.$refs.xTable.clearSelection()}},handleEdit:function(e){var t=this,a=e.row,i=e.column,s=i["property"];if("common_price"==s){var r=isNaN(Number(a[s]))?"":Number(a[s]).toFixed(2);0!=a[s]&&this.$set(a,s,r),this.$nextTick((function(){t.commonPriceIsZero()}))}else this.xTableUpdateFooter()},getNum:function(e,t){var a=this,i={brand_id:e,supplier_id:this.params.supplier_id,company_id:this.params.company_id};this.$axMethod.getRebatePrice(i).then((function(e){var i=e.data;200==i.code&&a.$set(t,"common_price",i.data.rebate_balance)}))},reomeve:function(){this.$set(this.TableData,"tableData",[]),this.xTableReloadData(),this.$set(this.params,"supplier_id","")},editlist:function(e){var t=this,a={payment_id:this.$route.query.payment_id},i=Object.assign(e,a);this.$axMethod.purchaseEditPayment(i).then((function(a){var i=a.data;if(200==i.code){var s=i.data;if(s.length&&t.$set(t,"is_disabled",!0),e.is_detail){var r=s.filter((function(e){return 1==e.tick}));t.xTableReloadData(i.data),t.$nextTick((function(){r.forEach((function(e){t.xTableSelection(e)}))}))}else t.$message({message:i.msg||i.data,type:"success"}),t.goBack()}}))},datalist:function(e){var t=this,a=this.params,i=a.company_id,s=a.factory_accounts_type_id,r=a.supplier_id,n=a.logistics_id,l=!0;if(s)switch(s){case 20001:case 20003:case 20004:i&&r||(l=!1);break;case 20002:i&&n||(l=!1);break;default:break}else l=!1;if(!l)return!1;this.$axMethod.purchaseAddPayment(e).then((function(a){var i=a.data;if(200==i.code){var s=i.data;if(s.length&&t.$set(t,"is_disabled",!0),e.is_detail)return void t.xTableReloadData(i.data);t.$message({message:i.msg||i.data,type:"success"}),t.goBack()}}))},cellClass:function(e){if(0==e.columnIndex)return"Disabledselection"},SelectionChange:function(e){var t=e.selection,a=e.row,i=e.checked,s=[];if(t.length){10002!=this.params.accounts_type_id||this.params.company_id||(this.companyList=[],this.companyList.push({company_id:t[0].finance_company_id,company_name:t[0].finance_company_name}),this.$set(this.params,"company_id",t[0].finance_company_id),this.companyChange(t[0].finance_company_id),this.$refs["params"].validate((function(e){}))),t.forEach((function(e){e.bill_price||(e.bill_price=0),s.push(Number(e.bill_price))})),this.sumBill_price=s.reduce((function(e,t){return e+t}));var r=this.jshj-this.sumBill_price}i?this.jshj>=0?Number(a.rest_price)>0?r>=Number(a.rest_price)?a.bill_price=Number(a.rest_price).toFixed(2):r>=0&&r<Number(a.rest_price)?a.bill_price=Number(r).toFixed(2):r<0&&r<Number(a.rest_price)?a.bill_price=0:a.bill_price=Number(r).toFixed(2):a.bill_price=Number(a.rest_price).toFixed(2):Number(a.rest_price)>0?r>0&&r>=Number(a.rest_price)?a.bill_price=Number(a.rest_price).toFixed(2):r>=0&&r<Number(a.rest_price)?a.bill_price=Number(r).toFixed(2):r<0&&r<Number(a.rest_price)&&(a.bill_price=0):r>=Number(a.rest_price)&&r<0?a.bill_price=Number(r).toFixed(2):(r<0&&r<Number(a.rest_price)||r>=0)&&(a.bill_price=Number(a.rest_price).toFixed(2)):a.bill_price=0,this.xTableUpdateFooter()},receivables:function(e){var t=this;10007==e.receivables_mode_id?(this.$set(e,"bank_number",""),this.banktitle="返利品牌"):this.banktitle="开户银行",this.$nextTick((function(){t.$refs.table.bodyWrapper.scrollTop=t.$refs.table.bodyWrapper.scrollHeight+33}))},getSupplier:function(e){var t=this;this.$axMethod.getSupplierInfo({company_id:this.params.company_id,supplier_id:e}).then((function(e){var a=e.data;200==a.code&&["associated_supplier_id","balance","principal_mobile","principal_name"].forEach((function(e){t.$set(t.params,e,a.data[e])}))}))},getHeXiaoData:function(e){this.xTableReloadData();var t=this.params.factory_accounts_type_id,a={company_id:this.params.company_id,factory_accounts_type_id:t,supplier_id:this.params.supplier_id,department_id:this.params.department_id||0,is_detail:1};20001!=t&&20002!=t||(this.$route.query.payment_id?this.editlist(a):this.datalist(a))},filterJsonField:function(){var e=this.TableData.tableData,t=this.xTableGetSelectRecords(),a={common_price:"",receivables_mode_id:0,bank_id:0,brand_id:0,remark:""},i={bill_id:0,bill_sn:"",supplier_id:0,supplier_name:"",buyer_id:0,buyer_name:"",instorage_num:"",order_price:"",price:"",rebate_price:"",rest_price:"",business_time:"",add_time:"",payable_price:"",type_id:"",bill_price:""},s=[],r=[];return e.forEach((function(e){var t={};for(var i in a)e[i]||0==e[i]?t[i]=e[i]:t[i]=a[i];r.push(t)})),t.forEach((function(e){var t={};for(var a in i)e[a]||0==e[a]?t[a]=e[a]:t[a]=i[a];s.push(t)})),{json_info:JSON.stringify(r),json_list:JSON.stringify(s)}},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(e){t.xTableGetData();var a=t.xTableGetSelectRecords(),i=!0;if(t.$refs["formTable"].validate((function(e){i=e})),!i)return;if(a.forEach((function(e){e.tick=1,e._XID&&delete e._XID})),a.length<=0&&[20001,20002].includes(t.params.factory_accounts_type_id))return t.$message.warning("请选择至少一条核销明细"),!1;if(t.TableData.tableData.length<1)return t.$message.warning("结算明细不能为空"),!1;var s=t.TableData.tableData.every((function(e){return!!e.receivables_mode_id&&""!=toString(e.common_price)}));if(!s)return t.$message.warning("请完善 结算明细 表体信息"),!1;if(20002==t.params.factory_accounts_type_id){var r=Number(t.cxhj),n=Number(t.jshj);if(r!=n)return void t.$message.warning("运费付款，冲销金额合计必须等于收款总额")}if(20001==t.params.factory_accounts_type_id||20002==t.params.factory_accounts_type_id)if(t.is_company_service){if(Number(t.cxhj)!=Number(t.jshj))return void t.$message.warning("创建付款单据失败，请核查填写的金额是否在“本次付款金额”列下全部付款")}else if(Number(t.cxhj)>Number(t.jshj))return void t.$message.warning("核销明细合计 不能大于 结算明细合计");var l=t.filterJsonField(),o=Object.assign({},t.params,{json_info:l.json_info,is_detail:0,json_list:l.json_list});if(t.$route.query.payment_id){var c={payment_id:"",supplier_id:0,logistics_id:0,factory_accounts_type_id:0,department_id:0,company_id:0,business_time:"",auditor_status:"",remark:"",json_info:"[]",json_list:"[]"},d={is_detail:0};for(var m in c)o[m]&&(d[m]=o[m]);t.editlist(d)}else t.params.factory_accounts_type_id&&t.datalist(o)}}))},changeLogistics:function(e){this.getHeXiaoData()},goBack:function(){this.$router.push({path:"/purchase/paymanage"})},addPaymangeFun:function(e){var t=this;this.$refs[e].validate((function(e){e&&t.TableData.tableData.push({})}))},delFun:function(){var e=this;if(this.multipleSelection.length<1)return this.$message.warning("请选择要删除的数据"),!1;this.multipleSelection.forEach((function(t){var a=e.TableData.tableData.indexOf(t);return e.TableData.tableData.splice(a,1)})),this.TableData.tableData.length<=0&&(this.jshj=null)},handleSelectionChange:function(e){this.multipleSelection=e},accountsTypeChange:function(e){if(20004==e||20003==e?this.$set(this,"is_disabled",!1):this.$set(this,"is_disabled",!0),20001==e||20004==e)return this.$set(this.TableData,"tableData",[]),this.xTableReloadData(),void this.getHeXiaoData();this.reomeve(),(this.params.logistics_id||this.params.supplier_id)&&(this.$set(this.params,"logistics_id",""),this.$set(this.params,"supplier_id",""))},companyChange:function(e){this.$set(this.params,"department_id",""),this.reomeve()},getSummaries:function(e){var t=this,a=e.columns,i=e.data,s=[];return a.forEach((function(e,a){if(1!==a){var r=i.map((function(t){return Number(t[e.property])}));r.every((function(e){return isNaN(e)}))?s[a]="":(s[a]=r.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),4==a?(s[a]=parseFloat(s[a]).toFixed(2),t.jshj=parseFloat(s[a]).toFixed(2)):s[a]="")}else s[a]="总计"})),s},getrelationTableSummaries:function(e){var t=this,a=e.columns,i=e.data;return[a.map((function(e,a){return 1===a?"合计":["price","rest_price","bill_price"].includes(e.property)?(t.cxhj=t.$utils.sum(i,e.property),t.$utils.sum(i,e.property).toFixed(2)):null}))]}},mounted:function(){var e=this;if(this.title=this.$route.query.payment_id?"修改":"添加",Boolean(this.$route.query.payment_id)){this.isDisabled=!0;var t={payment_id:this.$route.query.payment_id};this.$axMethod.purchaseGetPaymentInfo(t).then((function(t){var a=t.data;if(200==a.code){var i=a.data;i.list.length&&e.$set(e,"is_disabled",!0),e.$set(e.TableData,"tableData",i.paymentCommonList),i.paymentCommonList.forEach((function(t,a,s){0==t.brand_id&&(t.brand_id=-1),0==t.bank_id&&(t.bank_id=""),e.receivables(i.paymentCommonList[a]),e.$set(s[a],"clearingForm",[{receivables_mode_id:s[a].receivables_mode_id,receivables_mode_name:s[a].receivables_mode_name}]),e.$set(s[a],"bankList",[{bank_id:s[a].bank_id,bank_number:s[a].bank_number,bank_name:s[a].bank_name}]);var r=["bank_id","bank_number","bank_name"];r.forEach((function(t){e.$set(e.TableData.tableData[a],t,s[a][t])})),e.$set(e.TableData.tableData[a],"brandArry",[{brand_id:i.paymentCommonList[a].brand_id,brand_name:i.paymentCommonList[a].brand_name}])})),Object(r["l"])(e,i.paymentInfo),e.$set(e,"params",i.paymentInfo),e.getSupplier(i.paymentInfo.supplier_id),e.$set(e.TableData,"tableData",i.paymentCommonList),e.getHeXiaoData()}}))}else this.$set(this,"params",{company_id:Number(localStorage.company_id),company_admin_id:Number(localStorage.company_admin_id),business_time:this.$publicFution.formatData(new Date)}),Object(r["l"])(this,localStorage)}},l=n,o=(a("edbb"),a("7742"),a("2877")),c=Object(o["a"])(l,i,s,!1,null,"5ae7e876",null);t["default"]=c.exports},7742:function(e,t,a){"use strict";a("4cba")},b680:function(e,t,a){"use strict";var i=a("23e7"),s=a("da84"),r=a("e330"),n=a("5926"),l=a("408a"),o=a("1148"),c=a("d039"),d=s.RangeError,m=s.String,u=Math.floor,p=r(o),_=r("".slice),b=r(1..toFixed),f=function(e,t,a){return 0===t?a:t%2===1?f(e,t-1,a*e):f(e*e,t/2,a)},h=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},v=function(e,t,a){var i=-1,s=a;while(++i<6)s+=t*e[i],e[i]=s%1e7,s=u(s/1e7)},y=function(e,t){var a=6,i=0;while(--a>=0)i+=e[a],e[a]=u(i/t),i=i%t*1e7},g=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var i=m(e[t]);a=""===a?i:a+p("0",7-i.length)+i}return a},k=c((function(){return"0.000"!==b(8e-5,3)||"1"!==b(.9,0)||"1.25"!==b(1.255,2)||"1000000000000000128"!==b(0xde0b6b3a7640080,0)}))||!c((function(){b({})}));i({target:"Number",proto:!0,forced:k},{toFixed:function(e){var t,a,i,s,r=l(this),o=n(e),c=[0,0,0,0,0,0],u="",b="0";if(o<0||o>20)throw d("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return m(r);if(r<0&&(u="-",r=-r),r>1e-21)if(t=h(r*f(2,69,1))-69,a=t<0?r*f(2,-t,1):r/f(2,t,1),a*=4503599627370496,t=52-t,t>0){v(c,0,a),i=o;while(i>=7)v(c,1e7,0),i-=7;v(c,f(10,i,1),0),i=t-1;while(i>=23)y(c,1<<23),i-=23;y(c,1<<i),v(c,1,1),y(c,2),b=g(c)}else v(c,0,a),v(c,1<<-t,0),b=g(c)+p("0",o);return o>0?(s=b.length,b=u+(s<=o?"0."+p("0",o-s)+b:_(b,0,s-o)+"."+_(b,s-o))):b=u+b,b}})},edbb:function(e,t,a){"use strict";a("0943")}}]);
//# sourceMappingURL=chunk-47af96e2.e99d62f2.js.map