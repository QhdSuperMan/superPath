(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-62bc5f22"],{a35c:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"params"},[a("vxe-modal",{attrs:{title:"适配车型",id:"inReceiptSelectOrder",width:"1200","esc-closable":!0,"destroy-on-close":"",height:"500","min-width":"600","min-height":"100",resize:"",remember:"",storage:"",transfer:""},on:{hide:function(e){return t.$emit("input",!1)}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[t.tableData.length?a("div",[a("div",{staticClass:"el_tree_box"},[a("xTable",{ref:"xTable",attrs:{tableColumn:t.tableColumn,maxHeight:"380",xData:t.tableData}}),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,50],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)]):t.loading?t._e():a("div",{staticClass:"dialog-footer"},[t._v(" 适配车型无数据 ")])])])],1)},r=[],o=a("b85c"),n=(a("e3df"),a("3db6"),a("74af"),a("fde8"),a("c9ce"),a("b1f0"),a("3c64"),a("f043")),l={data:function(){var t=this;return{loading:!1,tableColumn:[{title:"车款",field:"sales_name",formatter:function(t){var e=t.row;return e.sales_name?e.sales_name:e.attr_value_name},width:250},{title:"品牌",field:"brand_name",width:70},{title:"厂家",field:"show_name",width:100},{title:"车系",field:"car_series",width:120},{title:"排放标准",field:"emission_standard",width:70},{title:"年款",field:"years",width:100},{title:"上市年份",field:"c_variant_sop",width:120},{title:"生产年份",field:"c_variant_sop",width:120},{title:"停产年份",field:"c_variant_eop",width:100},{title:"排量",field:"displacement",width:100},{title:"发动机",field:"engine_type",width:100},{title:"适配来源",field:"unit_name",width:100,formatter:function(e){var a=e.row;return 1==t.idsObj[a.car_lib_id]?"OE码匹配":"自主选择"}}],idsObj:{},tableData:[],currentPage:1,pageSize:10,total:0}},watch:{value:function(t){!0===t&&2===this.type&&this.getLibraryId()},library_id:function(){1===this.type&&this.getLibraryId()},ids:function(){this.getData()}},props:{value:null,type:{type:Number,default:1},library_id:{type:Number|String,default:""},shop_goods_id:{type:Number|String,default:""},ids:{type:Array,default:function(){return[]}}},created:function(){var t=this;this.alltableData=[],this.allData=[],Object(n["a"])((function(e){var a=[];for(var i in e.data){var r,n=Object(o["a"])(e.data[i]);try{for(n.s();!(r=n.n()).done;){var l=r.value;a.push(l)}}catch(s){n.e(s)}finally{n.f()}}t.allData=a,t.$emit("loaded"),1==t.type&&t.getData()}))},methods:{getLibraryId:function(){var t=this;this.init(),this.library_id?(this.loading=!0,this.$api.serviceStationGetOeCodeOrCarLibraryList({library_id:this.library_id}).then((function(e){var a=e.data;if(200==a.code){var i=[],r=[];for(var o in a.data.car_library)i=i.concat(a.data.car_library[o]);for(var n in a.data.oe_code)r.push(a.data.oe_code[n]);t.ids=i,t.$emit("getOeCode",r.join(","))}t.loading=!1,t.getAttributeCarLibraryList()})).catch((function(){t.loading=!1}))):this.getAttributeCarLibraryList()},submit:function(){this.$emit("sumbitData",{params:this.currentRow,selectBox:this.selectBox})},GetValue:function(t){if(t)return this.$api.serviceStationGetOeCodeOrCarLibraryList({library_id:t})},getAttributeCarLibraryList:function(){var t=this;this.shop_goods_id&&0===this.ids.length&&this.$api.getAttributeCarLibraryList({shop_goods_id:this.shop_goods_id}).then((function(e){var a=e.data;if(200==a.code){var i=[];for(var r in a.data)i=i.concat(a.data[r]);t.alltableData=i,t.handleCurrentChange(1)}}))},getFairModelData:function(t){for(var e="",a=0;a<t.length;a++){if(e.length>100)break;e=e+t[a].sales_name+","}this.$emit("renderModel",e.slice(0,-1)),this.$parent.showModelsName=e.slice(0,-1)},handleCurrentChange:function(t){var e=this.alltableData.concat([]);this.tableData=e.splice((t-1)*this.pageSize,this.pageSize)},handleSizeChange:function(t){this.pageSize=t},init:function(){this.currentPage=1,this.total=0,this.alltableData=[],this.tableData=[]},getData:function(){var t=this;if(this.init(),this.allData.length&&this.ids.length){this.idsObj={};for(var e=0;e<this.ids.length;e++){if(-1==this.ids[e].car_lib_id)return this.total=this.allData.length,this.alltableData=this.allData,this.handleCurrentChange(1),this.$emit("getData",[{sales_name:"通用车型"}]),void this.getFairModelData([{sales_name:"通用车型"}]);this.idsObj[this.ids[e].car_lib_id]=this.ids[e].match_type}var a=[],i=[];this.allData.forEach((function(e){1==t.idsObj[e.car_lib_id]&&i.push(e),0==t.idsObj[e.car_lib_id]&&a.push(e)})),this.total=i.length+a.length,this.alltableData=a.concat(i),this.handleCurrentChange(1),this.$emit("getData",this.alltableData),this.getFairModelData(this.alltableData)}}}},s=l,c=a("2877"),d=Object(c["a"])(s,i,r,!1,null,"5577fe30",null);e["a"]=d.exports},df50:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[t._v("采购管理")]),a("el-breadcrumb-item",{staticClass:"attrbute"},[a("span",{on:{click:t.goBack}},[t._v("采购中心")])]),a("el-breadcrumb-item",[t._v("采购商品详情")])],1),a("div",[a("el-form",{staticClass:"demo-form-inline",staticStyle:{margin:"20px"},attrs:{inline:!0,"label-width":"110px","label-position":"right",model:t.from}},[a("el-form-item",{attrs:{label:"商品图片:"}},[a("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.from.goods_image,alt:"",srcset:""}})]),a("br"),a("el-form-item",{attrs:{label:"商品名称:"}},[t._v(" "+t._s(t.from.goods_name)+" ")]),a("br"),a("el-form-item",{attrs:{label:"商品品牌:"}},[t._v(" "+t._s(t.from.brand_name)+" ")]),a("br"),a("el-form-item",{attrs:{label:"库存:"}},[t._v(" "+t._s(t.from.goods_storage)+" ")]),a("br"),a("el-form-item",{attrs:{label:"阶梯价:"}},t._l(t.from.sourcing_price,(function(e,i){return a("div",{key:i},[a("span",[t._v("数量："+t._s(e.minimum_number)+"——"+t._s(e.maximum_number)+"件")]),a("span",[t._v("售价:¥"+t._s(e.sourcing_price))])])})),0),a("br"),a("el-form-item",{attrs:{label:"商品属性:"}},t._l(t.from.attr_list,(function(e,i){return a("div",{key:i},[a("span",[t._v(t._s(e.attr_name)+"："+t._s(e.attr_value))])])})),0),a("br"),a("el-form-item",{attrs:{label:"所在地:"}},[t._v(" "+t._s(t.from.area_name)+" ")]),a("br"),t.showModelsName?a("el-form-item",{attrs:{label:"适配车型:"}},[t._v(" "+t._s(t.showModelsName)+" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isShowFairModel=!0}}},[t._v("查看全部")])],1):t._e(),a("br"),t.from.oe_code?a("el-form-item",{attrs:{label:"品牌件码/OE码:"}},[t._v(" "+t._s(t.from.oe_code)+" ")]):t._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.goBack}},[t._v("返回列表")])],1),a("modelDetail",{ref:"modelDetail",attrs:{library_id:t.from.library_id},on:{getOeCode:function(e){t.from.oe_code=e}},model:{value:t.isShowFairModel,callback:function(e){t.isShowFairModel=e},expression:"isShowFairModel"}})],1)},r=[],o=a("a35c"),n={data:function(){return{from:{},isShowFairModel:!1,showModelsName:""}},methods:{goBack:function(){this.$router.push({path:"/purchase/jybdorder"})},getGoodsInfo:function(t){var e=this;this.$axMethod.jybdgetGoodsInfo(t).then((function(t){var a=t.data;200==a.code&&(e.from=a.data,e.$nextTick((function(){e.$refs.modelDetail.getData()})))}))}},components:{modelDetail:o["a"]},mounted:function(){var t=this.$route.query.shop_goods_id||0;this.getGoodsInfo({shop_goods_id:t})}},l=n,s=a("2877"),c=Object(s["a"])(l,i,r,!1,null,"806ec01e",null);e["default"]=c.exports},f043:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("410a"),a("6f78"),a("b1f0"),a("3c64");var i=a("fc5a"),r=a("9887"),o=a.n(r);function n(t){var e="car_librarys_csv_874654166";if(window[e])return t({code:200,data:window[e]});function a(t){if(!(window.localStorage&&window.indexedDB&&window.indexedDB.open))return t(!1);var e=indexedDB.open("jybd-car",1);e.onerror=function(e){console.log("数据库打开报错"),t(!1)},e.onsuccess=function(a){console.log("数据库打开成功"),t(e.result)},e.onupgradeneeded=function(t){t.target.result.objectStoreNames.contains("car_choice")||t.target.result.createObjectStore("car_choice",{keyPath:"id"})}}function r(t,e){o.a.get(t).then((function(t){for(var a=t.data.split("\n"),i=[],r=a[1].split(","),o=2;o<a.length;o++){for(var n={},l=a[o].split(","),s=0;s<l.length;s++)r[s]&&(n[r[s]]=l[s]);n.car_lib_id&&i.push(n)}e({code:200,data:i})}))}function n(t,i){window[e]=t,a((function(a){if(!1!==a){var r=a.transaction(["car_choice"],"readwrite").objectStore("car_choice").put({id:0,data:t});r.onsuccess=function(t){window.localStorage.setItem(e,i.data.update_time),console.log("数据库存储成功")},r.onerror=function(t){console.log("Database error: ",t.target.error)}}}))}function l(t,i){if(200==t.code&&window.localStorage&&window.localStorage.getItem&&window.localStorage.getItem(e)!=t.data.update_time)return i();a((function(t){if(!1===t)return i();var a=t.transaction(["car_choice"]).objectStore("car_choice").get(0);a.onsuccess=function(t){console.log("数据库读取成功");var r=a.result&&a.result.data;i(r),r&&(window[e]=r)},a.onerror=function(t){console.log("Database error: ",t.target.error),i()}}))}function s(t){Object(i["a"])({type:"get",url:"v2/open/Excel/getCarLibraryExcel"}).then((function(e){try{e=JSON.parse(e.data.data)}catch(a){}t({code:e.code,data:e.result})})).catch((function(){t({code:400,message:"服务器错误，请联系管理员"})}))}function c(t){var e={};return t.forEach((function(t){e[t.brand_letter]||(e[t.brand_letter]=[]),e[t.brand_letter].push(t)})),e}s((function(e){l(e,(function(a){return a?t({code:200,data:a}):200!=e.code?t(e):void r(e.data.url,(function(a){a.data=c(a.data),t(a),200==a.code&&setTimeout((function(){n(a.data,e)}),100)}))}))}))}}}]);
//# sourceMappingURL=chunk-62bc5f22.b780e1b3.js.map