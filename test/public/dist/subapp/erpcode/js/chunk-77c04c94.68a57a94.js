(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-77c04c94"],{"0cfb8":function(module,__webpack_exports__,__webpack_require__){"use strict";var D_worker_project_MergeERP_erpcode_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("5530"),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("d81d"),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("99af"),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("4de4"),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_json_stringify_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("e9c4"),core_js_modules_es_json_stringify_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_json_stringify_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("caad"),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_number_constructor_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("a9e3"),core_js_modules_es_number_constructor_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_number_constructor_js__WEBPACK_IMPORTED_MODULE_7__),common_utils_public_function_commonUtils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("65b0"),_sourceBill__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("3e01"),vuex__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("2f62"),_js_tableHead__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("cf50"),_js_orderAdd_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("3348");__webpack_exports__["a"]={name:"purchaseOrderAdd",mixins:[_js_tableHead__WEBPACK_IMPORTED_MODULE_11__["a"],_js_orderAdd_js__WEBPACK_IMPORTED_MODULE_12__["c"]],data:function(){return{title:"添加",warehouseRequired:!0,onlyQuote:!1,loading:!1,order_sn_disabled:!1,params:{order_type:1,pay_method:2,rebate_balance:0},dialogBillVisible:!1,supplierList:[],orderNum:"",orderAlreadyNum:"",disabled:!1,username:localStorage.getItem("realname")}},components:{sourceBill:_sourceBill__WEBPACK_IMPORTED_MODULE_9__["a"]},computed:Object(D_worker_project_MergeERP_erpcode_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__["a"])(Object(D_worker_project_MergeERP_erpcode_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__["a"])({},Object(vuex__WEBPACK_IMPORTED_MODULE_10__["c"])(["orderAddGet"])),{},{goodsopthion:function(){return Object.assign(this.params,{Method:"getPurchaseInventoryGoodsListV2"})}}),methods:{getCompanyList:function(e,a){this.warehouseRequired=a.relation_company_id,this.$refs.ruleForm.clearValidate("warehouse_id")},goBack:function(){this.$publicFution.goPage(this.orderAddGet.order_id),this.$router.push({path:"/purchase/order"})},quoteOrder:function(){if(void 0==this.params.company_id||""==this.params.company_id)return this.$message.error("请选择采购组织"),!1;this.dialogBillVisible=!0},handleEdit:function(e){var a=e.row,t=e.column,r=(e.rowIndex,{num:"goods_num",price:"purchase_price",goodsPrice:"subtotal_price"});this.$publicFution.computeTotal(a,r,t.property,this),this.$refs.xTable._proxy("updateFooter")},addF:function(e){return this.params.company_id||!0===e?this.params.supplier_id||!0===e?void this.$refs.xTable._proxy("insertAt",this.$publicFution.deepCopy(_js_orderAdd_js__WEBPACK_IMPORTED_MODULE_12__["a"]),-1):(this.$message.warning("请选择供应商(厂家)"),!1):(this.$message.warning("请选择采购组织"),!1)},dialogformInline:function(e){if(e.goodsList.length>0){this.disabled=!0;var a=this.params.business_time;e.goodsList.map((function(e){return e.goods_num=e.remaining_goods_num,e})),this.$refs.xTable._proxy("loadData",e.goodsList),this.params=e.info,this.$set(this.params,"business_time",a);var t=e.info;Object.assign(t,{employee_id:e.info.buyer_id,employee_name:e.info.buyer_name}),Object(common_utils_public_function_commonUtils__WEBPACK_IMPORTED_MODULE_8__["l"])(this,t),this.$set(this.params,"buyer_id",e.info.buyer_id),this.dialogBillVisible=!1}},companyChange:function companyChange(val){var _this=this;this.$refs.xTable._proxy("loadData",[]),this.$set(this.params,"supplier_id",""),this.$set(this.params,"department_id",""),this.$set(this.params,"buyer_id",""),this.$set(this.params,"warehouse_id",""),this.$baseData.settingInfo({num:3,company_id:val.company_id},(function(){if(localStorage.FDBName_business){var state=localStorage.getItem("FDBName_business");_this.onlyQuote=1==eval(state)[0].status}})),this.getRebatePrice(),this.getCompanyList([],val)},deleteF:function(){this.$refs.xTable._proxy("getSelectRecords").length?this.$refs.xTable._proxy("removeSelecteds"):this.$message.warning("请先选择要删除的商品！")},submit:function(e){var a=this;this.$refs[e].validate((function(e){if(e){var t=a.$refs.xTable._proxy("getTableData").fullData.concat([]);if(0===t.length)return void a.$message.warning("商品数据不能为空");!t[t.length-1].goods_id&&t.length>1&&(t.pop(),a.$refs.xTable._proxy("loadData",t)),a.$refs.xTable._proxy("validate").then((function(e){a.orderNum,a.orderAlreadyNum;t=t.map((function(e){return a.$publicFution.filter(_js_orderAdd_js__WEBPACK_IMPORTED_MODULE_12__["b"],e)})),a.$baseData.checkComputation(t,{goods_num:"goods_num",total_price:"subtotal_price",goods_price:"purchase_price"}).then((function(){if(a.orderAddGet.order_id){var e={order_id:a.orderAddGet.order_id,buyer_id:a.params.buyer_id,supplier_id:a.params.supplier_id,department_id:a.params.department_id,company_id:a.params.company_id,goods_json:JSON.stringify(t),warehouse_id:a.params.warehouse_id,order_type:a.params.order_type,pay_method:a.params.pay_method,plan_id:a.params.plan_id,plan_sn:a.params.plan_sn,receivables_mode_id:a.params.receivables_mode_id,business_time:void 0==a.params.business_time?"":a.params.business_time,remark:void 0==a.params.remark?"":a.params.remark};a.$axios({method:"post",url:a.$api.editOrder,data:e}).then((function(e){200==e.data.code&&(a.$message.success(e.data.data),a.goBack())}))}else{var r=a.params;r.goods_json=JSON.stringify(t),a.$axios({method:"post",url:a.$api.purchaseAddOrder,data:r}).then((function(e){200==e.data.code&&(a.$message.success(e.data.msg),a.goBack())}))}}))}))}}))}},mounted:function mounted(){var _this3=this;if(this.order_id=this.orderAddGet.order_id,this.title=this.order_id?"修改":"添加",localStorage.FDBName_business){var state=localStorage.getItem("FDBName_business");this.onlyQuote=1==eval(state)[0].status}if(this.orderAddGet.order_id)this.order_sn_disabled=!0,this.$axios({method:"get",url:this.$api.getOrderInfoPurchase,params:{order_id:this.order_id}}).then((function(e){_this3.$refs.xTable._proxy("loadData",e.data.data.goods_list),_this3.$set(_this3,"params",e.data.data.info),Object(common_utils_public_function_commonUtils__WEBPACK_IMPORTED_MODULE_8__["l"])(_this3,e.data.data.info),""!=e.data.data.info.plan_sn&&(_this3.disabled=!0,_this3.$axios({method:"get",url:_this3.$api.getPlanInfo,params:{plan_id:e.data.data.info.plan_id}}).then((function(e){200==e.data.code&&(_this3.orderNum=e.data.data.info.num,_this3.orderAlreadyNum=e.data.data.info.reference_num,""!=e.data.data.info.plan_sn&&(_this3.disabled=!0))}))),_this3.getRebatePrice(),_this3.$refs.erpCompanyList.getList()}));else{var _localStorage=localStorage,employee_id=_localStorage.employee_id,company_admin_id=_localStorage.company_admin_id;[0,1,2].includes(Number(employee_id))||company_admin_id>0?this.$set(this,"params",{company_id:Number(localStorage.company_id),company_name:localStorage.company_name,business_time:this.$publicFution.formatData(new Date),order_type:1,pay_method:2}):this.$set(this,"params",{company_id:Number(localStorage.company_id),company_name:localStorage.company_name,department_id:Number(localStorage.department_id),buyer_id:Number(localStorage.employee_id),buyer_name:localStorage.employee_name,business_time:this.$publicFution.formatData(new Date),order_type:1,pay_method:2}),Object(common_utils_public_function_commonUtils__WEBPACK_IMPORTED_MODULE_8__["l"])(this,localStorage),this.addF(!0),this.getRebatePrice(),this.$refs.erpCompanyList.getList()}}}},3348:function(e,a,t){"use strict";t.d(a,"b",(function(){return r})),t.d(a,"a",(function(){return s})),t.d(a,"c",(function(){return i}));var r={goods_id:"",plan_goods_id:"",goods_num:{formatter:"Int",default:0},purchase_price:"",subtotal_price:"",remark:""},s={goods_name:"",goods_id:"",plan_goods_id:"",goods_num:"",purchase_price:"",subtotal_price:"",remark:""},i={data:function(){var e=this;return{editRules:{goods_num:[{required:!0,message:"数量输入请在0-99999999之间",type:"number",min:1,max:99999999}],goods_name:[{required:!0,message:"请选择商品"}]},tableColumn:[{type:"checkbox",width:44,align:"center"},{title:"序号",type:"seq",width:50},{title:"商品编号",field:"goods_id",width:80},{title:"商品名称",field:"goods_name",width:400,editRender:{name:"vGoods",getParams:function(a){var t=a.row;return{params:{company_id:e.params.company_id},showObj:{goods_id:"商品编号",goods_name:"商品名称",unit_name:"单位",brand_name:"品牌",specification_type:"规格型号",factory_code:"工厂代码"},getIcon:function(){return t.goods_name?[{icon:"el-icon-close",title:"删除商品",iconMethod:function(){for(var e in t)t[e]=""}}]:[]}}},events:{change:function(a,t){var r=t.row;r.goods_id=a.goods_id,r.factory_code=a.factory_code,r.purchase_price=a.purchase_price;var s=e.$refs.xTable._proxy("getTableData").fullData;s[s.length-1].goods_name&&e.addF()}}}},{title:"工厂代码",field:"factory_code",width:100},{title:"数量",field:"goods_num",width:132,headerAlign:"right",align:"right",editRender:{name:"number",autoselect:!0,events:{input:this.handleEdit}}},{title:"采购价",headerAlign:"right",align:"right",field:"purchase_price",width:132,editRender:{name:"Vinput",autoselect:!0,events:{input:this.handleEdit}}},{title:"小计金额",headerAlign:"right",align:"right",field:"subtotal_price",width:132,editRender:{name:"Vinput",autoselect:!0,events:{input:this.handleEdit}}},{title:"备注",field:"remark",editRender:{name:"Vinput",formatter:"String"}}]}},methods:{isEdit:function(e){var a=e.column;return!!("goods_name"!==a.property||this.params.company_id&&this.params.supplier_id)||(this.$message.warning("请先选择采购组织和供应商(厂家)"),!1)}}}},"3e01":function(e,a,t){"use strict";var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"search_container"},[t("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[t("el-form-item",{attrs:{label:"采购组织",size:"mini"}},[t("el-select",{attrs:{clearable:"",placeholder:"请选择",disabled:"disabled"},model:{value:e.params.company_id,callback:function(a){e.$set(e.params,"company_id",a)},expression:"params.company_id"}},e._l(e.companyList,(function(a){return t("el-option",{key:a.company_id,attrs:{label:a.company_name,value:a.company_id}},[t("span",{class:1==a.type?"optionStyle":""},[e._v(e._s(a.company_name))])])})),1)],1),t("el-form-item",{attrs:{label:"单据日期",size:"mini"}},[t("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeValue,callback:function(a){e.timeValue=a},expression:"timeValue"}})],1),t("el-form-item",{attrs:{label:"单据号",size:"mini"}},[t("el-input",{staticClass:"shortSearchInput",model:{value:e.params.plan_sn,callback:function(a){e.$set(e.params,"plan_sn",a)},expression:"params.plan_sn"}})],1),t("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini"}},[t("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.params.supplier_id,callback:function(a){e.$set(e.params,"supplier_id",a)},expression:"params.supplier_id"}},e._l(e.supplier.options,(function(e){return t("el-option",{key:e.supplier_id,attrs:{label:e.supplier_name,value:e.supplier_id}})})),1)],1),t("el-form-item",{attrs:{label:"采购员",size:"mini"}},[t("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{focus:e.employeeFocus},model:{value:e.params.buyer_id,callback:function(a){e.$set(e.params,"buyer_id",a)},expression:"params.buyer_id"}},e._l(e.employeeList.options,(function(e){return t("el-option",{key:e.employee_id,attrs:{label:e.employee_name,value:e.employee_id}})})),1)],1),t("el-form-item",{staticStyle:{"margin-left":"20px"},attrs:{size:"mini"}},[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),t("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1),e._m(0),t("div",{staticClass:"table_container"},[t("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableData,"max-height":"300"},on:{"row-click":e.handleCurrentChanges}},[t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"plan_sn",label:"单据号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"add_time",label:"单据时间"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"supplier_name",label:"供应商(厂家)"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"num",label:"采购数量"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"subtotal_price",label:"采购金额总计"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"reference_num",label:"已下单数量"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"buyer_name",label:"采购员"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"add_user_name",label:"创建人"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"auditor_name",label:"审核人"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"remark",label:"备注"}})],1)],1),t("p",{staticStyle:{margin:"20px 0px","border-bottom":"1px dashed #e5e5e5"}}),e._m(1),t("div",{staticClass:"table_container"},[t("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableDatas,"max-height":"300"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"selection",fixed:"left",align:"center",width:"44"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_id",label:"商品编号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_name",label:"商品名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"purchase_price",label:"采购价"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_num",label:"采购数量"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"old_subtotal_price",label:"采购金额小计"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"reference_goods_num",label:"已下单数量"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"remark",label:"行备注"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){return e.dialogCancelForm()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.dialogSubmitForm()}}},[e._v("确 定")])],1)],1)])},s=[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"add_delet"},[t("p",[e._v("【采购计划】单据列表")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"add_delet"},[t("p",[e._v("【采购计划】单据明细")])])}],i=t("65b0"),o={data:function(){return{params:{},AccordingParams:{},timeValue:"",companyList:[],multipleSelection:[],supplier:{options:[]},tabledatas:[],TableData:[],TableDatas:[],radio:null,goPage:1,employeeList:{options:[]},pageSize:30,per_page:[30,50,100,500]}},methods:{onSearch:function(){this.timeValue&&2==this.timeValue.length?(this.params.start_time=this.timeValue[0],this.params.end_time=this.timeValue[1]):this.params.start_time=this.params.end_time="",Object(i["h"])(this,{API:"referencePlanListPublics",params:this.params},"TableData")},handleSelectionChange:function(e){this.multipleSelection=e},onReset:function(){this.$set(this,"params",{}),this.timeValue=[],this.$set(this.params,"company_id",this.par.company_id),Object(i["h"])(this,{API:"referencePlanListPublics",params:this.params},"TableData")},handleCurrentChanges:function(e){var a=this;this.$axMethod.referencePlanInfo({plan_id:e.plan_id}).then((function(e){var t=e.data;200==t.code&&(a.tabledatas=t.data,a.TableDatas=t.data.goodsList)}))},dialogCancelForm:function(){this.$emit("closedialog",!1)},employeeFocus:function(){Object(i["j"])(this,this.params)},dialogSubmitForm:function(){if(!this.TableDatas.length)return this.$message.error("请选择订单"),!1;this.tabledatas.goodsList=this.multipleSelection,this.$emit("dialogformInline",this.tabledatas)}},props:["par"],mounted:function(){this.params={supplier_id:this.par.supplier_id,company_id:this.par.company_id,buyer_id:this.par.buyer_id},Object(i["h"])(this,{API:"referencePlanListPublics",params:this.params},"TableData"),Object(i["e"])(this),Object(i["j"])(this),this.$common.options("getSupplierListOption",this.supplier)}},_=o,l=t("2877"),n=Object(l["a"])(_,r,s,!1,null,"1e2b3cbb",null);a["a"]=n.exports},"72d4":function(e,a,t){"use strict";t("d61d")},cf50:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var r=t("5530"),s=(t("d3b7"),t("159b"),t("b64b"),t("a9e3"),t("d81d"),t("2f62")),i=t("65b0"),o={data:function(){return{}},activated:function(){var e=this.$route.params;e.transferType&&this.portStockEarlyWarningChangeOrderInfo(e)},methods:Object(r["a"])(Object(r["a"])({},Object(s["b"])(["salesorderAdd"])),{},{getRebatePrice:function(){var e=this;this.params.supplier_id&&this.params.company_id&&this.$axMethod.getRebatePrice({brand_id:-1,supplier_id:this.params.supplier_id,company_id:this.params.company_id}).then((function(a){var t=a.data;200==t.code&&e.$set(e.params,"rebate_balance",t.data.rebate_balance)}))},turnSaleOrder:function(e){this.salesorderAdd({type:"采购单转销售订单",Buy_order:e,random:Math.floor(1e4*Math.random())}),this.$router.push({path:"/sales/salesorder/salesorderAdd"})},portStockEarlyWarningChangeOrderInfo:function(e){var a=this;this.loading=!0,this.$axMethod.stockEarlyWarningChangeOrderInfo(e.portParams).then((function(t){var r=t.data;if(a.loading=!1,200==r.code){var s=r.data.info,o=r.data.goods_list;switch(Object.keys(s).forEach((function(e){a.$set(a.params,e,s[e])})),a.params.remark=s.abstract,0==a.params.warehouse_id&&(a.params.warehouse_id=""),Number(localStorage.company_id)!=s.company_id?(a.$set(a.params,"department_id",""),a.$set(a.params,"buyer_id","")):a.params.department_id||(a.$set(a.params,"department_id",Number(localStorage.department_id)),a.$set(a.params,"buyer_id",Number(localStorage.employee_id))),Object(i["l"])(a,s),e.transferType){case 1:a.orderAddGet.order_id&&a.orderIndexACT({}),o=o.map((function(e){return e.unit_name&&delete e.unit_name,e.unit_id&&delete e.unit_id,e.remaining_goods_num=e.goods_num,a.handleEdit({row:e,column:{property:"goods_num"}}),e})),a.$refs.xTable._proxy("loadData",o);break;case 2:o=o.map((function(e){e.batch||a.$set(e,"batch",a.getWeek()),a.$set(e,"remaining_goods_num",e.goods_num),e.goods_num&&delete e.goods_num;var t={num:"remaining_goods_num",price:"purchase_price",totalPrice:"subtotal_price"};return a.$publicFution.computeTotal(e,t,"remaining_goods_num",a),e})),a.tableData=o;break}}})).catch((function(e){console.log(e),a.loading=!1,a.$message({type:"error",message:"转单失败请重试"})}))}})}},d61d:function(e,a,t){},ed62:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[e._v("采购管理")]),t("el-breadcrumb-item",{staticClass:"attrbute"},[t("span",{on:{click:e.goBack}},[e._v("采购订单")])]),t("el-breadcrumb-item",[e._v(e._s(e.title)+"采购订单")])],1),t("div",{staticClass:"search_container"},[t("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params,rules:e.rules}},[t("el-form-item",{attrs:{label:"采购组织",size:"mini",rules:{required:!0,message:"请选择采购组织"},prop:"company_id"}},[t("erpCompanyList",{ref:"erpCompanyList",attrs:{fatherParams:e.params,disabled:e.disabled},on:{getList:e.getCompanyList,change:e.companyChange},model:{value:e.params.company_id,callback:function(a){e.$set(e.params,"company_id",a)},expression:"params.company_id"}})],1),t("el-form-item",{attrs:{label:"单据号",size:"mini"}},[t("el-input",{attrs:{disabled:e.order_sn_disabled,placeholder:"请输入"},model:{value:e.params.order_sn,callback:function(a){e.$set(e.params,"order_sn",a)},expression:"params.order_sn"}})],1),t("el-form-item",{attrs:{label:"来源单号",size:"mini"}},[t("el-input",{staticStyle:{cursor:"pointer"},attrs:{readonly:"readonly","suffix-icon":"el-icon-more"},nativeOn:{click:function(a){return e.quoteOrder.apply(null,arguments)}},model:{value:e.params.plan_sn,callback:function(a){e.$set(e.params,"plan_sn",a)},expression:"params.plan_sn"}})],1),t("el-form-item",{attrs:{label:"业务日期",size:"mini"}},[t("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.params.business_time,callback:function(a){e.$set(e.params,"business_time",a)},expression:"params.business_time"}})],1),t("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini",prop:"supplier_id"}},[t("el-select",{attrs:{clearable:"",maxlength:"100","filter-method":e.supplierListInvok,filterable:"",placeholder:"请选择"},on:{change:e.getRebatePrice,focus:e.supplierListInvok},model:{value:e.params.supplier_id,callback:function(a){e.$set(e.params,"supplier_id",a)},expression:"params.supplier_id"}},e._l(e.supplierList,(function(e){return t("el-option",{key:e.supplier_id,attrs:{label:e.supplier_name,value:e.supplier_id}})})),1)],1),e.warehouseRequired?t("el-form-item",{attrs:{label:"采购仓库",size:"mini",prop:"warehouse_id",rules:e.rules.warehouse_id}},[t("erpWarehouse",{attrs:{searchParams:{company_id:e.params.company_id},fatherParams:e.params},model:{value:e.params.warehouse_id,callback:function(a){e.$set(e.params,"warehouse_id",a)},expression:"params.warehouse_id"}})],1):t("el-form-item",{attrs:{label:"采购仓库",size:"mini"}},[t("erpWarehouse",{attrs:{searchParams:{company_id:e.params.company_id},fatherParams:e.params},model:{value:e.params.warehouse_id,callback:function(a){e.$set(e.params,"warehouse_id",a)},expression:"params.warehouse_id"}})],1),t("el-form-item",{attrs:{label:"订单类型",size:"mini",prop:"order_type",rules:{required:!0,message:"请选择订单类型"}}},[t("el-select",{attrs:{clearable:""},model:{value:e.params.order_type,callback:function(a){e.$set(e.params,"order_type",a)},expression:"params.order_type"}},[t("el-option",{attrs:{label:"普通订单",value:1}},[e._v("普通订单")]),t("el-option",{attrs:{label:"首配订单",value:2}},[e._v("首配订单")])],1)],1),t("el-form-item",{attrs:{label:"支付方式",size:"mini",prop:"pay_method",rules:{required:!0,message:"请选择支付方式"}}},[t("el-select",{attrs:{clearable:""},model:{value:e.params.pay_method,callback:function(a){e.$set(e.params,"pay_method",a)},expression:"params.pay_method"}},[t("el-option",{attrs:{label:"在线支付",value:1}},[e._v("在线支付")]),t("el-option",{attrs:{label:"线下支付",value:2}},[e._v("线下支付")])],1)],1),t("el-form-item",{attrs:{label:"部门",size:"mini"}},[e._v(" "+e._s(function(){0==e.params.department_id&&(e.params.department_id=null)}())+" "),t("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",disabled:e.disabled},on:{focus:e.DepartmentListInvok},model:{value:e.params.department_id,callback:function(a){e.$set(e.params,"department_id",a)},expression:"params.department_id"}},e._l(e.departmentList,(function(e){return t("el-option",{key:e.department_id,attrs:{label:e.department_name,value:e.department_id}})})),1)],1),t("el-form-item",{attrs:{label:"采购员",size:"mini",rules:e.rules.buyer_id,prop:"buyer_id"}},[t("erpEmployee",{attrs:{fatherParams:e.params,modelLabel:"buyer_name",title:"请选择采购员",disabled:e.disabled,searchParams:{company_id:e.params.company_id}},model:{value:e.params.buyer_id,callback:function(a){e.$set(e.params,"buyer_id",a)},expression:"params.buyer_id"}})],1),t("el-form-item",{attrs:{label:"付款方式",size:"mini"}},[e._v(" "+e._s(function(){0==e.params.receivables_mode_id&&(e.params.receivables_mode_id=null)}())+" "),t("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{focus:e.receivablesInvok},model:{value:e.params.receivables_mode_id,callback:function(a){e.$set(e.params,"receivables_mode_id",a)},expression:"params.receivables_mode_id"}},e._l(e.receivablesList,(function(e){return t("el-option",{key:e.receivables_mode_id,attrs:{label:e.receivables_mode_name,value:e.receivables_mode_id}})})),1)],1),t("el-form-item",{attrs:{label:"备注",size:"mini"}},[t("el-input",{attrs:{type:"text",placeholder:"请输入"},model:{value:e.params.remark,callback:function(a){e.$set(e.params,"remark",a)},expression:"params.remark"}})],1)],1)],1),t("div",{staticClass:"add_delet"},[e.onlyQuote?e._e():t("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",disabled:e.disabled,size:"mini"},on:{click:e.addF}},[e._v("增行")]),t("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:e.deleteF}},[e._v("删行")])],1),t("div",{staticClass:"table_container"},[t("xTable",{ref:"xTable",attrs:{"edit-rules":e.editRules,isEdit:e.isEdit,tableColumn:e.tableColumn,totalArray:["goods_num","subtotal_price"]}})],1),t("div",{staticClass:"refundauditFoot"},[e.params.add_user_name?t("span",[e._v("创建人："+e._s(e.params.add_user_name))]):t("span",[e._v("创建人："+e._s(e.username))]),t("span",[e._v("创建时间："+e._s(e.params.add_time))]),t("span",[e._v("审核人："+e._s(e.params.auditor_name))]),t("span",[e._v("审核时间："+e._s(e.params.auditor_time))]),t("span",[e._v("修改人："+e._s(e.params.update_user_name))]),t("span",[e._v("修改时间："+e._s(e.params.update_time))])]),t("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center","margin-top":"20px"}},[t("el-button",{on:{click:e.goBack}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.submit("ruleForm")}}},[e._v("确 定")])],1),e.dialogBillVisible?t("div",[t("el-dialog",{staticClass:"dialogForm",attrs:{"close-on-click-modal":!1,title:"引用采购计划单据",visible:e.dialogBillVisible,width:"70%"},on:{"update:visible":function(a){e.dialogBillVisible=a},close:e.closeDialog}},[t("source-bill",{attrs:{par:e.params},on:{closedialog:function(a){e.dialogBillVisible=!1},dialogformInline:e.dialogformInline}})],1)],1):e._e()],1)},s=[],i=t("0cfb8"),o=i["a"],_=(t("72d4"),t("2877")),l=Object(_["a"])(o,r,s,!1,null,"40a33c66",null);a["default"]=l.exports}}]);
//# sourceMappingURL=chunk-77c04c94.68a57a94.js.map