(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-032f2d8a"],{"2ef3":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"params"},[a("div",{attrs:{id:"leixin"}},[a("div",{staticClass:"search_container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"采购组织",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{focus:e.companyListInvok,change:e.companyChange},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"业务日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeValue,callback:function(t){e.timeValue=t},expression:"timeValue"}})],1),a("el-form-item",{attrs:{label:"单据号",size:"mini"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.params.refund_sn,callback:function(t){e.$set(e.params,"refund_sn",t)},expression:"params.refund_sn"}})],1),a("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini"}},[a("el-select",{attrs:{clearable:"",maxlength:"100","filter-method":e.supplierListInvok,filterable:"",placeholder:"请选择"},on:{change:e.supplierChangesave,focus:e.supplierListInvok},model:{value:e.params.supplier_id,callback:function(t){e.$set(e.params,"supplier_id",t)},expression:"params.supplier_id"}},e._l(e.supplierList,(function(e){return a("el-option",{key:e.supplier_id,attrs:{label:e.supplier_name,value:e.supplier_id}})})),1)],1),a("el-form-item",{attrs:{label:"来源单号",size:"mini"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.params.instorage_sn,callback:function(t){e.$set(e.params,"instorage_sn",t)},expression:"params.instorage_sn"}})],1),a("el-form-item",{attrs:{label:"仓库名称",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{focus:e.warehouseInvok,change:e.warehouseChange},model:{value:e.params.warehouse_id,callback:function(t){e.$set(e.params,"warehouse_id",t)},expression:"params.warehouse_id"}},e._l(e.warehouseList,(function(e){return a("el-option",{key:e.warehouse_id,attrs:{label:e.warehouse_name,value:e.warehouse_id}})})),1)],1),a("el-form-item",{attrs:{label:"货位名称",size:"mini"}},[a("el-select",{staticClass:"el_slect",attrs:{clearable:"",placeholder:"请选择",size:"mini"},on:{change:e.allocationChange,focus:e.InventoryInvok},model:{value:e.params.allocation_id,callback:function(t){e.$set(e.params,"allocation_id",t)},expression:"params.allocation_id"}},e._l(e.allocationInventoryList,(function(e){return a("el-option",{key:e.allocation_id,attrs:{label:e.allocation_name,value:e.allocation_id}})})),1)],1),a("el-form-item",{attrs:{label:"商品编号",size:"mini"}},[a("el-input",{attrs:{placeholder:"请输入",maxLength:"7",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.params.goods_id,callback:function(t){e.$set(e.params,"goods_id",t)},expression:"params.goods_id"}})],1),a("el-form-item",{attrs:{label:"商品名称",size:"mini"}},[a("el-input",{attrs:{placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch.apply(null,arguments)}},model:{value:e.params.goods_name,callback:function(t){e.$set(e.params,"goods_name",t)},expression:"params.goods_name"}})],1),a("el-form-item",{attrs:{label:"退货原因",size:"mini"}},[a("el-select",{attrs:{clearable:""},on:{focus:e.getReasonInvok,change:e.getReasonChange},model:{value:e.params.reason_id,callback:function(t){e.$set(e.params,"reason_id",t)},expression:"params.reason_id"}},e._l(e.reasonList,(function(e){return a("el-option",{key:e.reason_id,attrs:{label:e.reason_name,value:e.reason_id}})})),1)],1),a("el-form-item",{attrs:{label:"部门",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{focus:e.DepartmentListInvok,change:e.departmentChange},model:{value:e.params.department_id,callback:function(t){e.$set(e.params,"department_id",t)},expression:"params.department_id"}},e._l(e.departmentList,(function(e){return a("el-option",{key:e.department_id,attrs:{label:e.department_name,value:e.department_id}})})),1)],1),a("el-form-item",{attrs:{label:"采购员",size:"mini"}},[e._v(" "+e._s(function(){0==e.params.business_id&&(e.params.business_id=null)}())+" "),a("el-select",{attrs:{clearable:""},on:{focus:e.EmployeeListInvok,change:e.buyerChange},model:{value:e.params.business_id,callback:function(t){e.$set(e.params,"business_id",t)},expression:"params.business_id"}},e._l(e.employeeList,(function(e){return a("el-option",{key:e.employee_id,attrs:{label:e.employee_name,value:e.employee_id}})})),1)],1),a("el-form-item",{attrs:{label:"审核状态",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.params.auditor_status,callback:function(t){e.$set(e.params,"auditor_status",t)},expression:"params.auditor_status"}},[a("el-option",{attrs:{label:"全部",value:0}},[e._v("全部")]),a("el-option",{attrs:{label:"未审核",value:1}},[e._v("未审核")]),a("el-option",{attrs:{label:"已审核",value:2}},[e._v("已审核")]),a("el-option",{attrs:{label:"作废",value:3}},[e._v("作废")])],1)],1),a("el-form-item",{attrs:{label:"审核日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:""},model:{value:e.timeValue1,callback:function(t){e.timeValue1=t},expression:"timeValue1"}})],1),a("el-form-item",{attrs:{label:"工厂代码",size:"mini"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.params.factory_code,callback:function(t){e.$set(e.params,"factory_code",t)},expression:"params.factory_code"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"add_delet"},[a("el-dropdown",{attrs:{placement:"bottom-start"}},[a("span",{staticStyle:{cursor:"pointer",color:"#4e90e2"},attrs:{"split-button":""}},[a("el-button",{attrs:{plain:"",icon:"iconfont icon-daochu10",size:"mini"}},[e._v("导出")])],1),a("el-dropdown-menu",{staticStyle:{"margin-top":"10px"},attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(1)}}},[e._v("导出Excel文件")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(2)}}},[e._v("导出CSV逗号分隔")])],1)],1)],1),a("div",{staticClass:"table_container"},[a("xTable",{ref:"xTable",attrs:{ajax:{url:"getRefundGoodsList",params:e.params},footerMethod:e.footerMethod,tableColumn:e.tableColumn,xData:e.tableData},on:{getData:e.getTableData}})],1)]),a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:12}},[a("div",[e._v("生成时间："+e._s(e.addTIME))])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"textAr"},[e._v("制表人："+e._s(e.realname))])])],1)],1)},r=[],n=a("5530"),s=(a("4de4"),a("d3b7"),a("99af"),a("65b0")),o=a("2f62"),l=(a("d81d"),a("caad"),{data:function(){this.$createElement;return{footerData:{},tableColumn:[{type:"index",title:"序号",width:50},{title:"采购组织",field:"company_name",width:150},{title:"单据号",field:"refund_sn",width:160},{title:"供应商(厂家)",field:"supplier_name",width:150},{title:"商品编号",field:"goods_id",width:100},{title:"工厂代码",field:"factory_code",width:120},{title:"商品名称",field:"goods_name",width:500},{title:"年周/批次",field:"batch",width:100},{title:"生产日期",field:"production_time",width:150,slots:{header:function(e,t){e.row;return[t("el-tooltip",{class:"item",attrs:{content:"Bottom center",effect:"light"}},[t("p",{slot:"content"},["生产日期列后期将会隐藏，同时新增商品入库日期列"]),t("span",{class:"el-icon-question",style:"cursor:pointer;font-weight:bold;"},["生产日期"])])]}}},{title:"单位",field:"unit_name",width:130},{title:"退货数量",field:"goods_num",headerAlign:"right",align:"right",width:100},{title:"采购价格",field:"purchase_price",headerAlign:"right",align:"right",formatter:"priceFormatNone",width:100},{title:"退货小计",field:"goods_price",headerAlign:"right",align:"right",formatter:"priceFormatNone",width:100},{title:"税额",field:"revenue_price",headerAlign:"right",align:"right",formatter:"priceFormat",width:100},{title:"不含税金额",field:"no_revenue_price",showOverflow:!0,headerAlign:"right",formatter:"priceFormat",align:"right",width:100},{title:"仓库",field:"warehouse_name",width:132},{title:"货位",field:"allocation_name",width:100},{title:"退货原因",field:"reason_name",width:100},{title:"商品备注",field:"remark",width:100},{title:"单据备注",field:"rremark",width:100},{title:"来源单号（采购入库单号）",field:"instorage_sn",width:150},{title:"部门",field:"department_name",width:100},{title:"采购员",field:"buyer_name",width:100},{title:"业务日期",field:"business_time",width:130},{title:"单据时间",field:"add_time",width:130},{title:"创建人",field:"add_user_name",width:130},{title:"修改人",field:"update_user_name",width:130},{title:"修改时间",field:"update_time",width:130},{title:"审核状态",field:"auditor_status_name",width:130},{title:"审核人",field:"auditor_name",width:130},{title:"审核时间",field:"auditor_time",width:130}]}},methods:{footerMethod:function(e){var t=this,a=e.columns,i=e.data;return[a.map((function(e,a){if(1===a)return"合计";if(["goods_num","goods_price","no_revenue_price","revenue_price"].includes(e.property)){var r=t.$utils.sum(i,e.property);return"goods_num"===e.property?t.$publicFution.priceFormatNone(r,0):t.$publicFution.priceFormatNone(r)}return null})),a.map((function(e,a){return 1===a?"总计":"goods_num"===e.property&&void 0!==t.footerData.total_goods_num?t.footerData.total_goods_num:"goods_price"===e.property&&void 0!==t.footerData.total_goods_price?t.$publicFution.priceFormatNone(t.footerData.total_goods_price):"no_revenue_price"===e.property&&void 0!==t.footerData.sub_no_revenue_price?t.$publicFution.priceFormatNone(t.footerData.sub_no_revenue_price):"revenue_price"===e.property&&void 0!==t.footerData.sub_revenue_price?t.$publicFution.priceFormatNone(t.footerData.sub_revenue_price):null}))]},getTableData:function(e){200===e.data.code&&(this.footerData=e.data.data.desc)}}}),d={name:"purchaseRefundgoods",mixins:[l],data:function(){return{authority:{},timeValue1:[],defaultArea:[0],addTIME:this.$publicFution.formatData(new Date),realname:localStorage.realname,outerVisible:!1,searchParams:{},loading:!0,timeValue:[],is_shop:0}},computed:Object(n["a"])({},Object(o["c"])(["refundgoodsGet"])),methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])(["refundgoodsIndexAct"])),{},{supplierChangesave:function(e){e&&(this.params.supplier_name=this.supplierList.filter((function(t){return t.supplier_id===e}))[0].supplier_name)},buyerChange:function(e){e&&(this.params.buyer_name=this.employeeList.filter((function(t){return t.employee_id===e}))[0].employee_name)},warehouseChange:function(e){e&&(this.params.warehouse_name=this.warehouseList.filter((function(t){return t.warehouse_id===e}))[0].warehouse_name)},allocationChange:function(e){e&&(this.params.allocation_name=this.allocationInventoryList.filter((function(t){return t.allocation_id==e}))[0].allocation_name)},getReasonChange:function(e){e&&(this.params.reason_name=this.reasonList.filter((function(t){return t.reason_id==e}))[0].reason_name)},departmentChange:function(e){e&&(this.params.department_name=this.departmentList.filter((function(t){return t.department_id===e}))[0].department_name),this.$set(this.params,"business_id","")},exportOrder:function(e){Object.assign(this.params,{export_type:e});this.$axMethod.exportRefundGoodsListUrl(this.params).then((function(e){200==e.data.code&&(window.location.href=e.data.data.url)}))},companyChange:function(e){""!=e&&(this.params.company_name=this.companyList.filter((function(t){return t.company_id===e}))[0].company_name),this.$set(this.params,"supplier_id",""),this.$set(this.params,"business_id",""),this.$set(this.params,"department_id",""),this.$set(this.params,"allocation_id",""),this.$set(this.params,"warehouse_id","")},onReset:function(){this.defaultArea=[0],this.$set(this,"params",{auditor_status:0}),this.timeValue=[],this.timeValue1=[],this.onSearch()},onSearch:function(){this.timeValue?(this.params.start_time=this.timeValue[0],this.params.end_time=this.timeValue[1]):this.params.start_time=this.params.end_time="",this.timeValue1?(this.params.start_auditor_time=this.timeValue1[0],this.params.end_auditor_time=this.timeValue1[1]):this.params.start_auditor_time=this.params.end_auditor_time="",this.$refs.xTable._getData(1)}}),mounted:function(){if(this.authority=JSON.parse(localStorage.getItem("authority")),this.refundgoodsGet&&this.refundgoodsGet.params){if(this.$set(this,"params",this.refundgoodsGet.params),this.refundgoodsGet.params.start_time){var e=this.refundgoodsGet.params,t=e.start_time,a=e.end_time;this.timeValue=this.timeValue.concat([t,a])}Object.assign(this.refundgoodsGet.params,{employee_id:this.refundgoodsGet.params.business_id,employee_name:this.refundgoodsGet.params.buyer_name}),Object(s["l"])(this,this.refundgoodsGet.params)}else this.$set(this,"params",{auditor_status:0});this.onSearch()}},m=d,p=(a("5df6"),a("2877")),u=Object(p["a"])(m,i,r,!1,null,"708a6ba0",null);t["default"]=u.exports},"48c0":function(e,t,a){},"5df6":function(e,t,a){"use strict";a("48c0")}}]);
//# sourceMappingURL=chunk-032f2d8a.493e80f3.js.map