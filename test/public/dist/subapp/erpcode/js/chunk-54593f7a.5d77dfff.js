(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-54593f7a"],{"214a":function(e,a,t){"use strict";t("c640")},"4b83":function(e,a,t){},"5fef":function(e,a,t){"use strict";t("4b83")},"6c1a":function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"seePage"},[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[e._v("采购管理")]),t("el-breadcrumb-item",{staticClass:"attrbute"},[t("span",{on:{click:e.goBack}},[e._v("采购计划")])]),t("el-breadcrumb-item",[e._v("查看采购计划")])],1),t("div",{staticClass:"search_container"},[t("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[t("el-form-item",{attrs:{label:"采购组织",size:"mini"}},[e._v(" "+e._s(e.params.company_name)+" ")]),t("el-form-item",{attrs:{label:"单据号:",size:"mini"}},[e._v(" "+e._s(e.params.plan_sn)+" ")]),t("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini"}},[e._v(" "+e._s(e.params.supplier_name)+" ")]),t("el-form-item",{attrs:{label:"仓库名称",size:"mini"}},[e._v(" "+e._s(e.params.warehouse_name)+" ")]),t("el-form-item",{attrs:{label:"交货日期",size:"mini"}},[e._v(" "+e._s(e.params.requirement_delivery_time_name)+" ")]),t("el-form-item",{attrs:{label:"采购员",size:"mini",prop:"buyer_id"}},[e._v(" "+e._s(e.params.buyer_name)+" ")]),t("el-form-item",{attrs:{label:"所属部门",size:"mini"}},[e._v(" "+e._s(e.params.department_name)+" ")]),t("el-form-item",{attrs:{label:"收货状态",size:"mini"}},[e._v(" "+e._s(e.params.delivery_status_name)+" ")]),t("el-form-item",{attrs:{label:"审核状态",size:"mini"}},[e._v(" "+e._s(e.params.auditor_status_name)+" ")])],1)],1),t("div",{staticClass:"table_container"},[t("xTable",{ref:"xTable",attrs:{xData:e.tableData,isEdit:e.isEdit,tableColumn:e.tableColumn,totalArray:["goods_num","subtotal_price"]}})],1),t("div",[t("el-form",{ref:"paramsFooter",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[t("el-form-item",{staticStyle:{width:"900px"},attrs:{label:"单据备注：",size:"mini"}},[t("span",[e._v(e._s(e.params.remark))])]),t("br"),t("el-form-item",{attrs:{label:"创建人：",size:"mini"}},[t("el-input",{attrs:{maxlength:"100",disabled:""},model:{value:e.params.add_user_name,callback:function(a){e.$set(e.params,"add_user_name",a)},expression:"params.add_user_name"}})],1),t("el-form-item",{attrs:{label:"创建时间：",size:"mini"}},[t("el-input",{attrs:{maxlength:"100",disabled:""},model:{value:e.params.add_time_name,callback:function(a){e.$set(e.params,"add_time_name",a)},expression:"params.add_time_name"}})],1),t("el-form-item",{attrs:{label:"修改人：",size:"mini"}},[t("el-input",{attrs:{maxlength:"100",disabled:""},model:{value:e.params.update_user_name,callback:function(a){e.$set(e.params,"update_user_name",a)},expression:"params.update_user_name"}})],1),t("el-form-item",{attrs:{label:"修改时间：",size:"mini"}},[t("el-input",{attrs:{maxlength:"100",disabled:""},model:{value:e.params.update_time_name,callback:function(a){e.$set(e.params,"update_time_name",a)},expression:"params.update_time_name"}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[1==e.params.auditor_status?[1==e.authority.b_pass?t("el-button",{attrs:{type:"primary"},on:{click:e.shenHe}},[e._v("审 核")]):e._e(),1==e.authority.b_invalid?t("el-button",{on:{click:e.deletes}},[e._v("作 废")]):e._e()]:e._e(),2==e.params.auditor_status?[1==e.authority.b_invalid?t("el-button",{on:{click:e.deletes}},[e._v("作 废")]):e._e()]:e._e(),3==e.params.auditor_status||1!=e.authority.b_invalid&&1!=e.authority.b_pass?[t("el-button",{on:{click:e.goBack}},[e._v("返 回")])]:[t("el-button",{on:{click:e.goBack}},[e._v("取 消")])]],2)],1)},s=[],r=t("fe6e"),n={mixins:[r["c"]],name:"purchasePlanSee",data:function(){return{authority:{},tableData:[],chaid:!1,params:{}}},methods:{goBack:function(){this.$router.push({path:"/purchase/plan"})},shenHe:function(){var e=this;1!==this.params.is_jc?this.$axios({method:"post",url:this.$api.purchaseAuditorPass,data:{plan_id:this.plan_id}}).then((function(a){200==a.data.code&&(e.$message({message:a.data.msg?a.data.msg:a.data.data,type:"success"}),e.goBack())})):this.$message.error("对接集采的采购申请不可审核")},deletes:function(){var e=this;this.$axios({method:"post",url:this.$api.purchaseAuditorInvalid,data:{plan_id:this.plan_id}}).then((function(a){200==a.data.code&&(e.$message({message:a.data.msg?a.data.msg:a.data.data,type:"success"}),e.goBack())}))}},created:function(){var e=this;this.tableColumn=this.$publicFution.filterTableColumn(this.tableColumn),this.authority=JSON.parse(localStorage.getItem("authority")),this.$route.query&&this.$route.query.id&&(this.plan_id=this.$route.query.id,this.$axios({method:"get",url:this.$api.getPlanInfo,params:{plan_id:this.plan_id}}).then((function(a){200==a.data.code&&(e.tableData=a.data.data.goods_list,e.params=a.data.data.info,e.params.requirement_delivery_time=e.params.requirement_delivery_time_name)})))}},o=n,d=(t("214a"),t("5fef"),t("2877")),m=Object(d["a"])(o,i,s,!1,null,"45c08d82",null);a["default"]=m.exports},c640:function(e,a,t){},fe6e:function(e,a,t){"use strict";t.d(a,"b",(function(){return i})),t.d(a,"a",(function(){return s})),t.d(a,"c",(function(){return r}));t("d81d");var i={goods_id:"",goods_name:"",purchase_price:"",goods_num:"",goods_sn:"",subtotal_price:"",is_invoices:"",remark:""},s={remark:"",company_id:"",company_name:"",plan_sn:"",supplier_id:"",supplier_name:"",warehouse_id:"",warehouse_name:"",requirement_delivery_time:"",buyer_id:"",department_id:"",delivery_status_name:""},r={data:function(){var e=this;return{formRules:{company_id:[{required:!0,message:"请选择采购组织跟"}],warehouse_id:[{required:!0,message:"请选择仓库"}],requirement_delivery_time:[{required:!0,message:"请选择交货日期"}],buyer_id:[{required:!0,message:"请选择采购员"}]},editRules:{goods_num:[{required:!0,message:"数量输入请在0-99999999之间"}],goods_name:[{required:!0,message:"请选择商品"}],purchase_price:[{required:!0,message:"请输入采购价"}],purchase_total_price:[{required:!0,message:"请输入采购金额"}],is_invoices_name:[{required:!0,message:"请选择是否带票"}]},tableColumn:[{type:"checkbox",width:44,align:"center"},{title:"序号",type:"seq",width:50},{title:"商品编号",field:"goods_id",width:80},{title:"商品名称",field:"goods_name",width:400,editRender:{name:"vGoods",getParams:function(a){var t=a.row;return{params:{company_id:e.params.company_id},showObj:{goods_id:"商品编号",goods_name:"商品名称",unit_name:"单位",brand_name:"品牌",specification_type:"规格型号",factory_code:"工厂代码"},getIcon:function(){return t.goods_name?[{icon:"el-icon-close",title:"删除商品",iconMethod:function(){for(var e in t)t[e]=""}}]:[]}}},events:{change:function(a,t){var i=t.row;i.brand_name=a.brand_name,i.unit_name=a.unit_name,i.goods_id=a.goods_id,i.specification_type=a.specification_type,i.goods_sn=a.goods_sn,i.factory_code=a.factory_code,i.purchase_price=a.purchase_price,e.handleEdit({row:i,column:{property:"purchase_price"}})}}}},{title:"工厂代码",field:"factory_code",width:100},{title:"申请数量",field:"goods_num",width:132,headerAlign:"right",align:"right",editRender:{name:"number",autoselect:!0,events:{input:this.handleEdit}}},{title:"申请采购价",headerAlign:"right",align:"right",field:"purchase_price",width:132,editRender:{name:"Vinput",autoselect:!0,events:{input:this.handleEdit}}},{title:"申请金额",headerAlign:"right",align:"right",field:"subtotal_price",width:132,editRender:{name:"Vinput",autoselect:!0,events:{input:this.handleEdit}}},{title:"是否带票",field:"is_invoices_name",width:150,showOverflow:!0,editRender:{name:"vSelect",getParams:function(){return{modelKey:"is_invoices",list:[{value:1,label:"带票"},{value:2,label:"不带票"}]}}}},{title:"已收货数量",field:"delivery_num",width:132,headerAlign:"right",align:"right"},{title:"收货状态",field:"delivery_status_name",width:132},{title:"审批状态",field:"auditor_status_name",width:132},{title:"审批人",field:"auditor_user_name",width:132},{title:"审批时间",field:"auditor_time_name",width:160},{title:"商品备注",field:"remark",width:200,editRender:{name:"Vinput",formatter:"String"}}]}},methods:{handleEdit:function(e){var a=e.row,t=e.column,i={num:"goods_num",price:"purchase_price",goodsPrice:"subtotal_price"};this.$publicFution.computeTotal(a,i,t.property,this),this.$refs.xTable._proxy("updateFooter")},isEdit:function(e){var a=e.row;return!a.auditor_status||1===a.auditor_status||3===a.auditor_status||(this.$message.warning("只能修改未审核和驳回的单据行！"),!1)},deleteRow:function(){this.$refs.xTable._proxy("getSelectRecords").length?this.$refs.xTable._proxy("removeSelecteds"):this.$message.warning("请先选择要删除的商品！")},addRow:function(){if(void 0==this.params.company_id||""==this.params.company_id)return this.$message.error("请选择采购组织"),!1;this.isShowShopPop=!0},initTurnOrder:function(){var e=this,a=this.$route.params;a.transferType&&this.$axMethod.stockEarlyWarningChangeOrderInfo(a.portParams).then((function(a){var t=a.data;200===t.code&&(e.params.company_id=t.data.info.company_id,e.params.company_name=t.data.info.company_name,e.params.remark=t.data.info.abstract,e.params.requirement_delivery_time=new Date,t.data.goods_list.map((function(a){return e.handleEdit({row:a,column:{property:"goods_num"}}),a})),e.companyList=[{company_id:e.params.company_id,company_name:e.params.company_name}],e.$refs.xTable._proxy("loadData",t.data.goods_list))}))}}}}}]);
//# sourceMappingURL=chunk-54593f7a.5d77dfff.js.map