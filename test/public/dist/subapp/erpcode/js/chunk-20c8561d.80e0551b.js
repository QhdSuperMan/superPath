(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-20c8561d"],{c62d:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"params"},[a("div",{attrs:{id:"leixin"}},[a("div",{staticClass:"search_container"},[a("el-form",{ref:"filterFormRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"组织名称",size:"mini"}},[a("erpCompanyList",{attrs:{fatherParams:e.params},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}})],1),a("el-form-item",{attrs:{label:"厂家名称",size:"mini"}},[a("erpSupplier",{on:{change:function(t){return e.onSearch(1)}},model:{value:e.params.supplier_id,callback:function(t){e.$set(e.params,"supplier_id",t)},expression:"params.supplier_id"}})],1),a("el-form-item",{attrs:{label:"返利政策名称",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch(1)}},model:{value:e.params.rebate_policy_name,callback:function(t){e.$set(e.params,"rebate_policy_name",t)},expression:"params.rebate_policy_name"}})],1),a("el-form-item",{attrs:{label:"返利模式",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(t){return e.onSearch(1)}},model:{value:e.params.rebate_mode,callback:function(t){e.$set(e.params,"rebate_mode",t)},expression:"params.rebate_mode"}},[a("el-option",{attrs:{label:"全部",value:0}}),a("el-option",{attrs:{label:"满量返点",value:1}}),a("el-option",{attrs:{label:"短期促销",value:2}})],1)],1),a("el-form-item",{attrs:{label:"返利有效期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.policyDay,callback:function(t){e.policyDay=t},expression:"policyDay"}})],1),a("el-form-item",{attrs:{label:"返利周期",size:"mini"}},[a("cycleBox",{on:{change:function(t){return e.onSearch(1)}},model:{value:e.params.rebate_cycle,callback:function(t){e.$set(e.params,"rebate_cycle",t)},expression:"params.rebate_cycle"}})],1),a("el-form-item",{attrs:{label:"阶梯模式",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(t){return e.onSearch(1)}},model:{value:e.params.ladder_mode,callback:function(t){e.$set(e.params,"ladder_mode",t)},expression:"params.ladder_mode"}},[a("el-option",{attrs:{label:"全部",value:0}}),a("el-option",{attrs:{label:"无阶梯模式",value:1}}),a("el-option",{attrs:{label:"有阶梯模式",value:2}})],1)],1),a("el-form-item",{attrs:{label:"状态",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(t){return e.onSearch(1)}},model:{value:e.params.auditor_status,callback:function(t){e.$set(e.params,"auditor_status",t)},expression:"params.auditor_status"}},[a("el-option",{attrs:{label:"全部",value:0}}),a("el-option",{attrs:{label:"未审核",value:1}}),a("el-option",{attrs:{label:"已审核",value:2}}),a("el-option",{attrs:{label:"启用",value:4}}),a("el-option",{attrs:{label:"暂停",value:5}})],1)],1),a("el-form-item",{attrs:{label:"创建日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.createdDay,callback:function(t){e.createdDay=t},expression:"createdDay"}})],1),a("el-form-item",{attrs:{label:"创建人",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch(1)}},model:{value:e.params.add_user_name,callback:function(t){e.$set(e.params,"add_user_name",t)},expression:"params.add_user_name"}})],1),a("el-form-item",{attrs:{label:"审核日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.examineDay,callback:function(t){e.examineDay=t},expression:"examineDay"}})],1),a("el-form-item",{attrs:{label:"审核人",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",placeholder:"请输入",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSearch(1)}},model:{value:e.params.auditor_name,callback:function(t){e.$set(e.params,"auditor_name",t)},expression:"params.auditor_name"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.onSearch(1)}}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1),a("div",{staticClass:"add_delet"},[a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:function(t){return e.goAdd({})}}},[e._v("新增")]),1==e.authority.b_del?a("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.examination("删除")}}},[e._v("删除")]):e._e(),1==e.authority.b_pass?a("el-button",{attrs:{type:"primary",icon:"iconfont icon-pass",size:"mini"},on:{click:function(t){return e.examination("审核")}}},[e._v("审核")]):e._e(),1==e.authority.b_nopass?a("el-button",{staticClass:"addBtn",attrs:{plain:"",icon:"iconfont icon-fanshenhe",size:"mini"},on:{click:function(t){return e.examination("弃审")}}},[e._v("弃审")]):e._e(),1==e.authority.b_open?a("el-button",{attrs:{type:"primary",icon:"iconfont icon-pass",size:"mini"},on:{click:function(t){return e.examination("启用")}}},[e._v("启用")]):e._e(),1==e.authority.b_pause?a("el-button",{staticClass:"addBtn",attrs:{plain:"",icon:"iconfont icon-fanshenhe",size:"mini"},on:{click:function(t){return e.examination("暂停")}}},[e._v("暂停")]):e._e(),1==e.authority.b_export?a("el-dropdown",[a("span",{staticStyle:{cursor:"pointer",color:"#4e90e2"},attrs:{"split-button":""}},[a("el-button",{attrs:{plain:"",icon:"iconfont icon-daochu10",size:"mini"}},[e._v("导出")])],1),a("el-dropdown-menu",{staticStyle:{"margin-top":"10px"},attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(1)}}},[e._v("导出Excel文件")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(2)}}},[e._v("导出CSV逗号分隔")])],1)],1):e._e()],1),a("div",[a("xTable",{ref:"xTable",attrs:{ajax:{url:"getRebatePolicyListPurchase",params:e.params},tableColumn:e.tableColumn}})],1)])])},l=[],n=(a("d81d"),a("a15b"),{company_id:localStorage.getItem("company_id"),company_name:localStorage.getItem("company_name"),rebate_policy_name:"",rebate_mode:0,effective_start_time:"",effective_end_time:"",rebate_cycle:0,ladder_mode:0,auditor_status:0,add_start_time:"",add_end_time:"",add_user_name:"",auditor_start_time:"",auditor_end_time:"",auditor_name:""}),r={data:function(){var e=this,t=this.$createElement;return{tableColumn:[{type:"checkbox",width:44,align:"center",fixed:"left"},{field:"name",title:"操作",width:100,fixed:"right",slots:{default:function(a){return[t("el-button",{attrs:{size:"small",type:"text",disabled:1!==e.authority.b_info},on:{click:function(){return e.goDetail(a.row)}}},[" 查看 "]),t("el-button",{attrs:{size:"small",type:"text",disabled:!(1===a.row.auditor_status&&1===e.authority.b_edit)},on:{click:function(){return e.goAdd(a.row)}}},[" 修改  "])]}}},{title:"单据号",field:"rebate_policy_sn",width:170,slots:{default:function(a){return[t("a",{on:{click:function(){e.goDetail(a.row)}},attrs:{type:"text",size:"small"}},[a.row.rebate_policy_sn," "])]}}},{title:"组织名称",field:"company_name",width:160},{title:"厂家名称",field:"supplier_name",width:150},{title:"返利政策名称",field:"rebate_policy_name",width:120},{title:"返利模式",field:"rebate_mode_name",width:80},{title:"返利有效期",field:"effective_time",width:180},{title:"返利周期",field:"rebate_cycle_name",width:80,formatter:function(e){var t=e.row;return 2===t.rebate_mode?"":t.rebate_cycle_name}},{title:"阶梯模式",field:"ladder_mode_name",formatter:function(e){var t=e.row;return 2===t.rebate_mode?"":t.ladder_mode_name},width:100},{title:"状态",field:"auditor_status_name",headerAlign:"right",align:"right",width:80},{title:"创建时间",field:"add_time",width:160},{title:"创建人",field:"add_user_name",width:100},{title:"审核时间",field:"auditor_time",width:160},{title:"审核人",field:"auditor_name",width:100}]}}},o=a("f249"),s={mixins:[r],name:"shoplowPriceList",data:function(){return{policyDay:[],createdDay:[],examineDay:[],params:this.$publicFution.deepCopy(n)}},methods:{onReset:function(){this.policyDay=[],this.createdDay=[],this.examineDay=[],this.params=this.$publicFution.deepCopy(n),this.onSearch(1)},shopChange:function(e){this.params.goods_type_id=e[2]},examination:function(e){var t=this;if(0!==this.multipleSelection.length){var a,i=this.multipleSelection.map((function(e){return e.rebate_policy_id}));"审核"===e?a="auditorRebatePolicyPurchase":"弃审"===e?a="unAuditorRebatePolicyPurchase":"启用"===e?a="openRebatePolicyPurchase":"暂停"===e?a="pauseRebatePolicyPurchase":"删除"===e&&(a="delRebatePolicyPurchase"),this.$confirm("是否继续?","温馨提示！",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.$axios({method:"post",data:{rebate_policy_id:i.join(",")},url:t.$api[a]}).then((function(e){var a=e.data;200===a.code&&(t.onSearch(),t.$message.success(a.msg))}))})).catch((function(){}))}else this.$message.warning("请勾选单据！")},exportOrder:function(e){var t=Object.assign(this.params,{export_type:e});this.$axios({method:"get",url:this.$api.exportRebatePolicyUrl,params:t}).then((function(e){200==e.data.code&&(window.location.href=e.data.data.url)}))},getTime:function(e){return Array.isArray(e)?e:[]},onSearch:function(e){this.params.effective_start_time=this.getTime(this.policyDay)[0],this.params.effective_end_time=this.getTime(this.policyDay)[1],this.params.add_start_time=this.getTime(this.createdDay)[0],this.params.add_end_time=this.getTime(this.createdDay)[1],this.params.auditor_start_time=this.getTime(this.examineDay)[0],this.params.auditor_end_time=this.getTime(this.examineDay)[1],this.$refs.xTable._getData(e)},goDetail:function(e){this.$router.push({path:"/purchase/factoryPolicy/factoryPolicySee",query:{id:e.rebate_policy_id}})},goAdd:function(e){this.$router.push({path:"/purchase/factoryPolicy/factoryPolicyAdd",query:{id:e.rebate_policy_id}})}},components:{cycleBox:o["a"]},activated:function(){this.onSearch(window.goPage)}},c=s,d=a("2877"),u=Object(d["a"])(c,i,l,!1,null,null,null);t["default"]=u.exports},f249:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{placeholder:"请选择",clearable:"",disabled:e.disabled,filterable:""},on:{focus:e.getList,change:e.change},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.list,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)},l=[],n={name:"cycleBox",data:function(){return{list:[{value:0,label:"全部"},{value:1,label:"本月返"},{value:2,label:"本季返"},{value:3,label:"本半年返"},{value:4,label:"本年返"},{value:5,label:"次月返"},{value:6,label:"次季返"},{value:7,label:"次半年返"},{value:8,label:"次年返"}]}},props:{disabled:{type:Boolean,default:!1},hasAll:{type:Boolean,default:!0},value:null},created:function(){this.hasAll||this.list.shift()},methods:{getList:function(){},change:function(e){this.$emit("input",e),this.$emit("change",e)}}},r=n,o=a("2877"),s=Object(o["a"])(r,i,l,!1,null,null,null);t["a"]=s.exports}}]);
//# sourceMappingURL=chunk-20c8561d.80e0551b.js.map