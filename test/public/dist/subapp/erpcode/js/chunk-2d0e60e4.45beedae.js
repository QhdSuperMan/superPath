(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-2d0e60e4"],{"96b3":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search_container"},[a("el-form",{ref:"filterFormRef",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"采购组织",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{change:e.companyChange,focus:e.companyListInvok},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"业务日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:""},on:{change:e.change},model:{value:e.timeValue,callback:function(t){e.timeValue=t},expression:"timeValue"}})],1),a("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini"}},[a("el-select",{attrs:{clearable:"",maxlength:"100","filter-method":e.supplierChange,filterable:"",placeholder:"请选择"},on:{focus:e.supplier},model:{value:e.params.supplier_id,callback:function(t){e.$set(e.params,"supplier_id",t)},expression:"params.supplier_id"}},e._l(e.supplierList,(function(e){return a("el-option",{key:e.supplier_id,attrs:{label:e.supplier_name,value:e.supplier_id}})})),1)],1),a("el-form-item",{attrs:{label:"品牌名称",size:"mini"}},[a("getBrand",{model:{value:e.params.brand_id,callback:function(t){e.$set(e.params,"brand_id",t)},expression:"params.brand_id"}})],1),a("el-form-item",{attrs:{label:"商品名称",size:"mini"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.params.goods_name,callback:function(t){e.$set(e.params,"goods_name",t)},expression:"params.goods_name"}})],1),a("el-form-item",{attrs:{label:"出入库类型",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.params.type,callback:function(t){e.$set(e.params,"type",t)},expression:"params.type"}},[a("el-option",{attrs:{label:"采购入库",value:"1"}},[e._v("采购入库")]),a("el-option",{attrs:{label:"采购退货",value:"2"}},[e._v("采购退货")])],1)],1),a("el-form-item",{attrs:{label:"仓库",size:"mini"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{focus:e.warehouseInvok,change:e.warehouseChangeId},model:{value:e.params.warehouse_id,callback:function(t){e.$set(e.params,"warehouse_id",t)},expression:"params.warehouse_id"}},e._l(e.warehouseList,(function(e){return a("el-option",{key:e.warehouse_id,attrs:{label:e.warehouse_name,value:e.warehouse_id}})})),1)],1),a("el-form-item",{attrs:{label:"货位",size:"mini"}},[a("el-select",{attrs:{filterable:"",remote:"",clearable:""},on:{focus:e.InventoryInvok},model:{value:e.params.allocation_name,callback:function(t){e.$set(e.params,"allocation_name",t)},expression:"params.allocation_name"}},e._l(e.allocationInventoryList,(function(e){return a("el-option",{key:e.allocation_name,attrs:{placeholder:"请选择",label:e.allocation_name,value:e.allocation_name}})})),1)],1),a("el-form-item",{attrs:{label:"单据号",size:"mini"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.params.sn,callback:function(t){e.$set(e.params,"sn",t)},expression:"params.sn"}})],1),a("el-form-item",{attrs:{label:"部门",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{focus:e.DepartmentListInvok},model:{value:e.params.department_id,callback:function(t){e.$set(e.params,"department_id",t)},expression:"params.department_id"}},e._l(e.departmentList,(function(e){return a("el-option",{key:e.department_id,attrs:{label:e.department_name,value:e.department_id}})})),1)],1),a("el-form-item",{attrs:{label:"采购员",size:"mini"}},[a("el-select",{attrs:{filterable:""},on:{focus:e.EmployeeListInvok,change:e.businessIdChange},model:{value:e.params.buyer_id,callback:function(t){e.$set(e.params,"buyer_id",t)},expression:"params.buyer_id"}},e._l(e.employeeList,(function(e){return a("el-option",{key:e.employee_id,attrs:{label:e.employee_name,value:e.employee_id}})})),1)],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1)],1),1==e.authority.b_export&&e.listShow?a("div",{staticClass:"add_delet"},[a("el-dropdown",{attrs:{placement:"bottom-start"}},[a("span",{staticStyle:{cursor:"pointer",color:"#4e90e2"},attrs:{"split-button":""}},[a("el-button",{attrs:{plain:"",icon:"iconfont icon-daochu10",size:"mini"}},[e._v("导出")])],1),a("el-dropdown-menu",{staticStyle:{"margin-top":"10px"},attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(1)}}},[e._v("导出Excel文件")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.exportOrder(2)}}},[e._v("导出CSV逗号分隔")])],1)],1)],1):e._e(),e.listShow?a("div",{staticClass:"table_container"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableData.tableData,"max-height":e.tableHeight}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"company_name",label:"采购组织",width:"180"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"sn",label:"单据号",width:"180"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"supplier_name",label:"供应商(厂家)",width:"180"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"brand_name",label:"品牌名称",width:"180"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_id",label:"商品编号",width:"180"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_name",label:"商品名称","min-width":"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("pre",[e._v(e._s(t.row.goods_name))])]}}],null,!1,3380057349)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"batch",label:"年周/批次"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,"render-header":e.renderHeaderpro,property:"production_time",width:"80",label:"生产日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"type_name",label:"出入库类型",width:"100"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"warehouse_name",label:"出入库仓库",width:"132"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"allocation_name",label:"出入库货位",width:"100"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_num",label:"采购数量",align:"right"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"purchase_price",label:"采购单价",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("priceFormatNone")(t.row.purchase_price))+" ")]}}],null,!1,2978612185)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"subtotal_price",label:"采购金额",width:"120",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("priceFormatNone")(t.row.subtotal_price))+" ")]}}],null,!1,683613172)}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"department_name",label:"部门",width:"180"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"buyer_name",label:"采购员"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"business_time",label:"业务日期",width:"180"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"remark",label:"单据备注"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"g_remake",label:"商品备注"}})],1),a("div",{staticClass:"table_info"},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:12}},[a("div",[e._v("采购数量总计："+e._s(e.TableData.allList.all_num))])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"textAr"},[e._v("采购金额总计："+e._s(e._f("priceFormatNone")(e.TableData.allList.all_price)))])])],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:12}},[a("div",[e._v("生成时间："+e._s(e.TableData.allList.add_time))])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"textAr"},[e._v("制表人："+e._s(e.TableData.allList.add_user_name))])])],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:12}},[a("div",[e._v("业务日期起始:"+e._s(this.params.start_time))])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"textAr"},[e._v("业务日期起始:"+e._s(this.params.end_time))])])],1)],1),a("div",{staticClass:"page_container"},[a("div",{staticClass:"pageNumber"},[e._v("每页显示")]),a("el-pagination",{staticClass:"erp-pagination",attrs:{"current-page":e.goPage,"page-size":e.pageSize1,"page-sizes":e.per_page,layout:"total,sizes, prev, pager, next,jumper",prevText:"上一页",nextText:"下一页",total:e.TableData.total},on:{"size-change":e.handleSizeChange,"update:currentPage":function(t){e.goPage=t},"update:current-page":function(t){e.goPage=t},"current-change":e.handleCurrentChange}})],1)],1):e._e()])},s=[],r=a("ade3"),o=(a("4de4"),a("d3b7"),a("65b0")),i={name:"reportPurchasedetrpt",data:function(){var e;return e={authority:{},timeValue2:[],supplierList:[],params:{},searchParams:{},listShow:!1,timeValue:[],export_type:null,companyList:{},customerList:{options:[]},TableData:{allList:{},tableData:[]}},Object(r["a"])(e,"companyList",[]),Object(r["a"])(e,"goPage",1),Object(r["a"])(e,"pageSize",30),Object(r["a"])(e,"loading",!0),Object(r["a"])(e,"per_page",[30,50,100,500]),Object(r["a"])(e,"brandsList",[]),Object(r["a"])(e,"list",[]),Object(r["a"])(e,"tableHeight",600),e},methods:{renderHeaderpro:function(){var e=this.$createElement;return e("el-tooltip",{class:"item",attrs:{content:"Bottom center",effect:"light"}},[e("p",{slot:"content"},["生产日期列后期将会隐藏，同时新增商品入库日期列"]),e("span",{class:"el-icon-question",style:"cursor:pointer;font-weight:bold;"},["生产日期"])])},businessIdChange:function(e){""!=e&&(this.params.buyer_name=this.employeeList.filter((function(t){return t.employee_id===e}))[0].employee_name)},change:function(e){this.params.start_time=e[0],this.params.end_time=e[1]},change2:function(e){this.params.production_start_time=e[0],this.params.production_end_time=e[1]},supplierChange:function(e){var t={company_id:this.params.company_id,supplier_name:e};Object(o["n"])(this,t)},warehouseChangeId:function(e){this.$set(this.params,"allocation_name"," ")},exportOrder:function(e){if(0==this.listShow)return this.$message({message:"请查询需要导出的数据",type:"error"}),!1;Object.assign(this.params,{export_type:e});this.$axMethod.exportPurchaseDetailUrl(this.params).then((function(e){200==e.data.code&&(window.location.href=e.data.data.url)}))},companyChange:function(e){this.$set(this.params,"supplier_id",""),this.$set(this.params,"warehouse_id",""),this.$set(this.params,"department_id","")},supplier:function(){var e={company_id:this.params.company_id,supplier_name:null};Object(o["n"])(this,e)},onReset:function(){this.$set(this,"params",{}),this.timeValue=[],this.$set(this,"searchParams",{params:{},TableData:this.TableData,API:"getPurchaseDetailList",vm:this}),Object(o["g"])(this.searchParams,2)},onSearch:function(){this.listShow=!0,this.timeValue&&2==this.timeValue.length?(this.params.start_time=this.timeValue[0],this.params.end_time=this.timeValue[1]):this.params.start_time=this.params.end_time="",this.timeValue2&&2==this.timeValue2.length?(this.params.production_start_time=this.timeValue2[0],this.params.end_production_end_timetime=this.timeValue2[1]):this.params.production_start_time=this.params.production_end_time="",Object.assign(this.searchParams.params,this.params,{page:1}),Object(o["g"])(this.searchParams,2,o["o"].bind(this))},handleSizeChange:function(e){Object.assign(this.searchParams.params,{per_page:e,page:1}),Object(o["g"])(this.searchParams)},handleCurrentChange:function(e){Object.assign(this.searchParams.params,{page:e}),Object(o["g"])(this.searchParams)}},mounted:function(){this.authority=JSON.parse(localStorage.getItem("authority")),this.$set(this,"searchParams",{params:{},TableData:this.TableData,API:"getPurchaseDetailList",vm:this}),o["o"].bind(this)(),window.onresize=o["o"].bind(this)}},n=i,p=a("2877"),c=Object(p["a"])(n,l,s,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d0e60e4.45beedae.js.map