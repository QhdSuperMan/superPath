(window["webpackJsonp_erpcode"]=window["webpackJsonp_erpcode"]||[]).push([["chunk-5716a194"],{"25c5":function(e,t,a){},"555e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v(e._s(e.titles))]),a("el-breadcrumb-item",{staticClass:"attrbute"},[a("span",{on:{click:e.goBack}},[e._v("采购入库管理")])]),a("el-breadcrumb-item",[e._v(e._s(e.title)+"采购入库单")])],1),a("div",{staticClass:"search_container"},[a("el-form",{ref:"ruleForm",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"采购组织",size:"mini",prop:"company_id",rules:e.rules.company_id}},[a("erpCompanyList",{ref:"erpCompanyList",attrs:{fatherParams:e.params,disabled:e.disabled},on:{getList:e.getCompanyList,change:e.companyChange},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}})],1),a("el-form-item",{attrs:{label:"单据号",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",disabled:"disabled",placeholder:"请输入"},model:{value:e.params.instorage_sn,callback:function(t){e.$set(e.params,"instorage_sn",t)},expression:"params.instorage_sn"}})],1),a("el-form-item",{attrs:{label:"来源单据",size:"mini",prop:"instorage_sn"}},[a("el-input",{staticStyle:{cursor:"pointer"},attrs:{readonly:"readonly","suffix-icon":"el-icon-more"},nativeOn:{click:function(t){return e.quoteOrder.apply(null,arguments)}},model:{value:e.params.order_sn,callback:function(t){e.$set(e.params,"order_sn",t)},expression:"params.order_sn"}})],1),a("el-form-item",{attrs:{label:"业务日期",size:"mini",prop:"business_time",rules:e.rules.business_time}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.params.business_time,callback:function(t){e.$set(e.params,"business_time",t)},expression:"params.business_time"}})],1),a("el-form-item",{attrs:{label:"入库类型",size:"mini"}},[a("el-input",{attrs:{type:"text",maxlength:"300",value:"采购入库",disabled:"disabled"}})],1),e.warehouseRequired?a("el-form-item",{attrs:{label:"仓库名称",size:"mini",prop:"warehouse_id",rules:e.rules.warehouse_id}},[a("erpWarehouse",{attrs:{searchParams:{company_id:e.params.company_id,operation_type:e.$route.query.instorage_id?2:1},fatherParams:e.params},on:{change:e.warehouseChange},model:{value:e.params.warehouse_id,callback:function(t){e.$set(e.params,"warehouse_id",t)},expression:"params.warehouse_id"}})],1):a("el-form-item",{attrs:{label:"仓库名称",size:"mini"}},[a("erpWarehouse",{attrs:{searchParams:{company_id:e.params.company_id,operation_type:e.$route.query.instorage_id?2:1},fatherParams:e.params},on:{change:e.warehouseChange},model:{value:e.params.warehouse_id,callback:function(t){e.$set(e.params,"warehouse_id",t)},expression:"params.warehouse_id"}})],1),a("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini",prop:"supplier_id",rules:e.rules.supplier_id}},[a("el-select",{ref:"supplier",attrs:{clearable:"",maxlength:"100",disabled:e.disabled,"filter-method":e.supplierListInvok,filterable:"",placeholder:"请选择"},on:{focus:e.supplierListInvok,change:e.supplierChange},model:{value:e.params.supplier_id,callback:function(t){e.$set(e.params,"supplier_id",t)},expression:"params.supplier_id"}},e._l(e.supplierList,(function(e){return a("el-option",{key:e.supplier_id,attrs:{label:e.supplier_name,value:e.supplier_id}})})),1)],1),a("el-form-item",{attrs:{label:"部门",size:"mini"}},[e._v(" "+e._s(function(){0==e.params.department_id&&(e.params.department_id=null)}())+" "),a("el-select",{attrs:{clearable:"",placeholder:"请选择",filterable:"",disabled:e.disabled},on:{change:e.departmentChange,focus:e.DepartmentListInvok},model:{value:e.params.department_id,callback:function(t){e.$set(e.params,"department_id",t)},expression:"params.department_id"}},e._l(e.departmentList,(function(e){return a("el-option",{key:e.department_id,attrs:{label:e.department_name,value:e.department_id}})})),1)],1),a("el-form-item",{attrs:{label:"采购员",size:"mini"}},[a("erpEmployee",{attrs:{fatherParams:e.params,modelLabel:"buyer_name",title:"请选择采购员",disabled:e.disabled,searchParams:{company_id:e.params.company_id}},model:{value:e.params.buyer_id,callback:function(t){e.$set(e.params,"buyer_id",t)},expression:"params.buyer_id"}})],1),a("el-form-item",{attrs:{label:"付款方式",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{focus:e.receivablesInvok},model:{value:e.params.receivables_mode_id,callback:function(t){e.$set(e.params,"receivables_mode_id",t)},expression:"params.receivables_mode_id"}},e._l(e.receivablesList,(function(e){return a("el-option",{key:e.receivables_mode_id,attrs:{label:e.receivables_mode_name,value:e.receivables_mode_id}})})),1)],1),a("el-form-item",{attrs:{label:"其他费用",size:"mini"}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"金额"},on:{change:e.calcPrice},model:{value:e.params.other_price,callback:function(t){e.$set(e.params,"other_price",t)},expression:"params.other_price"}},[a("el-select",{staticClass:"styleInput",attrs:{slot:"prepend",clearable:""},on:{change:e.calcPrice},slot:"prepend",model:{value:e.params.other_price_type,callback:function(t){e.$set(e.params,"other_price_type",t)},expression:"params.other_price_type"}},e._l(e.otherPriceType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-form-item",{attrs:{label:"厂家发货单号",size:"mini"}},[a("el-input",{model:{value:e.params.factorysend_sn,callback:function(t){e.$set(e.params,"factorysend_sn",t)},expression:"params.factorysend_sn"}})],1),a("el-form-item",{attrs:{label:"厂家发货日期",size:"mini"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.params.factorysend_time,callback:function(t){e.$set(e.params,"factorysend_time",t)},expression:"params.factorysend_time"}})],1),a("el-form-item",{attrs:{label:"交货方式",size:"mini"}},[a("deliveryMethod",{model:{value:e.params.transaction_type,callback:function(t){e.$set(e.params,"transaction_type",t)},expression:"params.transaction_type"}})],1),a("el-form-item",{attrs:{label:"入库来源",size:"mini"}},[a("el-input",{attrs:{disabled:""},model:{value:e.params.instorage_source_name,callback:function(t){e.$set(e.params,"instorage_source_name",t)},expression:"params.instorage_source_name"}})],1)],1)],1),a("div",{staticClass:"add_delet"},[e.onlyQuote?e._e():a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini",disabled:e.disabled},on:{click:e.addRow}},[e._v("增行")]),a("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:e.deleteRow}},[e._v("删行")])],1),a("div",{staticClass:"table_container"},[a("xTable",{ref:"xTable",attrs:{isEdit:!0,toolConfig:e.tool_Config,showFooter:!0,footerMethod:e.footerMethod,xData:e.tableData,dragable:"","column-min-width":"100",tableColumn:e.tableColumn,isShowTool:!0,editConfig:{trigger:"click",mode:"cell",autoClear:!1,activeMethod:e.activeMethod}}})],1),a("div",[a("el-form",{ref:"paramsFooter",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{staticStyle:{width:"1000px"},attrs:{label:"单据备注：",size:"mini"}},[a("el-input",{staticStyle:{width:"800px"},model:{value:e.params.remark,callback:function(t){e.$set(e.params,"remark",t)},expression:"params.remark"}})],1),a("br"),a("el-form-item",{attrs:{label:"创建人：",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",disabled:""},model:{value:e.params.add_user_name,callback:function(t){e.$set(e.params,"add_user_name",t)},expression:"params.add_user_name"}})],1),a("el-form-item",{attrs:{label:"创建时间：",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",disabled:""},model:{value:e.params.add_time,callback:function(t){e.$set(e.params,"add_time",t)},expression:"params.add_time"}})],1),a("el-form-item",{attrs:{label:"修改人：",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",disabled:""},model:{value:e.params.update_user_name,callback:function(t){e.$set(e.params,"update_user_name",t)},expression:"params.update_user_name"}})],1),a("el-form-item",{attrs:{label:"修改时间：",size:"mini"}},[a("el-input",{attrs:{maxlength:"100",disabled:""},model:{value:e.params.update_time,callback:function(t){e.$set(e.params,"update_time",t)},expression:"params.update_time"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-button",{on:{click:e.goBack}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submit("ruleForm")}}},[e._v("确 定")])],1),e.dialogBillVisible?a("div",[a("el-dialog",{staticClass:"dialogForm",attrs:{"close-on-click-modal":!1,title:"引用采购订单单据",visible:e.dialogBillVisible,width:"1030px"},on:{"update:visible":function(t){e.dialogBillVisible=t},close:e.closeDialog}},[a("source-bill",{attrs:{par:e.params},on:{closedialog:e.closeDialog,dialogformInline:e.dialogformInline}})],1)],1):e._e()],1)},i=[],o=a("ea4d"),s=o["a"],n=(a("bfb3"),a("2877")),_=Object(n["a"])(s,r,i,!1,null,"617bafd2",null);t["default"]=_.exports},"6e62":function(e,t,a){"use strict";var r=a("5530"),i=(a("a9e3"),a("d3b7"),a("25f0"),a("159b"),a("d81d"),a("caad"),a("8ba4"),a("b680"),{data:function(){var e=this,t=this.$createElement;return{tableColumn:[{type:"checkbox",width:40},{type:"seq",title:"序号",width:50},{field:"goods_id",title:"商品编号",showOverflow:"tooltip",showHeaderOverflow:"tooltip",width:80},{width:60,title:"操作",fixed:"right",slots:{default:function(a){var r=a.row;return[t("i",{class:"el-icon-document",on:{click:function(){return e.copyLineFun(r)}},style:{cursor:"pointer",fontSize:"15px"}},[" "])]}}},{field:"goods_name",title:"商品名称",width:300,showOverflow:"tooltip",showHeaderOverflow:"tooltip",editRender:{name:"vGoods",getParams:function(t){return{params:{company_id:e.params.company_id,is_incomplete:0},showObj:{goods_id:"商品编号",goods_name:"商品名称",factory_code:"工厂代码",unit_name:"单位",brand_name:"品牌",specification_type:"规格型号",supply_mode_name:"供货方式",logogram:"助记码"},getIcon:function(){return t.row.goods_name?[{icon:"el-icon-close",title:"删除商品",iconMethod:function(){for(var e in t.row)t.row[e]=""}}]:[]}}},events:{change:this.changeGoods}}},{field:"batch",title:"年周/批次",showOverflow:"tooltip",showHeaderOverflow:"tooltip",width:150,visible:Boolean(!Number(localStorage.getItem("is_company_service"))),editRender:{autoselect:!0,name:"number",placeholder:"周周年年,如1421",events:{blur:this.blurChange}}},{field:"unit_name",showOverflow:"tooltip",showHeaderOverflow:"tooltip",title:"单位",width:80},{field:"instorage_type_name",showOverflow:"tooltip",title:"入库类型",width:200,editRender:{autoselect:!0,name:"vSelect",getParams:function(){return{modelKey:"instorage_type",list:[{label:"良品入库",value:1},{label:"不良品入库",value:2}]}},events:{change:function(t){var a=t.row;1===a.instorage_type&&(a.incomplete_reason=""),a.allocation_name="",a.allocation_id="",e.ListGoods(a)}}}},{field:"remaining_goods_num",title:"入库数量",showOverflow:"tooltip",showHeaderOverflow:"tooltip",editRender:{autoselect:!0,name:"number",events:{input:function(t){e.handleEdit(t.row,"remaining_goods_num",t.$rowIndex)}}}},{field:"purchase_price",title:"采购价",showOverflow:"tooltip",showHeaderOverflow:"tooltip",editRender:{autoselect:!0,name:"Vinput",events:{input:function(t){e.handleEdit(t.row,"purchase_price",t.$rowIndex)}}}},{field:"subtotal_price",title:"小计金额",showOverflow:"tooltip",showHeaderOverflow:"tooltip",editRender:{autoselect:!0,name:"Vinput",events:{input:function(t){e.handleEdit(t.row,"subtotal_price",t.$rowIndex)}}}},{field:"revenue_price",showOverflow:!0,title:"税额",editRender:{autoselect:!0,name:"Vinput",formatter:"Positive",events:{input:function(t){e.handleEdit(t.row,"revenue_price",t.$rowIndex)}}}},{field:"no_revenue_price",showOverflow:!0,title:"不含税金额"},{field:"other_price",title:"其他费用",showOverflow:"tooltip",showHeaderOverflow:"tooltip"},{field:"allocation_name",title:"货位",width:120,showOverflow:"tooltip",showHeaderOverflow:"tooltip",editRender:{name:"vAllocation",getParams:function(t){var a=t.row,i=e;return{url:"newAllocationListList",isPage:!0,params:Object(r["a"])(Object(r["a"])({},i.params),{},{goods_id:a.goods_id,is_incomplete:1==a.instorage_type?2:1})}},events:{change:this.allocationChange}}},{field:"guidance_price",title:"销售指导价",showOverflow:"tooltip",showHeaderOverflow:"tooltip",width:110,editRender:{autoselect:!0,name:"Vinput"}},{field:"factory_code",title:"工厂代码"},{field:"supply_mode_name",showOverflow:"tooltip",showHeaderOverflow:"tooltip",title:"供货方式"},{field:"incomplete_reason",title:"转不良品原因",width:250,showOverflow:"tooltip",showHeaderOverflow:"tooltip",editRender:{name:"Vinput",formatter:"String"}},{field:"remark",title:"备注",showOverflow:"tooltip",showHeaderOverflow:"tooltip",editRender:{name:"Vinput",formatter:"String"}}],tableData:[]}},methods:{addRow:function(){var e=this.$refs.xTable;e._proxy("createRow",{production_time:"",allocation_id:null,batch:this.getWeek()}).then((function(t){e._proxy("insertAt",t,-1)})),this.referenceDisabled=!0},allocationChange:function(e,t){var a=e.row;a.allocation_name=t.allocation_name},blurChange:function(e){var t=e.row;(4!=t.batch.toString().length||t.batch.toString().substr(0,2)>52||t.batch.toString().substr(2,2)>21)&&(this.$message.warning("年周/批次填写错误，标准格式：周周年年，如1421"),this.$set(t,"batch",""))},activeMethod:function(e){var t=e.row,a=e.column;return"goods_name"==a.property?this.params.company_id?!!this.params.warehouse_id||(this.$message.warning("请选择仓库名称！"),!1):(this.$message.warning("请选择组织！"),!1):"allocation_name"==a.property?this.params.warehouse_id?2!=t.instorage_type||(this.$message.warning("不良品货位不可修改"),!1):(this.$message.warning("请选择仓库名称！"),!1):"incomplete_reason"===a.property&&1==t.instorage_type?(this.$message.warning("良品入库不可填写"),!1):!!t.goods_id||(this.$message.warning("请先选择商品"),!1)},ListGoods:function(e){var t=this;this.$axMethod.newAllocationListList(Object(r["a"])(Object(r["a"])({},this.params),{},{is_incomplete:0,goods_id:e.goods_id})).then((function(a){var r=a.data;200==r.code&&r.data.forEach((function(a){2==e.instorage_type?1==a.is_incomplete&&(t.$set(e,"allocation_id",a.allocation_id),t.$set(e,"allocation_name",a.allocation_name)):1==a.is_system&&(t.$set(e,"allocation_id",a.allocation_id),t.$set(e,"allocation_name",a.allocation_name))}))}))},footerMethod:function(e){var t=this,a=e.columns,r=e.data;return[a.map((function(e,a){if(1===a)return"合计";if(["remaining_goods_num","subtotal_price","other_price"].includes(e.property)){if("remaining_goods_num"==e.property)return t.$utils.sum(r,e.property);var i=t.$utils.sum(r,e.property);return Number.isInteger(i)?i:i.toFixed(2)}return null}))]},deleteRow:function(){var e=this.$refs.xTable;e._proxy("removeSelecteds"),e._proxy("updateFooter")}}});t["a"]=i},"81d5":function(e,t,a){"use strict";var r=a("7b0b"),i=a("23cb"),o=a("07fa");e.exports=function(e){var t=r(this),a=o(t),s=arguments.length,n=i(s>1?arguments[1]:void 0,a),_=s>2?arguments[2]:void 0,l=void 0===_?a:i(_,a);while(l>n)t[n++]=e;return t}},"8ba4":function(e,t,a){var r=a("23e7"),i=a("eac5");r({target:"Number",stat:!0},{isInteger:i})},a4e2:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"search_container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[a("el-form-item",{attrs:{label:"采购组织",size:"mini"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择",disabled:"disabled"},model:{value:e.params.company_id,callback:function(t){e.$set(e.params,"company_id",t)},expression:"params.company_id"}},e._l(e.companyList,(function(t){return a("el-option",{key:t.company_id,attrs:{label:t.company_name,value:t.company_id}},[a("span",{class:1==t.type?"optionStyle":""},[e._v(e._s(t.company_name))])])})),1)],1),a("el-form-item",{attrs:{label:"业务日期",size:"mini"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.timeValue,callback:function(t){e.timeValue=t},expression:"timeValue"}})],1),a("el-form-item",{attrs:{label:"单据号",size:"mini"}},[a("el-input",{staticClass:"shortSearchInput",attrs:{placeholder:"请输入"},model:{value:e.params.order_sn,callback:function(t){e.$set(e.params,"order_sn",t)},expression:"params.order_sn"}})],1),a("el-form-item",{attrs:{label:"供应商(厂家)",size:"mini"}},[a("el-select",{attrs:{clearable:"",maxlength:"100",filterable:"",placeholder:"请选择"},model:{value:e.params.supplier_id,callback:function(t){e.$set(e.params,"supplier_id",t)},expression:"params.supplier_id"}},e._l(e.supplierList,(function(e){return a("el-option",{key:e.supplier_id,attrs:{label:e.supplier_name,value:e.supplier_id}})})),1)],1),a("el-form-item",{attrs:{label:"采购员",size:"mini",prop:"buyer_id"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{focus:e.EmployeeListInvok},model:{value:e.params.buyer_id,callback:function(t){e.$set(e.params,"buyer_id",t)},expression:"params.buyer_id"}},e._l(e.employeeList,(function(e){return a("el-option",{key:e.employee_id,attrs:{label:e.employee_name,value:e.employee_id}})})),1)],1),a("el-form-item",{staticStyle:{},attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.onReset}},[e._v("重置")])],1)],1),e._m(0),a("div",{staticClass:"table_container"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableData,"max-height":"300"},on:{"row-click":e.handleCurrentChanges}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"50",label:"选择"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{attrs:{label:t.row.order_id},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(e._s(null))])]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"order_sn",label:"单据号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"business_time",label:"业务日期"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"supplier_name",label:"供应商(厂家)"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"num",label:"采购数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"total_price",label:"采购金额总计"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"reference_num",label:"已入库数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"buyer_name",label:"采购员"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"add_user_name",label:"创建人"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"auditor_name",label:"审核人"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"remark",label:"备注"}})],1)],1),a("p",{staticStyle:{margin:"20px 0px","border-bottom":"1px dashed #e5e5e5"}}),e._m(1),a("div",{staticClass:"table_container"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"highlight-current-row":!0,"tooltip-effect":"light",border:"",data:e.TableDatas,"max-height":"300"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"selection",fixed:"left",align:"center",width:"44"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_id",label:"商品编号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_name",label:"商品名称"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,width:"50",property:"unit_name",label:"单位"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"purchase_price",label:"采购价"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"goods_num",label:"采购数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"old_subtotal_price",label:"采购金额小计"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"reference_goods_num",label:"已入库数量"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,property:"remark",label:"行备注"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.dialogCancelForm}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.dialogSubmitForm}},[e._v("确 定")])],1)],1)])},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add_delet"},[a("p",[e._v("【采购订单】单据列表")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"add_delet"},[a("p",[e._v("【采购订单】单据明细")])])}],o=a("65b0"),s={data:function(){return{params:{},searchParams:{},info:null,timeValue:[],multipleSelection:[],supplierList:[],companyList:[],TableData:[],TableDatas:[],radio:null,goPage:1,pageSize:30,per_page:[30,50,100,500],order_id:"",loading:!1}},methods:{onSearch:function(){this.timeValue&&2==this.timeValue.length?(this.params.start_time=this.timeValue[0],this.params.end_time=this.timeValue[1]):this.params.start_time=this.params.end_time="",Object(o["h"])(this,{API:"referencePurchaseOrderListPublics",params:this.params},"TableData")},handleSelectionChange:function(e){this.multipleSelection=e},onReset:function(){this.$set(this,"params",{}),this.$set(this.params,"company_id",this.par.company_id),this.timeValue=[],Object(o["h"])(this,{API:"referencePurchaseOrderListPublics",params:this.params},"TableData")},handleCurrentChanges:function(e){var t=this;this.radio=e.order_id,this.$axMethod.referenceOrderInfos({company_id:this.par.company_id,warehouse_id:this.par.warehouse_id,order_id:e.order_id}).then((function(e){var a=e.data;200==a.code&&(t.info=a.data.info,t.TableDatas=a.data.goods_list)}))},dialogCancelForm:function(){this.$emit("closedialog",!1)},dialogSubmitForm:function(){if(!this.multipleSelection.length)return this.$message.error("请勾选采购订单明细"),!1;var e={info:this.info,goods_list:this.multipleSelection};this.$emit("dialogformInline",e)}},props:["par"],mounted:function(){this.params={supplier_id:this.par.supplier_id,company_id:this.par.company_id,buyer_id:this.par.buyer_id,warehouse_id:this.par.warehouse_id},Object.assign(this.par,{employee_id:this.par.buyer_id,employee_name:this.par.buyer_name}),Object(o["h"])(this,{API:"referencePurchaseOrderListPublics",params:this.params},"TableData"),Object(o["l"])(this,this.par),Object.assign(this.employeeList,{employee_id:this.par.buyer_id,employee_name:this.par.buyer_name}),Object(o["e"])(this),Object(o["n"])(this,this.params),this.EmployeeListInvok()}},n=s,_=a("2877"),l=Object(_["a"])(n,r,i,!1,null,"3940f464",null);t["a"]=l.exports},b680:function(e,t,a){"use strict";var r=a("23e7"),i=a("da84"),o=a("e330"),s=a("5926"),n=a("408a"),_=a("1148"),l=a("d039"),c=i.RangeError,d=i.String,p=Math.floor,m=o(_),u=o("".slice),h=o(1..toFixed),f=function(e,t,a){return 0===t?a:t%2===1?f(e,t-1,a*e):f(e*e,t/2,a)},b=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},g=function(e,t,a){var r=-1,i=a;while(++r<6)i+=t*e[r],e[r]=i%1e7,i=p(i/1e7)},y=function(e,t){var a=6,r=0;while(--a>=0)r+=e[a],e[a]=p(r/t),r=r%t*1e7},v=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var r=d(e[t]);a=""===a?r:a+m("0",7-r.length)+r}return a},w=l((function(){return"0.000"!==h(8e-5,3)||"1"!==h(.9,0)||"1.25"!==h(1.255,2)||"1000000000000000128"!==h(0xde0b6b3a7640080,0)}))||!l((function(){h({})}));r({target:"Number",proto:!0,forced:w},{toFixed:function(e){var t,a,r,i,o=n(this),_=s(e),l=[0,0,0,0,0,0],p="",h="0";if(_<0||_>20)throw c("Incorrect fraction digits");if(o!=o)return"NaN";if(o<=-1e21||o>=1e21)return d(o);if(o<0&&(p="-",o=-o),o>1e-21)if(t=b(o*f(2,69,1))-69,a=t<0?o*f(2,-t,1):o/f(2,t,1),a*=4503599627370496,t=52-t,t>0){g(l,0,a),r=_;while(r>=7)g(l,1e7,0),r-=7;g(l,f(10,r,1),0),r=t-1;while(r>=23)y(l,1<<23),r-=23;y(l,1<<r),g(l,1,1),y(l,2),h=v(l)}else g(l,0,a),g(l,1<<-t,0),h=v(l)+m("0",_);return _>0?(i=h.length,h=p+(i<=_?"0."+m("0",_-i)+h:u(h,0,i-_)+"."+u(h,i-_))):h=p+h,h}})},bfb3:function(e,t,a){"use strict";a("25c5")},cb29:function(e,t,a){var r=a("23e7"),i=a("81d5"),o=a("44d2");r({target:"Array",proto:!0},{fill:i}),o("fill")},cf50:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("5530"),i=(a("d3b7"),a("159b"),a("b64b"),a("a9e3"),a("d81d"),a("2f62")),o=a("65b0"),s={data:function(){return{}},activated:function(){var e=this.$route.params;e.transferType&&this.portStockEarlyWarningChangeOrderInfo(e)},methods:Object(r["a"])(Object(r["a"])({},Object(i["b"])(["salesorderAdd"])),{},{getRebatePrice:function(){var e=this;this.params.supplier_id&&this.params.company_id&&this.$axMethod.getRebatePrice({brand_id:-1,supplier_id:this.params.supplier_id,company_id:this.params.company_id}).then((function(t){var a=t.data;200==a.code&&e.$set(e.params,"rebate_balance",a.data.rebate_balance)}))},turnSaleOrder:function(e){this.salesorderAdd({type:"采购单转销售订单",Buy_order:e,random:Math.floor(1e4*Math.random())}),this.$router.push({path:"/sales/salesorder/salesorderAdd"})},portStockEarlyWarningChangeOrderInfo:function(e){var t=this;this.loading=!0,this.$axMethod.stockEarlyWarningChangeOrderInfo(e.portParams).then((function(a){var r=a.data;if(t.loading=!1,200==r.code){var i=r.data.info,s=r.data.goods_list;switch(Object.keys(i).forEach((function(e){t.$set(t.params,e,i[e])})),t.params.remark=i.abstract,0==t.params.warehouse_id&&(t.params.warehouse_id=""),Number(localStorage.company_id)!=i.company_id?(t.$set(t.params,"department_id",""),t.$set(t.params,"buyer_id","")):t.params.department_id||(t.$set(t.params,"department_id",Number(localStorage.department_id)),t.$set(t.params,"buyer_id",Number(localStorage.employee_id))),Object(o["l"])(t,i),e.transferType){case 1:t.orderAddGet.order_id&&t.orderIndexACT({}),s=s.map((function(e){return e.unit_name&&delete e.unit_name,e.unit_id&&delete e.unit_id,e.remaining_goods_num=e.goods_num,t.handleEdit({row:e,column:{property:"goods_num"}}),e})),t.$refs.xTable._proxy("loadData",s);break;case 2:s=s.map((function(e){e.batch||t.$set(e,"batch",t.getWeek()),t.$set(e,"remaining_goods_num",e.goods_num),e.goods_num&&delete e.goods_num;var a={num:"remaining_goods_num",price:"purchase_price",totalPrice:"subtotal_price"};return t.$publicFution.computeTotal(e,a,"remaining_goods_num",t),e})),t.tableData=s;break}}})).catch((function(e){console.log(e),t.loading=!1,t.$message({type:"error",message:"转单失败请重试"})}))}})}},ea4d:function(module,__webpack_exports__,__webpack_require__){"use strict";var D_worker_project_MergeERP_erpcode_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("5530"),D_worker_project_MergeERP_erpcode_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("1da1"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("96cf"),regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(regenerator_runtime_runtime_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("4de4"),core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_filter_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("25f0"),core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("99af"),core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_concat_js__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_number_constructor_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("a9e3"),core_js_modules_es_number_constructor_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_number_constructor_js__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("d81d"),core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_array_map_js__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_json_stringify_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("e9c4"),core_js_modules_es_json_stringify_js__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_json_stringify_js__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_array_fill_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("cb29"),core_js_modules_es_array_fill_js__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_array_fill_js__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("caad"),core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_array_includes_js__WEBPACK_IMPORTED_MODULE_12__),_config_instorageAdd_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("6e62"),_chooseSourceBill__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("a4e2"),_components_element_purchase_purchaseorder_order_js_tableHead__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("cf50"),common_utils_public_function_commonUtils__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("65b0");__webpack_exports__["a"]={name:"purchaseInstorageAdd",mixins:[_config_instorageAdd_js__WEBPACK_IMPORTED_MODULE_13__["a"],_components_element_purchase_purchaseorder_order_js_tableHead__WEBPACK_IMPORTED_MODULE_15__["a"]],data:function(){return{warehouseRequired:!0,tool_Config:{id:"JYBDCGRK",zoom:!0,setting:{storage:!0,immediate:!0}},title:"添加",onlyQuote:!1,loading:!1,chaid:!1,params:{},options:{},hid:!1,dialogBillVisible:!1,rowIndex:"",disabled:!1,otherPriceType:[{value:0,label:"不分摊"},{value:1,label:"按金额分摊"},{value:2,label:"按数量分摊"}],rows:{},goodsList:[],list:[],checkAddLine:1,restaurants:[],timeout:null}},props:{titles:{type:String,default:"采购管理"},goBackUrl:{type:String,default:"/purchase/instorage"}},components:{sourceBill:_chooseSourceBill__WEBPACK_IMPORTED_MODULE_14__["a"]},methods:{getCompanyList:function(e,t){this.warehouseRequired=t.relation_company_id,this.$refs.ruleForm.clearValidate("warehouse_id")},supplierChange:function(){var e=this,t=this,a=this.$refs.xTable._proxy("getTableData").tableData.filter((function(e){return!!e.goods_id}));if(!a.length)return!1;this.$confirm("供应商(厂家)已更换, 是否替换商品当前单价?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=e.$refs.xTable;a._proxy("getTableData").fullData.forEach((function(e,a){e.purchase_price=0,t.handleEdit(e,"purchase_price",a)})),e.$refs.supplier.blur()})).catch((function(){e.$refs.supplier.blur()}))},warehouseChange:function(){var e=this;this.$refs.xTable._proxy("clearActived");var t=this.$refs.xTable;t._proxy("getTableData").fullData.forEach(function(){var t=Object(D_worker_project_MergeERP_erpcode_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a.allocation_id=null,a.allocation_name=null,!e.params.warehouse_id){t.next=5;break}return t.next=5,e.ListGoods(a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},departmentChange:function(){this.$set(this.params,"buyer_id","")},getWeek:function(){var e=new Date,t=new Date(e.getFullYear(),0,1),a=t.getDay(),r=1;0!=a&&(r=7-a+1),t=new Date(e.getFullYear(),0,1+r);var i=Math.ceil((e.valueOf()-t.valueOf())/864e5),o=2==String(Math.ceil(i/7)+1).length?Math.ceil(i/7)+1:"0".concat(Math.ceil(i/7)+1),s=e.getFullYear().toString().substring(2);return"".concat(o).concat(s)},changeGoods:function(e,t){var a=t.row;a.allocation_name="",a.allocation_id="",this.$set(a,"goods_id",e.goods_id),this.$set(a,"unit_name",e.unit_name),this.$set(a,"supply_mode_name",e.supply_mode_name),this.$set(a,"taxrate",e.taxrate),this.$set(a,"instorage_type",1),this.$set(a,"purchase_price",e.purchase_price?e.purchase_price:""),this.$set(a,"factory_code",e.factory_code),this.isClearOtherPrice(),this.params.warehouse_id&&this.ListGoods(t.row);var r=!0,i=this.$refs.xTable;i._proxy("getTableData").fullData.forEach((function(e){e.goods_id||(r=!1)})),r&&this.addRow()},goBack:function(){this.$publicFution.goPage(this.instorage_id),this.$router.push({path:this.goBackUrl})},isClearOtherPrice:function(){var e=this,t=this.$refs.xTable._proxy("getTableData").fullData;0==this.params.other_price_type&&t.forEach((function(a,r){e.$set(t[r],"other_price",0)}))},getCountApportionOptions:function(){var e=this;if(!Number(this.params.other_price)||!this.params.other_price_type)return!1;var t=this.$refs.xTable._proxy("getTableData").tableData.filter((function(e){return!!e.goods_id})),a=t.map((function(e){return e.goods_num=e.remaining_goods_num,e}));this.$axios({method:"post",url:this.$api.getCountApportionOptions,data:{other_price_type:this.params.other_price_type,other_price:this.params.other_price,goods_info:JSON.stringify(a)}}).then((function(t){var a=t.data;if(200==a.code){var r=a.data.goods_list,i=0;e.$refs.xTable._proxy("getTableData").fullData.forEach((function(e){e.goods_id&&e.subtotal_price&&(e.other_price=r[i].other_price,i++)})),e.$refs.xTable._proxy("updateFooter")}}))},copyLineFun:function(e){var t=Object.assign({},e,{instorage_goods_id:0});this.$refs.xTable._proxy("insertAt",t,-1),this.$refs.xTable._proxy("updateFooter")},calcPrice:function(){if(0==this.params.other_price&&0!=this.params.other_price_type)return this.$message.warning("分摊金额不能为0"),!1;var e=this.$refs.xTable._proxy("getTableData").tableData.filter((function(e){return e.goods_id}));e.length?(this.isClearOtherPrice(),this.getCountApportionOptions()):this.$message.warning("请先完善商品信息!")},quoteOrder:function(){if(!this.params.company_id)return this.$message.warning("请选择采购组织"),!1;var e=this.$refs.xTable._proxy("getTableData").fullData,t=e.filter((function(e){return e.goods_id}));if(t.length&&!this.disabled)return this.$message.warning("请删除表体所有商品行数据"),!1;this.dialogBillVisible=!0},closeDialog:function(){this.dialogBillVisible=!1},dialogformInline:function(e){var t=this;if(this.$refs.xTable._proxy("remove"),!(e.goods_list.length>0))return!1;this.disabled=!0,["order_sn","order_id","company_id","department_id","buyer_id","buyer_name","remark","supplier_id","supplier_name"].forEach((function(a){return t.$set(t.params,a,e.info[a])}));var a=e.goods_list.filter((function(e){return e.remaining_goods_num>0}));a=a.map((function(e){return t.handleEdit(e,"subtotal_price",111),Object.assign({},e,{batch:t.getWeek(),instorage_type:1,allocation_name:"",allocation_id:"",production_time:""})}));var r=e.info;Object.assign(r,{employee_id:e.info.buyer_id,employee_name:e.info.buyer_name}),Object(common_utils_public_function_commonUtils__WEBPACK_IMPORTED_MODULE_16__["l"])(this,r),this.InventoryInitialize(a);var i=this.$refs.xTable;i._proxy("insertAt",a,-1),this.$refs.xTable._proxy("updateFooter"),this.dialogBillVisible=!1,console.log(this.params)},InventoryInitialize:function(e){var t=new Array;e.forEach((function(e){t.push({allocation_id:e.allocation_id,allocation_name:e.allocation_name})}));var a={};t=t.reduce((function(e,t){return!a[t.allocation_id]&&(a[t.allocation_id]=e.push(t)),e}),[]),this.allocationList=t},companyChange:function companyChange(val){var _this7=this;this.$refs.xTable._proxy("remove"),this.$set(this.params,"department_id",""),this.$set(this.params,"buyer_id",""),this.$set(this.params,"supplier_id",""),this.$set(this.params,"warehouse_id",""),this.$baseData.settingInfo({num:3,company_id:val.company_id},(function(){if(localStorage.FDBName_business){var state=localStorage.getItem("FDBName_business");_this7.onlyQuote=1==eval(state)[6].status}})),this.getCompanyList([],val)},open:function(){var e=this;setTimeout((function(){e.$refs.childs.childAction()}),0)},submit:function(e){var t=this;this.$refs.xTable._proxy("clearActived");var a=this.$refs.xTable._proxy("getTableData").fullData;this.$refs[e].validate((function(e){if(e){if(!a.length)return t.$message.warning("请先选择商品！"),!1;var r=a.filter((function(e){return e.goods_id}));if(!r.length)return t.$message.warning({message:"请先选择商品"}),!1;for(var i=[],o=0;o<r.length;o++){if(!r[o].batch)return t.$message.warning({message:"【年周/批次】不可为空"}),!1;if(""===r[o].purchase_price)return t.$message.warning({message:"请输入采购价"}),!1;if(!r[o].remaining_goods_num)return t.$message.warning({message:"请输入入库数量"}),!1;if(2==r[o].instorage_type&&!r[o].incomplete_reason)return t.$refs.xTable._proxy("setActiveCell",r[o],"incomplete_reason"),t.$message.warning({message:"请输入不良原因"}),!1;i.push({taxrate:r[o].taxrate,revenue_price:r[o].revenue_price,no_revenue_price:r[o].no_revenue_price,goods_id:r[o].goods_id,order_goods_id:r[o].order_goods_id?r[o].order_goods_id:0,instorage_type:r[o].instorage_type,incomplete_reason:r[o].incomplete_reason,goods_num:r[o].remaining_goods_num,guidance_price:r[o].guidance_price,remark:r[o].remark?r[o].remark:"",instorage_goods_id:r[o].instorage_goods_id?r[o].instorage_goods_id:0,purchase_price:r[o].purchase_price,batch:r[o].batch,production_time:r[o].production_time,subtotal_price:r[o].subtotal_price,supply_mode:r[o].supply_mode,supply_mode_name:r[o].supply_mode_name,allocation_id:r[o].allocation_id?r[o].allocation_id:""})}var s={transaction_type:t.params.transaction_type,order_id:t.params.order_id,supplier_id:t.params.supplier_id,company_id:t.params.company_id,department_id:t.params.department_id,buyer_id:t.params.buyer_id,factorysend_sn:t.params.factorysend_sn,receivables_mode_id:t.params.receivables_mode_id,business_time:t.params.business_time,factorysend_time:t.params.factorysend_time,type:0,remark:t.params.remark,other_price:t.params.other_price,other_price_type:t.params.other_price_type,warehouse_id:t.params.warehouse_id,goods_info:JSON.stringify(i)};t.$baseData.checkComputation(i,{goods_num:"goods_num",total_price:"subtotal_price",goods_price:"purchase_price"}).then((function(){t.$baseData.checkCarDoctor({company_id:t.params.company_id,company_name:t.params.company_name,bill_type:1,bill_id:t.instorage_id,operation_type:t.instorage_id?2:1,goods_info:JSON.stringify(Array(i.length).fill({warehouse_id:t.params.warehouse_id,warehouse_name:t.params.warehouse_name}))}).then((function(){t.instorage_id?t.$axMethod.editInStorageList(Object(D_worker_project_MergeERP_erpcode_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__["a"])(Object(D_worker_project_MergeERP_erpcode_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__["a"])({},s),{},{instorage_id:t.params.instorage_id})).then((function(e){var a=e.data;200==a.code&&(t.$message({message:a.msg,type:"success"}),t.goBack())})):t.$axMethod.addInStoragetList(s).then((function(e){var a=e.data;200==a.code&&(t.is_company_service?t.$axios({method:"post",url:t.$api.purchaseAuditorPassInStorage,data:{instorage_id:a.data.instorage_id}}).then((function(e){200==e.data.code&&t.$message({message:e.data.data,type:"success"})})):t.$message({message:a.msg,type:"success"}),t.goBack())}))}))}))}}))},handleEdit:function(e,t,a){var r={num:"remaining_goods_num",price:"purchase_price",totalPrice:"subtotal_price",taxrate:"taxrate",revenue_price:"revenue_price",no_revenue_price:"no_revenue_price"};this.$publicFution.computeTotal(e,r,t,this),111!==a&&this.calcPrice(),this.$refs.xTable._proxy("updateFooter")},handleMouseEnter:function(e,t,a){a.children[0].children[1].style.color="black"},handleMouseOut:function(e,t,a){a.children[0].children[1].style.color="#ffffff"}},mounted:function mounted(){var _this10=this;if(this.title=this.$route.query.instorage_id?"修改":"添加",this.$route.query.instorage_id)this.instorage_id=this.$route.query.instorage_id,this.$axios({method:"get",url:this.$api.purchaseInfoInStorage,params:{instorage_id:this.instorage_id}}).then((function(e){if(200==e.data.code){_this10.params=e.data.data.instoragList;var t=e.data.data.instoragList;Object(common_utils_public_function_commonUtils__WEBPACK_IMPORTED_MODULE_16__["l"])(_this10,t),_this10.params.receivables_mode_id=0==e.data.data.instoragList.receivables_mode_id?"":e.data.data.instoragList.receivables_mode_id,_this10.InventoryInitialize(e.data.data.goodsList),_this10.tableData=e.data.data.goodsList,_this10.params.other_price_type=e.data.data.instoragList.other_price_type,""!=e.data.data.instoragList.order_sn&&(_this10.disabled=!0),_this10.$refs.erpCompanyList.getList()}}));else if(this.$route.query.order_id)this.$axMethod.referenceOrderInfos({order_id:this.$route.query.order_id}).then((function(e){var t=e.data;200==t.code&&(_this10.dialogformInline(t.data),_this10.params.business_time=_this10.$publicFution.formatData(new Date)),_this10.$refs.erpCompanyList.getList()}));else{var _localStorage=localStorage,employee_id=_localStorage.employee_id,company_admin_id=_localStorage.company_admin_id;[0,1,2].includes(Number(employee_id))||company_admin_id>0?this.$set(this,"params",{company_id:Number(localStorage.company_id),business_time:this.$publicFution.formatData(new Date)}):this.$set(this,"params",{company_id:Number(localStorage.company_id),department_id:Number(localStorage.department_id),buyer_id:Number(localStorage.employee_id),buyer_name:localStorage.employee_name,business_time:this.$publicFution.formatData(new Date)}),this.addRow(),Object(common_utils_public_function_commonUtils__WEBPACK_IMPORTED_MODULE_16__["l"])(this,localStorage),this.$refs.erpCompanyList.getList()}if(localStorage.FDBName_business){var state=localStorage.getItem("FDBName_business");this.onlyQuote=1==eval(state)[6].status}this.TableData.tableData.push({production_time:"",batch:this.getWeek()})}}},eac5:function(e,t,a){var r=a("861d"),i=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&i(e)===e}}}]);
//# sourceMappingURL=chunk-5716a194.1a073db4.js.map