(window["webpackJsonp_service"]=window["webpackJsonp_service"]||[]).push([["chunk-ede98254"],{"82cb":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[e._v("客户管理")]),t("el-breadcrumb-item",{staticClass:"attrbute"},[t("span",{on:{click:e.goBack}},[e._v("客户资料")])]),t("el-breadcrumb-item",[e._v(e._s(2==e.editType?"编辑":"新增")+"客户资料")])],1),t("div",{},[t("div",{},[t("el-form",{ref:"params",staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[t("el-form-item",{attrs:{label:"销售组织",size:"mini",prop:"company_id",rules:0==e.params.internal_company_id?e.rules.company_id:null}},[t("erpCompanyList",{ref:"erpCompanyList",attrs:{disabled:2==e.editType},on:{change:e.business,getList:e.getCompanyList},model:{value:e.params.company_id,callback:function(a){e.$set(e.params,"company_id",a)},expression:"params.company_id"}})],1),t("el-form-item",{attrs:{label:"客户名称",prop:"customer_name",rules:[{required:!0,message:"请输入客户名称",trigger:"blur"}]}},[t("el-input",{attrs:{placeholder:"请输入",maxlength:"25",size:"mini"},on:{change:e.customerNameBlur},model:{value:e.params.customer_name,callback:function(a){e.$set(e.params,"customer_name",a)},expression:"params.customer_name"}})],1),t("el-form-item",{attrs:{label:"联系人"}},[t("el-input",{attrs:{maxlength:"50",placeholder:"输入客户名称自动生成",size:"mini"},model:{value:e.params.contact_name,callback:function(a){e.$set(e.params,"contact_name",a)},expression:"params.contact_name"}})],1),t("el-form-item",{attrs:{label:"手机号码",prop:"customer_mobile",rules:2==e.params.customer_genre?[{required:!0,message:"请输入手机号码",trigger:"change"}]:null}},[t("el-input",{attrs:{size:"mini",placeholder:"请输入"},model:{value:e.params.customer_mobile,callback:function(a){e.$set(e.params,"customer_mobile",a)},expression:"params.customer_mobile"}})],1),t("el-form-item",{attrs:{label:"所属区域",size:"mini",prop:"cityList",rules:e.rules.areaadress}},[t("p",[t("getAreaList",{attrs:{filterable:!0,defaultArea:e.defaultArea},on:{change:e.changeDefaultArea}})],1)]),t("el-form-item",{attrs:{label:"详细地址",prop:"address",rules:[{required:!0,message:"请输入详细地址",trigger:"blur"}],size:"mini"}},[t("el-input",{attrs:{size:"mini",type:"text",placeholder:"请输入","suffix-icon":"el-icon-edit-outline",maxlength:300},model:{value:e.params.address,callback:function(a){e.$set(e.params,"address",a)},expression:"params.address"}})],1),t("el-form-item",{attrs:{label:"电话号码"}},[t("el-input",{attrs:{placeholder:"请输入",size:"mini"},model:{value:e.params.customer_phone,callback:function(a){e.$set(e.params,"customer_phone",a)},expression:"params.customer_phone"}})],1),t("el-form-item",{attrs:{label:"备用电话"}},[t("el-input",{attrs:{placeholder:"请输入",size:"mini"},model:{value:e.params.bak_phone,callback:function(a){e.$set(e.params,"bak_phone",a)},expression:"params.bak_phone"}})],1),t("el-form-item",{attrs:{label:"身份证号",prop:"id_card",rules:e.rules.id_card2}},[t("el-input",{attrs:{size:"mini",placeholder:"请输入"},model:{value:e.params.id_card,callback:function(a){e.$set(e.params,"id_card",a)},expression:"params.id_card"}})],1),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{attrs:{size:"mini",placeholder:"请输入"},model:{value:e.params.remark,callback:function(a){e.$set(e.params,"remark",a)},expression:"params.remark"}})],1)],1),e._m(0),t("div",{staticClass:"refundauditFoot"},[1==e.editType?t("span",[e._v("创建人："+e._s(e.employee_name))]):t("span",[e._v("创建人："+e._s(this.params.add_user_name))]),t("span",[e._v("创建时间："+e._s(this.params.add_time||""))]),t("span",[e._v("修改人："+e._s(this.params.update_user_name||""))]),t("span",[e._v("修改时间："+e._s(this.params.update_time||""))])])],1)]),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.goBack}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.submitForm("params")}}},[e._v("确 定")])],1)],1)},i=[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"specialBorderDiv"},[t("p",[e._v("注意")]),t("div",[t("span",[e._v("手机号码：")]),e._v("和电商打通的企业，建议最好输入客户手机号码，因为电商推送到ERP的单据，是以客户手机号匹配的，若匹配不到，ERP会自动创建以电商手机号为准的新客户；"),t("br"),t("div",[e._v("非和电商打通的企业，客户手机号可为空；")])])])}],r=t("1da1"),n=(t("96cf"),t("a15b"),t("a9e3"),t("4de4"),t("d3b7"),t("159b"),function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("span",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-cascader",{attrs:{props:e.props,placeholder:"请选择地区",options:e.allData,filterable:e.filterable,clearable:e.clearable},on:{change:e.change},model:{value:e.area,callback:function(a){e.area=a},expression:"area"}})],1)}),o=[],m={data:function(){return{allData:[],loading:!0,area:[],props:{value:"area_id",label:"area_name",children:"son"}}},props:{filterable:{type:Boolean,default:!1},clearable:{type:Boolean,default:!0},defaultArea:{type:Array,default:function(){return[]}}},methods:{change:function(e){this.$emit("change",e)},getData:function(){var e=this;this.$axios({method:"get",url:"v2/open/area/getAreaList",params:{is_area:1}}).then((function(a){var t=a.data;200==t.code&&(e.allData=t.data,e.loading=!1,e.area=e.defaultArea)}))}},created:function(){this.getData()}},c=m,p=t("2877"),l=Object(p["a"])(c,n,o,!1,null,null,null),d=l.exports,u={name:"customerinfoAdd",data:function(){return{InternalCompanyList:[],defaultArea:[],cityList:[],is_service:0,params:{is_disabled:0,internal_company_id:0,overdue_period:0,company_id:"",company_name:""},kuhulist:{options:[]},companyList:[],editType:1,province:{options:[]},city:{options:[]},area:{options:[]},customerType:{options:[]},isShowDefaultArea:!0,status:"add",employeeList:{options:[]},employee_name:localStorage.getItem("employee_name")}},components:{getAreaList:d},methods:{getv2getInternalCompanyList:function(){var e=this;this.$set(this,"InternalCompanyList",[]);var a={company_id:this.params.company_id,customer_id:this.$route.query.id,type:1};this.$axMethod.v2getInternalCompanyList(a).then((function(a){200==a.data.code&&e.$set(e,"InternalCompanyList",a.data.data)}))},radioChange:function(e){2!=e&&this.$refs["params"].clearValidate(["customer_mobile"])},customerNameBlur:function(e){var a=this;e&&(this.$set(this.params,"contact_name",e),this.$axios({url:this.$api.getJaneSpell,method:"get",params:{customer_name:e}}).then((function(e){200==e.data.code&&a.$set(a.params,"logogram",e.data.data)})))},customerSearch:function(e){var a=this;setTimeout((function(){a.$common.options("getCustomerTypeListOption",a.customerType,{company_id:a.params.company_id,customer_type_name:e})}),200),window.clearTimeout()},getCustomerTypeFoucs:function(){this.$common.options("getCustomerTypeListOption",this.customerType,{company_id:this.params.company_id})},getbusinIdFoucs:function(){this.$common.options("getEmployeeListOption",this.employeeList,{company_id:this.params.company_id})},changeDefaultArea:function(e){this.$set(this.params,"cityList",e.join(",")),this.params.province_id=e[0],this.params.city_id=e[1],this.params.area_id=e[2]},goBack:function(){this.$publicFution.goPage(this.$route.query.id),this.$router.back()},business:function(e){e&&(this.is_service=Number(e.is_service),2==this.params.customer_genre&&1!==this.is_service&&(this.params.customer_genre=0),this.params.company_name=e.company_name),this.$set(this.params,"business_id",null),this.$set(this.params,"customer_type_id",null)},changeProvinceAdd:function(){this.params.city_id="",this.$common.options("getAreaListOption",this.city,{level:3,p_id:this.params.province_id})},changeCityAdd:function(){this.$common.options("getAreaListOption",this.area,{level:4,p_id:this.params.city_id})},submitForm:function(e){var a=this,t=this;this.$refs[e].validate((function(e){e&&(t.params.customer_id?a.$axMethod.customEditCustomer(t.params).then((function(e){300==e.data.code?a.$confirm(e.data.msg,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.$axMethod.customEditCustomer(Object.assign({},t.params,{can_disable:1})).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(200!=t.data.code){e.next=4;break}return e.next=3,a.$message({message:t.data.msg,type:"success"});case 3:a.goBack();case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}())})):200==e.data.code&&(a.$message({message:e.data.msg,type:"success"}),a.goBack())})):t.$axios({method:"post",url:t.$api.addCustomer,data:t.params}).then((function(e){200==e.data.code&&(a.$message({message:e.data.msg,type:"success"}),a.goBack())})))}))},getCompanyList:function(e){var a=this,t=e.filter((function(e){return e.company_id===Number(a.params.company_id)}))[0];t&&(this.is_service=t.is_service)}},mounted:function(){var e=this;if(void 0!=this.$route.query.id){this.editType=2;var a=this;this.$axios({method:"get",url:this.$api.getCustomerInfo,params:{customer_id:this.$route.query.id,associated_customer_id:this.$route.query.associated_customer_id}}).then((function(t){var s=t.data;if(200==s.code){a.params=s.data,a.params.is_disabled=s.data.is_disabled,a.params.customer_genre=s.data.customer_genre;var i=[];s.data.internal_company.forEach((function(e){i.push(e.company_id)})),e.$set(e.params,"internal_company_id",i),e.$set(e,"InternalCompanyList",s.data.internal_company),e.defaultArea=[s.data.province_id,s.data.city_id,s.data.area_id],e.companyList=[{company_name:a.params.company_name,company_id:a.params.company_id}],e.customerType.options=[{customer_type_name:a.params.customer_type_name,customer_type_id:a.params.customer_type_id}],e.employeeList.options=[{employee_name:a.params.business_name,employee_id:a.params.business_id}],e.params.cityList=e.defaultArea.join(","),e.params.province_id=e.defaultArea[0],e.params.city_id=e.defaultArea[1],e.params.area_id=e.defaultArea[2],e.$refs.erpCompanyList.getList()}})),this.$common.options("getAreaListOption",this.city,{level:3,p_id:this.params.province_id}),this.$common.options("getAreaListOption",this.area,{level:4,p_id:this.params.city_id}),this.isShowDefaultArea=!1}else this.$set(this.params,"customer_genre",0),this.$axios({url:this.$api.getSon2CompanyInfo,method:"get",params:{}}).then((function(a){200==a.data.code&&(e.defaultArea=[a.data.data.province,a.data.data.city,a.data.data.area],e.params.cityList=e.defaultArea.join(","),e.params.province_id=e.defaultArea[0],e.params.city_id=e.defaultArea[1],e.params.area_id=e.defaultArea[2])})),this.params.company_id=Number(localStorage.company_id),this.$refs.erpCompanyList.getList()},beforeDestroy:function(){window.clearTimeout()}},_=u,h=(t("99d9"),t("de46"),Object(p["a"])(_,s,i,!1,null,null,null));a["default"]=h.exports},"99d9":function(e,a,t){"use strict";t("f405")},c285:function(e,a,t){},de46:function(e,a,t){"use strict";t("c285")},f405:function(e,a,t){}}]);
//# sourceMappingURL=chunk-ede98254.869f6629.js.map