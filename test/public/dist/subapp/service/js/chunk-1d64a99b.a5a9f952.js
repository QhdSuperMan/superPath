(window["webpackJsonp_service"]=window["webpackJsonp_service"]||[]).push([["chunk-1d64a99b"],{"4c53":function(t,e,a){"use strict";var i=a("23e7"),r=a("857a"),o=a("af03");i({target:"String",proto:!0,forced:o("sub")},{sub:function(){return r(this,"sub","","")}})},"64d9":function(t,e,a){"use strict";a("b1c7")},"857a":function(t,e,a){var i=a("e330"),r=a("1d80"),o=a("577e"),l=/"/g,s=i("".replace);t.exports=function(t,e,a,i){var n=o(r(t)),m="<"+e;return""!==a&&(m+=" "+a+'="'+s(o(i),l,"&quot;")+'"'),m+">"+n+"</"+e+">"}},a4c1:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"goodsattribute"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isShowAttr,expression:"!isShowAttr"}],attrs:{id:"leixin"}},[a("div",{staticClass:"search_container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params}},[a("el-form-item",{attrs:{label:"类型名称",size:"mini"}},[a("el-input",{model:{value:t.params.goods_type_name,callback:function(e){t.$set(t.params,"goods_type_name",e)},expression:"params.goods_type_name"}})],1),a("el-form-item",{attrs:{label:"类型编号",size:"mini"}},[a("el-input",{model:{value:t.params.goods_type_id,callback:function(e){t.$set(t.params,"goods_type_id",e)},expression:"params.goods_type_id"}})],1),a("el-form-item",{attrs:{label:"助记码",size:"mini"}},[a("el-input",{model:{value:t.params.logogram,callback:function(e){t.$set(t.params,"logogram",e)},expression:"params.logogram"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.onSearch(1)}}},[t._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:t.onReset}},[t._v("重置")])],1)],1)],1),a("div",{staticClass:"add_delet"},[1==t.authority.b_add?a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:t.getTypelist}},[t._v("新增 ")]):t._e(),1==t.authority.b_del?a("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:t.delFun}},[t._v("删除 ")]):t._e()],1),a("div",{staticClass:"table_container"},[a("xTable",{ref:"xTable",attrs:{ajax:{url:"getTypeList",params:t.params},tableColumn:t.tableColumn,"cell-class-name":t.cellClassName}})],1),a("el-dialog",{attrs:{"close-on-click-modal":!1,title:"商品类型管理",center:"",visible:t.dialogFormVisible,width:"25%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"typeForm",staticClass:"errorItem errorItemMl121",attrs:{model:t.typeForm},model:{value:t.typeForm,callback:function(e){t.typeForm=e},expression:"typeForm"}},[a("el-form-item",{attrs:{label:"上级分类"}},[a("el-cascader",{attrs:{placeholder:"选择分类",clearable:!0,options:t.levelData,changeOnSelect:!0},model:{value:t.typeForm.level,callback:function(e){t.$set(t.typeForm,"level",e)},expression:"typeForm.level"}})],1),a("el-form-item",{attrs:{label:"类型名称",prop:"goods_type_name",rules:{required:!0,message:"请输入类型名称",trigger:"blur"}}},[a("el-input",{model:{value:t.typeForm.goods_type_name,callback:function(e){t.$set(t.typeForm,"goods_type_name",e)},expression:"typeForm.goods_type_name"}})],1),a("el-form-item",{attrs:{label:"备注",size:"medium"}},[a("el-input",{attrs:{type:"text",maxlength:"300",placeholder:"请输入"},model:{value:t.typeForm.remark,callback:function(e){t.$set(t.typeForm,"remark",e)},expression:"typeForm.remark"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){return t.cancelForm("typeForm")}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("typeForm")}}},[t._v("确 定")])],1)],1)],1),t.isShowAttr?a("attribute",{attrs:{currentRow:t.currentRow},on:{close:t.closeAttribute}}):t._e()],1)},r=[],o=(a("4c53"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[t._v("系统管理")]),a("el-breadcrumb-item",[t._v("基础信息")]),a("el-breadcrumb-item",[t._v("商品基本信息")]),a("el-breadcrumb-item",{staticClass:"attrbute"},[a("span",{on:{click:t.close}},[t._v("类型管理")])]),a("el-breadcrumb-item",[t._v("属性设置")])],1),a("div",{staticClass:"search_container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.params}},[a("el-form-item",{attrs:{label:"组织名称",size:"mini"}},[a("erpCompanyList",{attrs:{fatherParams:t.params,clearable:!1},model:{value:t.params.company_id,callback:function(e){t.$set(t.params,"company_id",e)},expression:"params.company_id"}})],1),a("el-form-item",{attrs:{label:"属性名称",size:"mini"}},[a("el-input",{attrs:{clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.params.attribute_name,callback:function(e){t.$set(t.params,"attribute_name",e)},expression:"params.attribute_name"}})],1),a("el-form-item",{staticClass:"search-style search",attrs:{size:"mini"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.onSearch}},[t._v("查询")]),a("el-button",{attrs:{plain:"",size:"mini"},on:{click:t.onReset}},[t._v("重置")])],1)],1),a("div",{staticClass:"add_delet"},[a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",type:"primary",size:"mini"},on:{click:t.add}},[t._v("新增")]),a("el-button",{attrs:{plain:"",icon:"el-icon-delete",size:"mini"},on:{click:t.attrDelFun}},[t._v("删除")])],1)],1),a("div",{staticClass:"table_container"},[a("xTable",{ref:"xTable",attrs:{tableColumn:t.tableColumn,xData:t.attrTableData}})],1),t.attrVisible?a("div",{staticClass:"attrVisible"},[a("el-dialog",{staticClass:"dialogForm",attrs:{"close-on-click-modal":!1,title:"属性设置",visible:t.attrVisible,width:"500px"},on:{"update:visible":function(e){t.attrVisible=e},close:function(e){t.attrVisible=!1}}},[a("el-form",{ref:"attrForm",attrs:{model:t.attrForm,"label-width":"150px",size:"mini"}},[t.attrForm.is_system?a("el-form-item",{attrs:{label:"组织名称",size:"mini"}},[a("erpCompanyList",{attrs:{fatherParams:t.attrForm,disabled:t.attrForm.goods_type_id},model:{value:t.attrForm.company_id,callback:function(e){t.$set(t.attrForm,"company_id",e)},expression:"attrForm.company_id"}})],1):a("el-form-item",{attrs:{label:"组织名称",size:"mini",prop:"company_id",rules:{required:!0,message:"请选择公司",trigger:"change"}}},[a("erpCompanyList",{attrs:{fatherParams:t.attrForm,disabled:t.attrForm.goods_type_id},model:{value:t.attrForm.company_id,callback:function(e){t.$set(t.attrForm,"company_id",e)},expression:"attrForm.company_id"}})],1),a("el-form-item",{staticClass:"el-form-item_shortInput",attrs:{label:"属性名称",prop:"attribute_name",rules:{required:!0,message:"请输入属性名称",trigger:"blur"}}},[a("el-input",{attrs:{placeholder:"请输入",disabled:t.isUpdate},model:{value:t.attrForm.attribute_name,callback:function(e){t.$set(t.attrForm,"attribute_name",e)},expression:"attrForm.attribute_name"}})],1),a("el-form-item",{staticClass:"el-form-item_shortInput",attrs:{label:"排序",prop:"sort",rules:{required:!0,label:"排序",validator:t.$publicFution.isInt,trigger:"blur"}}},[a("el-input",{attrs:{type:"number",placeholder:"请输入"},model:{value:t.attrForm.sort,callback:function(e){t.$set(t.attrForm,"sort",e)},expression:"attrForm.sort"}})],1),a("el-form-item",{attrs:{label:"是否必填项",size:"medium",disabled:t.isUpdate}},[a("el-radio-group",{model:{value:t.attrForm.is_required,callback:function(e){t.$set(t.attrForm,"is_required",e)},expression:"attrForm.is_required"}},[a("el-radio",{attrs:{label:1}},[t._v("是")]),a("el-radio",{attrs:{label:0}},[t._v("否")])],1)],1),a("p",{staticClass:"form-line"}),a("p",{staticStyle:{"margin-bottom":"18px","text-align":"center"}},[a("el-button",{staticClass:"addBtn",attrs:{icon:"el-icon-circle-plus-outline",disabled:t.isUpdate,type:"primary",size:"mini"},on:{click:t.addAttributeFun}},[t._v("添加可选值")])],1),t._l(t.attrForm.attriValueData,(function(e,i){return a("el-form-item",{key:i,staticClass:"el-form-item_shortInput",attrs:{label:"可选值",prop:"attriValueData."+i+".attribute_value_name",rules:{validator:t.checkAttr,trigger:"change"}}},[a("el-input",{staticClass:"shortInput",attrs:{disabled:e.is_quote||t.isUpdate,placeholder:"0-99"},model:{value:e.attribute_value_name,callback:function(a){t.$set(e,"attribute_value_name",a)},expression:"attri.attribute_value_name"}}),a("el-button",{staticClass:"delAttriBute",attrs:{plain:"",disabled:e.is_quote||t.isUpdate,size:"mini"},on:{click:function(e){return t.attrForm.attriValueData.splice(i,1)}}},[t._v("删除")])],1)}))],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.attrVisible=!1}}},[t._v("取 消")]),a("el-button",{staticClass:"tx",attrs:{type:"primary"},on:{click:function(e){return t.submitAttrForm("attrForm")}}},[t._v("确 定")])],1)],1)],1):t._e()],1)])}),l=[],s=(a("a9e3"),a("d3b7"),a("25f0"),a("99af"),a("ac1f"),a("00b4"),a("a15b"),a("159b"),a("4e82"),a("e9c4"),{data:function(){var t=this,e=this.$createElement;return{tableColumn:[{type:"checkbox",width:44,align:"center"},{title:"序号",type:"index",width:80,align:"center"},{title:"属性名称",field:"attribute_name"},{title:"属性值",field:"attribute_value",width:300},{title:"是否必填",field:"logogram",formatter:function(t){var e=t.row;return"1"==e.is_required?"是":"否"},width:300},{field:"name",title:"操作",width:300,slots:{default:function(a){return[e("el-button",{attrs:{size:"small",type:"text",disabled:1==a.row.is_system},on:{click:function(){return t.attrUpdateRow(a.row)}}},[" 修改 "])]}}}]}}}),n={name:"attribute",mixins:[s],data:function(){return{isAdmin:1===Number(localStorage.getItem("role_id")),params:{company_id:localStorage.getItem("company_id"),company_name:localStorage.getItem("company_name")},attrVisible:!1,attrForm:{attriValueData:[]},attrTableData:[],copyAttrBox:[]}},props:["currentRow"],created:function(){this.onSearch()},computed:{isUpdate:function(){return!(1==Number(this.attrForm.is_system)&&this.isAdmin||1!==Number(this.attrForm.is_system))}},methods:{onReset:function(){this.params={company_id:localStorage.getItem("company_id"),company_name:localStorage.getItem("company_name")},this.onSearch()},onSearch:function(){var t=this,e=Object.assign({},this.params,{goods_type_id:this.currentRow.goods_type_id});this.$axios({method:"get",url:this.$api.setAttr,params:e}).then((function(e){200==e.data.code&&(t.attrTableData=e.data.data)}))},attrDelFun:function(){var t=this,e=new Array;if(!this.multipleSelection.length)return this.$message({message:"请选择要删除的类型",type:"warning"}),!1;for(var a=0;a<this.multipleSelection.length;a++)e.push(this.multipleSelection[a].attribute_id);this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$axMethod.delAttr({attribute_id:e.toString()}).then((function(e){200==e.data.code&&(t.$message.success(e.data.msg),t.onSearch())}))}))},add:function(){this.attrForm.attriValueData=[{attribute_value_name:null}],this.attrForm={company_id:localStorage.getItem("company_id"),company_name:localStorage.getItem("company_name"),attriValueData:[]},this.attrVisible=!0},addAttributeFun:function(){this.attrForm.attriValueData.push({attribute_value_name:""})},attrUpdateRow:function(t){this.attrVisible=!0,this.attrForm=this.$publicFution.deepCopy(t),this.attrForm.is_required=0==t.is_required?0:1,this.$set(this.attrForm,"attriValueData",[]);for(var e=0;e<t.value.length;e++)this.attrForm.attriValueData.push({is_quote:t.value[e].is_quote,attribute_value_name:t.value[e].attribute_value_name,attribute_value_id:t.value[e].attribute_value_id});this.copyAttrBox=this.attrForm.attriValueData.concat([])},close:function(){this.$emit("close")},checkAttr:function(t,e,a){if("容量"===this.attrForm.attribute_name){var i=/^[1-9]\d*(\.\d|\d)?\d*(L|mL)$/i;i.test(e)||a('容量内容未输入完整，请输入数字加"L"或者“mL”的内容')}a()},submitAttrForm:function(t){var e=this;this.$refs[t].validate((function(t){if(t){for(var a={},i="addAttr",r=[],o=0;o<e.attrForm.attriValueData.length;o++)r.push(e.attrForm.attriValueData[o].attribute_value_name);if(r=r.join(","),e.attrForm.attribute_id){i="editAttr";var l=[],s=[];for(o=0;o<e.attrForm.attriValueData.length;o++)l.push({attribute_value_id:e.attrForm.attriValueData[o].attribute_value_id?e.attrForm.attriValueData[o].attribute_value_id:0,attribute_value_name:e.attrForm.attriValueData[o].attribute_value_name});e.copyAttrBox.forEach((function(t){var a=!0;e.attrForm.attriValueData.forEach((function(e){e.attribute_value_id===t.attribute_value_id&&(a=!1)})),a&&s.push(t.attribute_value_id)})),a={company_id:1==Number(e.attrForm.is_system)?localStorage.getItem("company_id"):e.attrForm.company_id,company_name:1==Number(e.attrForm.is_system)?localStorage.getItem("company_name"):e.attrForm.company_name,goods_type_id:e.attrForm.goods_type_id,attribute_id:e.attrForm.attribute_id,attribute_name:e.attrForm.attribute_name,attribute_value:r,is_required:e.attrForm.is_required,sort:e.attrForm.sort,del_id:s.join(","),save_content:JSON.stringify(l)}}else a={company_id:e.attrForm.company_id,company_name:e.attrForm.company_name,goods_type_id:e.currentRow.goods_type_id,attribute_name:e.attrForm.attribute_name,attribute_value:r,is_required:e.attrForm.is_required,sort:e.attrForm.sort};e.$axios.post(e.$api[i],a).then((function(t){var a=t.data;200===a.code&&(e.$message.success(a.msg?a.msg:a.data),e.attrVisible=!1,e.onSearch())}))}}))}}},m=n,c=a("2877"),u=Object(c["a"])(m,o,l,!1,null,"662dc74a",null),d=u.exports,p={data:function(){var t=this,e=this.$createElement;return{tableColumn:[{type:"checkbox",width:44,align:"center"},{field:"name",title:"操作",width:110,fixed:"right",slots:{default:function(a){return[e("el-button",{attrs:{size:"small",type:"text",disabled:0==t.authority.b_edit},on:{click:function(){return t.updateRow(a.row)}}},[" 修改 "]),e("el-button",{attrs:{size:"small",type:"text"},on:{click:function(){return t.toSetAttributes(a.row)}}},[" 属性配置  "])]}}},{title:"类型名称",field:"goods_type_name",width:140},{title:"类型编号",field:"goods_type_id",width:130},{title:"助记码",field:"logogram",width:110},{title:"上级类型",field:"p_name",width:150},{title:"备注",field:"remark"}]}}},_={name:"systemInfoSalesGoodsattribute",mixins:[p],data:function(){return{authority:{},dialogFormVisible:!1,typeForm:{},levelData:[],isShowAttr:!1,params:{goods_type_name:"",number:"",logogram:""}}},methods:{closeAttribute:function(){this.isShowAttr=!1,this.$refs.xTable._proxy("refreshColumn")},cellClassName:function(t){var e=t.row;return e.canNotDelete?"sign_row":""},onReset:function(){this.$set(this,"params",{}),this.onSearch(1)},getTypelist:function(){this.typeForm={goods_type_name:"",remark:""},this.dialogFormVisible=!0,this.getLastTypeList()},onSearch:function(t){this.$refs.xTable._getData(t)},delFun:function(){var t={deleID:"goods_type_id",deleSelect:this.multipleSelection,deleApi:"delType",list:{UrlApi:"getTypeList",data:this.TableData}};this.$common.BatchDeletion(t,"删除",this,this.onSearch)},getLastTypeList:function(t){var e=this;this.levelData=[],this.$axios({method:"get",url:e.$api.getTypeListOption}).then((function(a){for(var i=a.data.data,r=0;r<i.length;r++)if(e.levelData.push({value:i[r].goods_type_id,label:i[r].goods_type_name,children:[]}),"undefined"!=typeof i[r].sub)for(var o=0;o<i[r].sub.length;o++)e.levelData[r].children.push({value:i[r].sub[o].goods_type_id,label:i[r].sub[o].goods_type_name});for(var l=0;l<e.levelData.length;l++)0==e.levelData[l].children.length&&delete e.levelData[l].children;t&&t()}))},toSetAttributes:function(t){this.currentRow=t,this.isShowAttr=!0},cancelForm:function(t){this.dialogFormVisible=!1,this.$refs[t].resetFields()},updateRow:function(t){var e=this,a=[];t.p_id_1&&a.push(t.p_id_1),t.p_id_2&&a.push(t.p_id_2),this.typeForm={goods_type_name:t.goods_type_name,prand_name:t.prand_name,goods_type_id:t.goods_type_id,p_id:t.p_id,p_name:t.p_name,remark:t.remark,level:a},this.getLastTypeList((function(){e.dialogFormVisible=!0}))},submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(t){var a="addType",i=1;e.typeForm.p_id=0,e.typeForm.level&&e.typeForm.level.length&&(i=e.typeForm.level.length+1,e.typeForm.p_id=e.typeForm.level[e.typeForm.level.length-1]);var r={goods_type_name:e.typeForm.goods_type_name,remark:e.typeForm.remark,level:i,p_id:e.typeForm.p_id};e.typeForm.goods_type_id&&(a="editType",r.goods_type_id=e.typeForm.goods_type_id);var o={eachData:r,UrlApi:a,closeDialog:e.dialogFormVisible=!1,list:{UrlApi:"getTypeList",data:e.TableData,esData:{page:e.goPage}}};e.$common.addAndupdateFun(o,e.onSearch)}}))}},activated:function(){this.onSearch(Window.goPage)},components:{attribute:d}},b=_,h=(a("64d9"),Object(c["a"])(b,i,r,!1,null,"ba86acb2",null));e["default"]=h.exports},af03:function(t,e,a){var i=a("d039");t.exports=function(t){return i((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},b1c7:function(t,e,a){}}]);
//# sourceMappingURL=chunk-1d64a99b.a5a9f952.js.map